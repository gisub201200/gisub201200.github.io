{"componentChunkName":"component---src-templates-post-jsx","path":"/redis-event-notifications/","result":{"data":{"site":{"siteMetadata":{"title":"SOOLAB"}},"markdownRemark":{"id":"b5b851d9-faec-54c9-bbbf-fb4035150e86","excerpt":"Redis Keyspace Notifications Redis에는 키 및 값의 변경 사항을 실시간으로 수신할 수 있는 Pub/Sub 기능을 제공한다. Notifications 유형 Redis 데이터 공간에 영향을 미치는 모든 작업에 대해 다음 두 가지 유형의 이벤트가 발생된다.\n예를 들어 키를 삭제하는 명령인  이 실행되면 Redis는 다음 두 가지 명령…","html":"<h2 id=\"Redis-Keyspace-Notifications\" style=\"position:relative;\">Redis Keyspace Notifications<a href=\"#Redis-Keyspace-Notifications\" aria-label=\"Redis Keyspace Notifications permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Redis에는 키 및 값의 변경 사항을 실시간으로 수신할 수 있는 Pub/Sub 기능을 제공한다.</p>\n<h2 id=\"Notifications-유형\" style=\"position:relative;\">Notifications 유형<a href=\"#Notifications-%EC%9C%A0%ED%98%95\" aria-label=\"Notifications 유형 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Redis 데이터 공간에 영향을 미치는 모든 작업에 대해 다음 두 가지 유형의 이벤트가 발생된다.\n예를 들어 키를 삭제하는 명령인 <code class=\"language-text\">del myKey1</code> 이 실행되면 Redis는 다음 두 가지 명령이 트리거된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"redis\"><pre class=\"language-redis\"><code class=\"language-redis\">PUBLISH __keyspace@0__:mykey1 del\nPUBLISH __keyevent@0__:del mykey1</code></pre></div>\n<p>첫번째 PUBLISH 명령은 Key 중심 이벤트로, <code class=\"language-text\">del</code>이 이벤트의 메시지고\n두번쨰 PUBLISH 명령은 명령 중심 이벤트로, <code class=\"language-text\">myKey1</code>이 이벤트의 메시지이다.\nSub 하는 쪽에서는 Subscribe 패턴 매칭을 통해서 두 가지 유형 중 관심있는 이벤트만 선택해서 알림을 받을 수 있다.</p>\n<!-- more -->\n<h2 id=\"Redis-Keyspace-Notifications-설정\" style=\"position:relative;\">Redis Keyspace Notifications 설정<a href=\"#Redis-Keyspace-Notifications-%EC%84%A4%EC%A0%95\" aria-label=\"Redis Keyspace Notifications 설정 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>기본적으로 Keyspace Notifications은 비활성화되어 있기 때문에, <code class=\"language-text\">redis.conf</code> 또는 <code class=\"language-text\">CONFIG SET</code> 명령어로 <code class=\"language-text\">notify-keyspace-events</code> 옵션을 활성화 할 수 있다.\n옵션에는 다음 값들이 있다.\n이벤트 종류</p>\n<ul>\n<li>K   Keyspace events, publish prefix \"<strong>keyspace@<db></strong>:\".</li>\n<li>E   Keyevent events, publish prefix \"<strong>keyevent@<db></strong>:\".</li>\n<li>g   공통 명령: del, expire, rename, ...</li>\n<li>$   스트링(String) 명령</li>\n<li>l   리스트(List) 명령</li>\n<li>s   셋(Set) 명령</li>\n<li>h   해시(Hash) 명령</li>\n<li>z   소트 셋(Sorted set) 명령</li>\n<li>x   만료(Expired) 이벤트 (키가 만료될 때마다 생성되는 이벤트)</li>\n<li>e   퇴출(Evicted) 이벤트 (최대메모리 정책으로 키가 삭제될 때 생성되는 이벤트)</li>\n<li>A   모든 이벤트(g$lshzxe), \"AKE\"로 지정하면 모든 이벤트를 받는다.</li>\n</ul>\n<p>여기서 K 또는 E는 필수적으로 있어야 하며, 나머지 값들은 선택적으로 설정할 수 있다.\n예를 들어, 어떤 Key가 Expire되는지만 수신하고 싶다면 아래와 같이 설정하면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">notify-keyspace-events \"Kx\": 키 이벤트 + 만료 이벤트 발생</code></pre></div>\n<p>Redis 명령에 따른 이벤트 종류를 보고 싶다면 <a href=\"https://redis.io/docs/manual/keyspace-notifications/\">공식문서</a>를 참조하자.</p>\n<h2 id=\"성능-측정\" style=\"position:relative;\">성능 측정<a href=\"#%EC%84%B1%EB%8A%A5-%EC%B8%A1%EC%A0%95\" aria-label=\"성능 측정 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>notify-keyspace-events 옵션을 모두 활성화 했을떄, 비활성화 했을 때 각가 redis-benchmark 를 통해 퍼모먼스를 테스트해보자.</p>\n<h3 id=\"notify-keyspace-events--모든-이벤트-비활성화\" style=\"position:relative;\">notify-keyspace-events \"\" 모든 이벤트 비활성화<a href=\"#notify-keyspace-events--%EB%AA%A8%EB%93%A0-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%B9%84%ED%99%9C%EC%84%B1%ED%99%94\" aria-label=\"notify keyspace events  모든 이벤트 비활성화 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># redis-cli config set notify-keyspace-events \"\"\n# redis-benchmark -q </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PING_INLINE: 3670.67 requests per second, p50=12.391 msec\nPING_MBULK: 3668.78 requests per second, p50=12.551 msec\nSET: 4601.72 requests per second, p50=9.087 msec\nGET: 4604.90 requests per second, p50=8.999 msec\nINCR: 4708.98 requests per second, p50=8.847 msec\nLPUSH: 4750.14 requests per second, p50=8.847 msec\nRPUSH: 4620.86 requests per second, p50=8.967 msec\nLPOP: 3531.82 requests per second, p50=13.231 msec\nRPOP: 3863.84 requests per second, p50=12.007 msec\nSADD: 4677.05 requests per second, p50=8.775 msec\nHSET: 4795.01 requests per second, p50=8.743 msec\nSPOP: 3689.49 requests per second, p50=12.087 msec\nZADD: 3968.57 requests per second, p50=10.575 msec\nZPOPMIN: 3116.62 requests per second, p50=15.095 msec\nLPUSH (needed to benchmark LRANGE): 3900.31 requests per second, p50=10.743 msec\nLRANGE_100 (first 100 elements): 4876.86 requests per second, p50=8.343 msec\nLRANGE_300 (first 300 elements): 3725.23 requests per second, p50=12.071 msec\nLRANGE_500 (first 500 elements): 2396.59 requests per second, p50=20.159 msec\nLRANGE_600 (first 600 elements): 2067.31 requests per second, p50=23.663 msec\nMSET (10 keys): 4288.53 requests per second, p50=9.711 msec</code></pre></div>\n<h3 id=\"notify-keyspace-events-AKE-모든-이벤트-활성화\" style=\"position:relative;\">notify-keyspace-events AKE 모든 이벤트 활성화<a href=\"#notify-keyspace-events-AKE-%EB%AA%A8%EB%93%A0-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%ED%99%9C%EC%84%B1%ED%99%94\" aria-label=\"notify keyspace events AKE 모든 이벤트 활성화 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># redis-cli config set notify-keyspace-events AKE\n# redis-benchmark -q </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PING_INLINE: 3299.57 requests per second, p50=14.319 msec\nPING_MBULK: 3115.85 requests per second, p50=15.039 msec\nSET: 3974.25 requests per second, p50=10.399 msec\nGET: 3828.19 requests per second, p50=10.959 msec\nINCR: 3869.07 requests per second, p50=10.791 msec\nLPUSH: 3835.24 requests per second, p50=11.095 msec\nRPUSH: 4118.96 requests per second, p50=10.247 msec\nLPOP: 3102.89 requests per second, p50=14.991 msec\nRPOP: 3178.03 requests per second, p50=14.895 msec\nSADD: 3834.94 requests per second, p50=10.983 msec\nHSET: 3825.41 requests per second, p50=11.111 msec\nSPOP: 3389.03 requests per second, p50=13.735 msec\nZADD: 3750.94 requests per second, p50=11.207 msec\nZPOPMIN: 3117.69 requests per second, p50=14.855 msec\nLPUSH (needed to benchmark LRANGE): 3835.68 requests per second, p50=11.103 msec\nLRANGE_100 (first 100 elements): 4953.68 requests per second, p50=8.247 msec\nLRANGE_300 (first 300 elements): 3687.04 requests per second, p50=12.079 msec\nLRANGE_500 (first 500 elements): 2410.28 requests per second, p50=20.191 msec\nLRANGE_600 (first 600 elements): 2059.44 requests per second, p50=23.647 msec\nMSET (10 keys): 4043.02 requests per second, p50=10.143 msec</code></pre></div>\n<p>p50 응답시간은 큰 차이가 없지만 초당 request 처리가 100~500 정도 줄어든 것을 볼 수 있다.<br>\n따라서, 이벤트 수신이 필요없다면 redis의 해당 설정은 비활성화하는 것이 리소스를 효율적으로 쓰는데 도움이 될 것 이다.\n옵션을 활성화하더라도 꼭 필요한 이벤트 유형 옵션만 설정하는 것이 좋다.</p>\n<h2 id=\"스프링-부트-설정\" style=\"position:relative;\">스프링 부트 설정<a href=\"#%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-%EC%84%A4%EC%A0%95\" aria-label=\"스프링 부트 설정 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RedisConfig</span> <span class=\"token punctuation\">{</span>\n\n\n\t<span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"redisMessageTaskExecutor\"</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Executor</span> <span class=\"token function\">redisMessageTaskExecutor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">ThreadPoolTaskExecutor</span> threadPoolTaskExecutor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ThreadPoolTaskExecutor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tthreadPoolTaskExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">setCorePoolSize</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\t\tthreadPoolTaskExecutor<span class=\"token punctuation\">.</span><span class=\"token function\">setMaxPoolSize</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> threadPoolTaskExecutor<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token annotation punctuation\">@Bean</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">RedisMessageListenerContainer</span> <span class=\"token class-name\">RedisMessageListener</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RedisConnectionFactory</span> connectionFactory<span class=\"token punctuation\">,</span> <span class=\"token class-name\">RedisMessageListener</span> redisMessageListener<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">RedisMessageListenerContainer</span> container <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RedisMessageListenerContainer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tcontainer<span class=\"token punctuation\">.</span><span class=\"token function\">setConnectionFactory</span><span class=\"token punctuation\">(</span>connectionFactory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tcontainer<span class=\"token punctuation\">.</span><span class=\"token function\">addMessageListener</span><span class=\"token punctuation\">(</span>redisMessageListener<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PatternTopic</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"*\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tcontainer<span class=\"token punctuation\">.</span><span class=\"token function\">setTaskExecutor</span><span class=\"token punctuation\">(</span><span class=\"token function\">asyncThreadTaskExecutor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> container<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token annotation punctuation\">@Bean</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">RedisTemplate</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">redisTemplate</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">RedisConnectionFactory</span> connectionFactory<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">RedisTemplate</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> redisTemplate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RedisTemplate</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tredisTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">setConnectionFactory</span><span class=\"token punctuation\">(</span>connectionFactory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tredisTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">setKeySerializer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">StringRedisSerializer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tredisTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">setValueSerializer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">StringRedisSerializer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> redisTemplate<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RedisMessageListener</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">MessageListener</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CacheManager</span><span class=\"token punctuation\">></span></span> cacheManagerList<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onMessage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">Message</span> message<span class=\"token punctuation\">,</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> pattern<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{}\"</span><span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>RedisMessageListenerContainer 빈 등록 시, 주의할 점은 setTaskExecutor() 로 스레드풀을 사용하는 Executor를 등록해야 한다.<br>\nsetTaskExecutor()로 Executor를 등록하지 않으면 RedisMessageListenerContainer는 기본값으로 SimpleAsyncTaskExecutor가 사용되는데,\nSimpleAsyncTaskExecutor 는 사용될 때 마다, 새로운 스레드를 만들어서 run() 하기 때문에 Redis에서 이벤트가 수신될 때 마다 새로운 스레드가 만들어지므로 주의하자.</p>","frontmatter":{"title":"Redis Keyspace Notifications에 대해 알아보자","date":"July 19, 2023","update":"July 19, 2023","tags":["레디스"],"series":null},"fields":{"slug":"/redis-event-notifications/","readingTime":{"minutes":6.135}}},"seriesList":{"edges":[{"node":{"id":"88b7d66f-cc60-5ee2-b460-75fbac6dbe4d","fields":{"slug":"/ch1/"},"frontmatter":{"title":"1장 - 신뢰할 수 있고 확장 가능하며 유지보수하기 쉬운 애플리케이션"}}},{"node":{"id":"edecb27b-7cba-5b3e-baf3-6af625f63e1d","fields":{"slug":"/ch2/"},"frontmatter":{"title":"2장 - 데이터 모델과 질의 언어"}}},{"node":{"id":"bd90f7b0-129a-5a48-83b4-aa86d5a05f22","fields":{"slug":"/ch3/"},"frontmatter":{"title":"3장 - 저장소와 검색"}}},{"node":{"id":"7ba45be6-b244-5f56-9992-79b670f5e4da","fields":{"slug":"/ch4/"},"frontmatter":{"title":"4장 - 부호화와 발전"}}},{"node":{"id":"5576af8a-c3e0-5e41-81eb-b7d04bdde4f5","fields":{"slug":"/ch5/"},"frontmatter":{"title":"5장 - 복제"}}},{"node":{"id":"27267918-cdd1-54a8-af0f-baad40da41fe","fields":{"slug":"/ch6/"},"frontmatter":{"title":"6장 - 파티셔닝"}}},{"node":{"id":"9db7e0fe-092b-509d-8114-216a230d82af","fields":{"slug":"/ch7/"},"frontmatter":{"title":"7장 - 트랜잭션"}}},{"node":{"id":"295cc398-6c96-56e5-a80e-1682afe45ffd","fields":{"slug":"/ch8/"},"frontmatter":{"title":"8장 - 분산 시스템의 골칫거리"}}},{"node":{"id":"a262dc65-d419-54eb-8a31-8471eb8afd19","fields":{"slug":"/ch1/"},"frontmatter":{"title":"1부 - 성능 기초"}}},{"node":{"id":"51344158-2351-53e1-9ab1-d6f79a451641","fields":{"slug":"/ch2/"},"frontmatter":{"title":"2부 - 성능 개선"}}},{"node":{"id":"3992b5fb-9aae-54ad-b626-d39c07ccc9ae","fields":{"slug":"/ch3/"},"frontmatter":{"title":"3부 - 화면 응답시간 분석"}}},{"node":{"id":"b8843120-0501-5e78-928d-08c1ed9db65c","fields":{"slug":"/ch4/"},"frontmatter":{"title":"4부 - 프로세스 이해하기"}}},{"node":{"id":"5dfe03b4-bedb-5f66-8969-240260c232e8","fields":{"slug":"/ch5/"},"frontmatter":{"title":"5부 - 소스코드 최적화"}}},{"node":{"id":"9815200b-4377-57d4-bcb8-9336c5f9b3b8","fields":{"slug":"/ch6/"},"frontmatter":{"title":"6부 - SQL 최적화"}}},{"node":{"id":"2c95f1eb-6875-5a65-b8ac-a715b9041713","fields":{"slug":"/ch7/"},"frontmatter":{"title":"7부 - 애플리케이션 입장에서의 SQL 튜닝"}}},{"node":{"id":"e3c9bd99-dddc-5d1b-bb33-56d3b61c299c","fields":{"slug":"/spring-autoconfigure/"},"frontmatter":{"title":"SpringBoot AutoConfiguration 시작하기"}}},{"node":{"id":"11a9d138-5dd0-5837-bdad-70aa4de33bcd","fields":{"slug":"/behavior/"},"frontmatter":{"title":"디자인 패턴 - 행동 패턴"}}},{"node":{"id":"eb3c0497-183a-5764-b158-2cbfc02069b8","fields":{"slug":"/struct/"},"frontmatter":{"title":"디자인 패턴 - 구조 패턴"}}},{"node":{"id":"62679b67-d124-5650-9e8c-10da079021ff","fields":{"slug":"/create/"},"frontmatter":{"title":"디자인 패턴 - 생성 패턴"}}},{"node":{"id":"34e2000f-4f63-5480-9c0d-aefcca9de23f","fields":{"slug":"/Exactly_Once_Semantics/"},"frontmatter":{"title":"카프카는 어떻게 Exactly-Once Semantics 보장하나?"}}},{"node":{"id":"07f3f0af-35df-5c6d-b6c9-7620523cb06d","fields":{"slug":"/trasaction_in_kafka/"},"frontmatter":{"title":"카프카에서의 Transactions"}}},{"node":{"id":"405d7847-99e0-5d6f-a07b-7ecd3016d705","fields":{"slug":"/enabling_exactly_once_kafka_streams/"},"frontmatter":{"title":"카프카 스트림즈의 정확히 한 번"}}},{"node":{"id":"33d16cf7-b112-593f-bd62-a51d0e3cb4b6","fields":{"slug":"/Amazon SQS Deep Dive/"},"frontmatter":{"title":"Amazon SQS 딥다이브"}}},{"node":{"id":"977791be-de20-5581-ac6b-7b777e8fe1cb","fields":{"slug":"/Spring Cloud AWS Messaging Module Best Practice/"},"frontmatter":{"title":"Spring Cloud AWS Messaging 모듈 문제점 및 튜닝"}}},{"node":{"id":"dde4af86-2501-59f6-ab69-71148e4d9d97","fields":{"slug":"/java-collection-wrapper/"},"frontmatter":{"title":"Collection Wrapper 클래스를 이용한 Service 계층 리팩토링 "}}},{"node":{"id":"77da0f76-df1e-529b-a46d-602987f6068d","fields":{"slug":"/spring-cache-hierarchy/"},"frontmatter":{"title":"Spring Cache 로 캐시 계층 구조 사용하기"}}},{"node":{"id":"b5b851d9-faec-54c9-bbbf-fb4035150e86","fields":{"slug":"/redis-event-notifications/"},"frontmatter":{"title":"Redis Keyspace Notifications에 대해 알아보자"}}},{"node":{"id":"221f8608-fceb-597e-b8a6-a72dfaa2efd9","fields":{"slug":"/jpa-slow-cause/"},"frontmatter":{"title":"JPA가 느릴 수 밖에 없는 원초적인 이유"}}},{"node":{"id":"e0bd02eb-2f80-54e3-a49c-74668400c523","fields":{"slug":"/ehcache3/"},"frontmatter":{"title":"Ehcache3 캐시 라이브러리 소개 (with Spring Boot)"}}},{"node":{"id":"93433e2f-6e6a-555e-b74e-c1a9e9af5bc4","fields":{"slug":"/mysql-primary-key-design/"},"frontmatter":{"title":"고성능을 위한 MySQL Primary Key 설계 전략"}}},{"node":{"id":"fdd87794-c713-57e2-ab09-d66190a14578","fields":{"slug":"/tomcat/"},"frontmatter":{"title":"Apache Tomcat 이해하기(NIO Connector 중심)"}}},{"node":{"id":"761f8e01-6f44-5d7f-87c0-f7177cba0d57","fields":{"slug":"/socket_option/"},"frontmatter":{"title":"Java의 Socket Option 정리"}}},{"node":{"id":"974e1e90-e20e-5b0e-8414-5c695ff4e24a","fields":{"slug":"/tomcat-connection/"},"frontmatter":{"title":"Tomcat은 어떻게 Connection을 관리할까?"}}},{"node":{"id":"dcb19b23-2230-57a7-8520-288cb92b91bd","fields":{"slug":"/spring-core-container/"},"frontmatter":{"title":"스프링으로 알아보는 IoC 컨테이너의 원리와 이해"}}},{"node":{"id":"db3f2384-1942-5aec-ac4d-844ced9303e1","fields":{"slug":"/socket_internal/"},"frontmatter":{"title":"요청이 급증하는 상황의 Connection reset by peer 트러블 슈팅"}}},{"node":{"id":"e4f37066-c670-5ed3-a373-ac02f6def2fc","fields":{"slug":"/mysql-transaction-lock/"},"frontmatter":{"title":"MySQL 잠금과 트랜잭션 Deep Dive"}}},{"node":{"id":"7bca9259-d5b7-52e1-94c1-55705e11ef98","fields":{"slug":"/java-synchronized/"},"frontmatter":{"title":"자바의 synchronized와 volatile"}}}]},"previous":{"fields":{"slug":"/spring-cache-hierarchy/"},"frontmatter":{"title":"Spring Cache 로 캐시 계층 구조 사용하기"}},"next":{"fields":{"slug":"/jpa-slow-cause/"},"frontmatter":{"title":"JPA가 느릴 수 밖에 없는 원초적인 이유"}}},"pageContext":{"id":"b5b851d9-faec-54c9-bbbf-fb4035150e86","series":null,"previousPostId":"77da0f76-df1e-529b-a46d-602987f6068d","nextPostId":"221f8608-fceb-597e-b8a6-a72dfaa2efd9"}},"staticQueryHashes":[],"slicesMap":{}}