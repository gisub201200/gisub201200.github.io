{"componentChunkName":"component---src-templates-series-jsx","path":"/series/Java-NIO/","result":{"data":{"posts":{"nodes":[{"excerpt":"버퍼 I/O 운영체제의 I/O는 모두 버퍼를 통해 이루어진다. 프로세스는 버퍼에서 데이터를 채우는 (쓰기) 또는 버퍼에 데이터를 비우는 (읽기) 작업을 운영 체제에 요청함으로써 I/O를 수행한다.\n모든 데이터는 이 메커니즘을 통해 프로세스 내부로 이동하거나 나간다.\n 위 그림에서 사용자 공간(user space)과 커널 공간(kernel space)의 개…","html":"<h2 id=\"버퍼-IO\" style=\"position:relative;\">버퍼 I/O<a href=\"#%EB%B2%84%ED%8D%BC-IO\" aria-label=\"버퍼 IO permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>운영체제의 I/O는 모두 버퍼를 통해 이루어진다. 프로세스는 버퍼에서 데이터를 채우는 (쓰기) 또는 버퍼에 데이터를 비우는 (읽기) 작업을 운영 체제에 요청함으로써 I/O를 수행한다.\n모든 데이터는 이 메커니즘을 통해 프로세스 내부로 이동하거나 나간다.\n<figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 569px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b0b73aee6b97cb3d63f04ffdca748d26/7ca0c/img_6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.705882352941174%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABB0lEQVR42l1R26qDMBDs//+S2EdLxQfFVvFKq1BLq1ZFqoJ2zpmFnBMa2FwmOzOb7A6/4/P5YNs2rOsqwb0667gK5qvBvX7ekUBgnmf0fY+u66AwFcTbtsUwDEJSRrrQnyCn9/uNJElwOp0QhiHO5zOezycul4usiny/35FlGaqqkjuuDHKapvkXHMcRvu/Dsiy4rgvDMBAEAcqyFALNiFMwjmN4ngfHcXA8HpHnOYqikKCOCE7ThDRNYZomDoeDuD8eD3F8vV6wbRv7/V4wVsuqb7eb3Kl/5OtoJoLLsuB6vUrprIZR17Uk8/9IZqUU0Jug9jSJokheJIKqq3qCjn13VM/9bsoPVVAUpUmOppgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"운영체제 I/O\"\n        title=\"\"\n        src=\"/static/b0b73aee6b97cb3d63f04ffdca748d26/7ca0c/img_6.png\"\n        srcset=\"/static/b0b73aee6b97cb3d63f04ffdca748d26/e7570/img_6.png 170w,\n/static/b0b73aee6b97cb3d63f04ffdca748d26/f46e7/img_6.png 340w,\n/static/b0b73aee6b97cb3d63f04ffdca748d26/7ca0c/img_6.png 569w\"\n        sizes=\"(max-width: 569px) 100vw, 569px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">운영체제 I/O</figcaption>\n  </figure></p>\n<p>위 그림에서 사용자 공간(user space)과 커널 공간(kernel space)의 개념에 주목하자.\n사용자 공간은 일반 프로세스가 실행되는 곳이다. JVM도 사용자 공간에서 실행된다. 사용자 공간은 특권이 없어 하드웨어에 직접 접근할 수 없다.\n커널 공간은 운영 체제가 위치하는 곳으로 특별한 권한을 가진다. 모든 I/O는 커널 공간을 통해 이루어진다.</p>\n<p>프로세스가 I/O 작업을 요청하면 시스템 호출을 수행하여 커널로 제어권을 전달한다.\n커널은 필요한 데이터를 찾아 사용자 공간의 지정된 버퍼로 전송한다.\n커널은 데이터를 캐시하거나 미리 가져오려고 시도하기 때문에 프로세스가 요청하는 데이터는 이미 커널 공간에 있을 수 있다.</p>\n<p>기존 java.io 라이브러리와 NIO 간의 가장 중요한 차이점은 데이터를 패키지하고 전송하는 방법과 관련이 있다.\n운영 체제는 데이터를 큰 덩어리(버퍼)로 이동시키려고 하는 반면, 스트림 기반 I/O 클래스는 작은 단위(단일 바이트나 텍스트의 줄)로 데이터를 처리하려고 한다.\nJava의 NIO는 이러한 불일치를 해결하기 위해 도입되었다.\nNIO는 한 번에 여러 바이트의 데이터 블록을 처리하고 운영 체제의 native I/O 를 더욱 활용하여 기존 I/O의 한계를 극복한다.</p>\n<h2 id=\"Buffer\" style=\"position:relative;\">Buffer<a href=\"#Buffer\" aria-label=\"Buffer permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Buffer 객체는 고정된 양의 데이터를 관리하는 컨테이너이다. 버퍼는 채워지고 비워진다.\n버퍼는 채널과 밀접하게 작동한다. 채널은 I/O 전송이 이루어지는 포털이며, 버퍼는 그 데이터 전송의 출발지나 대상이다. 나가는 전송의 경우, 전송하고 싶은 데이터는 버퍼에 넣어져 채널로 전달된다.\n들어오는 전송의 경우, 채널은 제공하는 버퍼에 데이터를 저장한다.\n버퍼 사이의 협력하는 객체 사이의 이러한 핸드오프는 데이터 처리의 효율성을 향상시키는 핵심이다</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/88f114d19acec492c041fab251e6c7fc/a0e79/img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVR42p1SiaqDMBDM/39bEbQe4FG8KtaqPbwoaucxCylCH6+PLiTZbCazk90ofLBlWdA0DW63G9Z1/QSH2m6ez+draHs8HiiKAlmWoe/7N9wW+0a4JaYyWlVVSJIEjuPgeDy+VP+pkE+Z5xnjOOJ6veJyueB0OiHPcwRBAMMwsNvtxCcpkxBD7DRNcleXQzHg+z5c10Ucx7BtW9REUSREh8NB/DAMxbcsS3CmaWK/30uMKzHDMEBxYrbz+SxB1okgqrjf70LUtq3UME1TucQSsK6M87zrOpRlKXcU5fKAnSQx/bqupatcudcJ+cQtljHiSM7BBip8abq7JGcZPM+TZOq3b/DfoQnZQCpkE79WqI0/g6S6JD+UqAFOMqByiQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Buffer 종류\"\n        title=\"\"\n        src=\"/static/88f114d19acec492c041fab251e6c7fc/ca1dc/img.png\"\n        srcset=\"/static/88f114d19acec492c041fab251e6c7fc/e7570/img.png 170w,\n/static/88f114d19acec492c041fab251e6c7fc/f46e7/img.png 340w,\n/static/88f114d19acec492c041fab251e6c7fc/ca1dc/img.png 680w,\n/static/88f114d19acec492c041fab251e6c7fc/a0e79/img.png 824w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Buffer 종류</figcaption>\n  </figure></p>\n<h3 id=\"Buffer-속성\" style=\"position:relative;\">Buffer 속성<a href=\"#Buffer-%EC%86%8D%EC%84%B1\" aria-label=\"Buffer 속성 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Buffer 에는 4가지 속성이 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Buffer</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token comment\">// Invariants: mark &lt;= position &lt;= limit &lt;= capacity</span>\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> mark <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> position <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> limit<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> capacity<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>mark : 기억된 위치. mark() 호출시 mark = position으로 설정된다. reset() 호출시 position = mark로 설정된다. 설정되기 전까지 mark는 정의되지 않는다.</li>\n<li>position: 다음에 읽거나 쓸 요소의 인덱스. 상대적인 get() 및 put() 메서드에 의해 자동으로 업데이트 된다.</li>\n<li>limit: 버퍼에서 읽거나 쓸 수 있는 첫 번째 요소가 아닌 요소. 즉, 버퍼 내의 활성 요소의 수를 나타낸다.</li>\n<li>capacity: 버퍼가 가질 수 있는 데이터 요소의 최대 개수. 버퍼가 생성될 때 설정되며 변경할 수 없다.</li>\n</ul>\n<p>이 네 가지 속성 간의 관계는 항상 다음을 만족한다.<br>\n0 ≤ mark ≤ position ≤ limit ≤ capacity</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 529px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/19039da6aeb3844fa83299244996eb44/3e20f/img_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.176470588235293%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA10lEQVR42n1R2QqEMAzc//8sH0XEF19URPDA+z7xyO4M1H3YxYE0TTOdpOlLPhjHUbZtk3Vdacuy0I7jkGma7twwDLLvO+N5npmD4X5RFJCSF5amaaQsS6mqioksyyRNU8nznHvl1ZmKwcU9+L7vWYyCruuKbduSJIlEUcQCbdve/p8hF4YhixiGIZqmfTvsuo5iqAKCav8J4MdxzDGgS8dxOCIKBkHAAwBipmmSCJznKdd1/ZhlWeL7PjmYr67rLELBuq4ZKEHP8zj4J+AleDqAj0FDGMMb2JrKJuRJHroAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Buffer.png\"\n        title=\"\"\n        src=\"/static/19039da6aeb3844fa83299244996eb44/3e20f/img_1.png\"\n        srcset=\"/static/19039da6aeb3844fa83299244996eb44/e7570/img_1.png 170w,\n/static/19039da6aeb3844fa83299244996eb44/f46e7/img_1.png 340w,\n/static/19039da6aeb3844fa83299244996eb44/3e20f/img_1.png 529w\"\n        sizes=\"(max-width: 529px) 100vw, 529px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Buffer.png</figcaption>\n  </figure></p>\n<p>예를 들어, 10의 용량을 가진 Buffer는 위의 그림과 같이 속성이 초기화된다.\nmark는 mark()가 호출되기 전까지 정의되지 않고, postition은 0으로 설정되고, capcatity와 limit은 10으로 설정된다.\n이 상태에서 데이터를 5개만 쓴 후에 버퍼를 읽기 모드로 전환한다면(flip()을 호출), limit는 5로 설정된다.\n즉, 처음 5개의 데이터 요소만 읽을 수 있다는 얘기이다.</p>\n<h3 id=\"Buffer-접근\" style=\"position:relative;\">Buffer 접근<a href=\"#Buffer-%EC%A0%91%EA%B7%BC\" aria-label=\"Buffer 접근 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>ByteBuffer와 같은 Buffer 클래스의 서브클래스에는 get(), put() 연산이 존재한다.\n이 연산은 상대적 연산과 절대적 연산으로 수행된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ByteBuffer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Buffer</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Comparable</span> <span class=\"token punctuation\">{</span>\n\t\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">byte</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">byte</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> index<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">ByteBuffer</span> put <span class=\"token punctuation\">(</span><span class=\"token keyword\">byte</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">ByteBuffer</span> put <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> index<span class=\"token punctuation\">,</span> <span class=\"token keyword\">byte</span> b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>버퍼는 데이터 요소를 일정한 크기로 저장하는데 필요에 따라 버퍼를 완전히 채우지 않고 일부분만 채우고 버퍼를 다른 곳으로 전송하거나 읽을 수 있어야 할 것 이다.\n이때, 어디까지 데이터가 채워졌는지, 다음 데이터가 어디에 위치해야 하는지 등을 알아야 되는데 이를 위해 position 이 있다.\nByteBuffer 클래스의 index 인수를 받지 않는 get()과 put() 메서드는 이 position을 이용한 상대적 연산이다.</p>\n<p>상대적 연산은 position 값을 기준으로 데이터를 읽거나 쓰고, get(), put()을 호출하면 position 값이 1 증가한다.\n만약, put()을 호출할 때 position >= limit 이 되면 BufferOverflowException 발생하고\n마찬가지로 get()을 호출할 때 position >= limit 이라면 BufferUnderflowException 이 발생한다.</p>\n<p>절대적 연산은 특정 버퍼 위치(index)에 직접 데이터를 읽거나 쓴다.\n이 연산은 position의 값을 변경하지 않고, 버퍼의 인덱스 범위를 벗어나면 IndexOutOfBoundsException이 발생한다.</p>\n<h3 id=\"Buffer-채우기\" style=\"position:relative;\">Buffer 채우기<a href=\"#Buffer-%EC%B1%84%EC%9A%B0%EA%B8%B0\" aria-label=\"Buffer 채우기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>아래 코드는 capacity가 10인 ByteBuffer를 할당하고, 'hello' 라는 문자를 바이트로 버퍼에 채우는 코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">ByteBuffer</span> byteBuffer <span class=\"token operator\">=</span> <span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">.</span><span class=\"token function\">allocate</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> bytes <span class=\"token operator\">=</span> <span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbyteBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 538px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3802ba7c05ebb4908010cd7f5e2ae42a/32ca7/img_2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDUlEQVR42n2SyY6DQAxE+f8v48YpCA4Q9n2HEPaKyiNGfchMS5bBbT+XDRrUc134di4lfn3JUWNa27ZYlgXzPOP9fuP1emGaJqzrKp7GO/pxHCWH1ve9xJgfhiHO8/wBep4H3/dBH8exXEZRhDRN4TgOuq7DMAyo6xpN04ACbk8ry1IaUIAACXk+n3BdF0EQCJwgxmi2bePxeKAoCiRJIo3yPBd/C9B1XRoLUN3FcRzIskwK6KuqEjhh6q64AoKYQzCBnEKAHI+dmMy9UCFH+O/j3MopgIc1nE6AHNU0TXkhmN24/BtwmwpksWVZvzHDMGQtfNbYZd93udy2TZZ7/fH7qKu51TGXfwlrqfADWHplVUTcTmsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"buffer 채우기\"\n        title=\"\"\n        src=\"/static/3802ba7c05ebb4908010cd7f5e2ae42a/32ca7/img_2.png\"\n        srcset=\"/static/3802ba7c05ebb4908010cd7f5e2ae42a/e7570/img_2.png 170w,\n/static/3802ba7c05ebb4908010cd7f5e2ae42a/f46e7/img_2.png 340w,\n/static/3802ba7c05ebb4908010cd7f5e2ae42a/32ca7/img_2.png 538w\"\n        sizes=\"(max-width: 538px) 100vw, 538px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">buffer 채우기</figcaption>\n  </figure></p>\n<h3 id=\"Flipping\" style=\"position:relative;\">Flipping<a href=\"#Flipping\" aria-label=\"Flipping permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Buffer를 채우기 버퍼의 데이터를 읽기 위해서는 Flipping 을 통해 Buffer의 동작을 전환해야한다.\nBuffer에 'hello'가 채워진 상태에서(position=5)에서 get()을 하게 되면 빈 값을 가져올 것 이다.\n따라서, Buffer에 채워진 데이터를 읽기 위해서는 아래와 같은 작업이 필요하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">buffer<span class=\"token punctuation\">.</span><span class=\"token function\">limit</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">.</span><span class=\"token function\">position</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">position</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>buffer의 읽을 수 있는 값을 현재 buffer의 position으로 설정하고, 현재 position을 읽기 작업을 위해 0으로 설정한다.\n이 작업은 buffer.flip() 메서드와 같은 동작을 한다.</p>\n<h3 id=\"Draining\" style=\"position:relative;\">Draining<a href=\"#Draining\" aria-label=\"Draining permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Draining 이란 Buffer에서 데이터를 읽어 오는 것을 의미한다. 위에서 Buffer에 데이터를 읽기 전에 Flipping 이라는 작업이 필요하다는 것을 설명했다.\nFlipping후 Buffer의 읽기모드로 바꿔 position 에서 시작하여 limit 전까지의 데이터를 읽어야 한다.</p>\n<p>이 때, 사용되는 메서드가 hasRemaining() 과 remaining() 이다.\nhasRemaining() 는 현재 position과 limit을 비교하여 읽을 수 있는 데이터 있는지 여부를 반환한다.\nremaining()은 현재 position에서 limit 까지 남아있는 데이터의 수를 반환한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> buffer<span class=\"token punctuation\">.</span><span class=\"token function\">hasRemaining</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\tbyteArray<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> buffer<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"Marking\" style=\"position:relative;\">Marking<a href=\"#Marking\" aria-label=\"Marking permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>mark()메서드는 호출될 때 Buffer 클래스의 mark 속성을 현재 position 값으로 변경한다.\n이는 위리를 기억하고 있다가 나중에 해당 위치로 돌아갈 수 있도록 하기 위함이다.\nreset() 메서드는 position을 현재 mark 값으로 설정한다. mark 값이 정의되어 있지 않다면 Exception이 발생한다.</p>\n<p>밑에 코드를 실행하면 Buffer는 아래 그림과 같은 상태가 된다. </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">buffer<span class=\"token punctuation\">.</span><span class=\"token function\">position</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">mark</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">position</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 518px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1d8c8957da569f5b8f477c50dd0f0af2/2f227/img_3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABG0lEQVR42nWRW4+CUAyE+f8/y8QXicYXDRG8AILiBRQUEJXZfE00+7A7SVPOOW1nOjhVVanrOj0eD8tt2+r5fFq+3W56v99qmkZ1XVvmnjr6+L7f77peryqKQsBZLBba7/fa7XY6nU46HA46Ho+WuaNwvV6rLEsLmok8z+3M+/l8/pI7nudZg+/7Wi6Xms/nWq1WCsNQ0+lUm81GkEZRpDiOjSzLMos0Tb/B0NfrJQfp2+3WggGu65oCmofDoa0EM4PH4/F3GMo+9nBGkK2cJIkx0MTwIAhMBX5x9xs0Q4AdbIWv4HK52Lnvezmz2cxWAgwfjUamEFDwF/gpk8nEtgLYMxgMzFMHNTAAjOYRdf8BEoI1P3X4h8dY8AOPxBIaCtS0VQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Marking\"\n        title=\"\"\n        src=\"/static/1d8c8957da569f5b8f477c50dd0f0af2/2f227/img_3.png\"\n        srcset=\"/static/1d8c8957da569f5b8f477c50dd0f0af2/e7570/img_3.png 170w,\n/static/1d8c8957da569f5b8f477c50dd0f0af2/f46e7/img_3.png 340w,\n/static/1d8c8957da569f5b8f477c50dd0f0af2/2f227/img_3.png 518w\"\n        sizes=\"(max-width: 518px) 100vw, 518px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Marking</figcaption>\n  </figure></p>\n<p>mark=2 이고, 현재 position이 4이므로 이 상태에서 read를 하게 되면 'ow' 를 읽을 것 이다.\n여기서 reset()을 하면 현재 position 값을 2로 설정된다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 531px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/131dab0da4277abba67a9fd2a2a1e579/b2c14/img_4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVR42m1RSY6DQAzM/7/DC3LlRA4cQBAWiS3s+05lyhEoisZStd22u2RX3/Bn+75jWRZs2yY443VdL/zm53mWO8G4bVtS4cajKAp4nieeKMsSVVUhz3OkaSpIkgR1XaNpGgF7eP/uO47jQxiGIUzTxPP5FOi6Dtu24TiO5Ol5j+NYiLMsExLGzEVRJOScVAjHcUQQBFIgmaIo6PseXdddmKZJaoZhCBGH4KTsIxlr18pMWpYlBWrEB8Mw4NdYYw/18n1fpqRRR25AL4Sc7PF4iNhMqqoK13Vxfhi1+QaNhJqmSUw97/c7Xq/Xh5Dr8DNoJKUuXPM/OwkpEz/kjPmG/g0ojBY906QKLgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"reset 후 상태\"\n        title=\"\"\n        src=\"/static/131dab0da4277abba67a9fd2a2a1e579/b2c14/img_4.png\"\n        srcset=\"/static/131dab0da4277abba67a9fd2a2a1e579/e7570/img_4.png 170w,\n/static/131dab0da4277abba67a9fd2a2a1e579/f46e7/img_4.png 340w,\n/static/131dab0da4277abba67a9fd2a2a1e579/b2c14/img_4.png 531w\"\n        sizes=\"(max-width: 531px) 100vw, 531px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">reset 후 상태</figcaption>\n  </figure></p>\n<h3 id=\"Comparing\" style=\"position:relative;\">Comparing<a href=\"#Comparing\" aria-label=\"Comparing permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>버퍼 두개가 동일하다는 것은 다음 조건을 만족해야 한다.</p>\n<ul>\n<li>두 객체가 같은 타입이어야 한다.</li>\n<li>두 버퍼에 남아있는 요소의 수가 같아야 한다. (즉, position에서 limit까지 요소 수)</li>\n<li>남아있는 데이터 요소의 순서가 각 버퍼에서 동일해야 한다.</li>\n</ul>\n<p>compare 는 다음과 같은 기준으로 비교된다. 여기서 크다 작다는 버퍼의 남아있는 요소의 수가 많냐 적냐를 말한다.</p>\n<ul>\n<li>음수: 메서드를 호출한 버퍼가 전달된 버퍼보다 작다.</li>\n<li>0: 두 버퍼가 동일하다.</li>\n<li>양수: 메서드를 호출한 버퍼가 전달된 버퍼보다 크다.</li>\n</ul>\n<h3 id=\"Buffer의-생성\" style=\"position:relative;\">Buffer의 생성<a href=\"#Buffer%EC%9D%98-%EC%83%9D%EC%84%B1\" aria-label=\"Buffer의 생성 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Buffer는 생성자를 통해 직접 생성할 수 없다. 인스턴스를 생성하기 위해서는 각 클래스의 정적 팩토리 메서드를 사용해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 사이즈 100인 char형 buffer </span>\n<span class=\"token class-name\">CharBuffer</span> charBuffer <span class=\"token operator\">=</span> <span class=\"token class-name\">CharBuffer</span><span class=\"token punctuation\">.</span><span class=\"token function\">allocate</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// wrap 을 사용한 버퍼 생성</span>\n<span class=\"token keyword\">char</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> myArray <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">char</span> <span class=\"token punctuation\">[</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">CharBuffer</span> charbuffer <span class=\"token operator\">=</span> <span class=\"token class-name\">CharBuffer</span><span class=\"token punctuation\">.</span>wrap <span class=\"token punctuation\">(</span>myArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// CharSequence를 입력받는 wrap</span>\n<span class=\"token class-name\">CharBuffer</span><span class=\"token punctuation\">.</span>wrap <span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello World\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>wrap을 이용한 Buffer는 읽기/쓰기 작업 시, 실제 myArray를 참조하게 된다. 이렇게 생성한 Buffer를 non-direct buffer라고 한다.\nnon-direct buffer는 실제 데이터를 저장하기 위해 내부적으로 배열을 사용한다. 이 배열이 바로 backing arrays 라고 한다. wrap 의 예에서는 myArray가 backing array가 된다.\n이와 반대로, direct Buffer 는 JVM 밖의 위치하는 네이티브 메모리 영역에 직접 할당되어 GC에 영향받지 않는다.</p>\n<h3 id=\"ByteBuffer\" style=\"position:relative;\">ByteBuffer<a href=\"#ByteBuffer\" aria-label=\"ByteBuffer permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>기본 원시 타입(int, long, char 등)에 대한 버퍼가 있지만 그 중에서도 ByteBuffer 는 특별하다.\n기본 원시 타입은 연손적인 바이트 시퀀스로 메모리에 저장된다.\n또한, JVM과 운영 체제 간에 데이터를 이동할 때 바이트 중심으로 이루어지기 때문이다. 때문에 다른 원시 타입에는 없는 ByteBuffer 만의 고유 API를 가진다.</p>\n<table>\n<thead>\n<tr>\n<th>Data Type</th>\n<th>Size (bytes)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Byte</td>\n<td>1</td>\n</tr>\n<tr>\n<td>Char</td>\n<td>2</td>\n</tr>\n<tr>\n<td>Short</td>\n<td>2</td>\n</tr>\n<tr>\n<td>Int</td>\n<td>4</td>\n</tr>\n<tr>\n<td>Long</td>\n<td>8</td>\n</tr>\n<tr>\n<td>Float</td>\n<td>4</td>\n</tr>\n<tr>\n<td>Double</td>\n<td>8</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>HTTP 에서는 8비트로 구성된 바이트를 옥텟(octet)이라고 한다. 이는 초기 컴퓨터에서 바이트가 꼭 8비트를 의미하는 것은 아니였기 때문이다.</p>\n</blockquote>\n<p>ByteBuffer 는 다른 버퍼 유형과 다르게 채널에 의한 I/O 작업의 대상이 될 수 있다. 채널은 ByteBuffer만을 인자로 받기 때문이다.\n운영제제의 I/O는 연속된 바이트 메모리 영역에서 수행되는데, JVM 내에서의 바이트 배열은 연속적으로 메모리에 저장되지 않을 수 있으며, 가비지 컬렉터에 의해 언제든지 이동될 수 있다.\n그래서 바이트 배열이 연속적인 메모리 공간에 저장되는지는 JVM의 구현에 따라 달라질 수 있다.</p>\n<p>이런 문제점을 해결하기 위해 direct buffer가 있다. direct buffer는 채널 및 네이티브 I/O 함수와 상호작용하기 위해 설계되었다.\ndirect buffer는 네이티브 메모리 영역에 직접 할당되어 데이터를 JVM의 메모리에서 운영 체제의 메모리로 복사할 필요 없이 바로 네이티브 I/O 연산에 사용할 수 있다.\n그래서 일반적으로 I/O 작업 시에는 direct buffer를 사용하는데, non-direct buffer를 채널로 전달하게 되면 채널은 내부적으로 다음과 같은 작업을 수행한다.</p>\n<ol>\n<li>임시 direct buffer 를 생성한다.</li>\n<li>non-direct buffer의 데이터를 direct buffer로 복사한다.</li>\n<li>direct buffer를 사용하여 I/O 작업을 수행한다.</li>\n<li>작업이 끝나면, 임시 direct buffer는 GC된다.</li>\n</ol>\n<p>대신 일반적으로 direct buffer 생성 비용은 non-direct buffer 생성 비용보다 클 수 있다. direct 버퍼는 운영체제 코드를 통해 할당되기 때문이다.\ndirect buffer는 ByteBuffer 클래스의 allocateDirect() 정적 팩토리 메서드로 생성할 수 있다.</p>\n<h3 id=\"View-Buffer\" style=\"position:relative;\">View Buffer<a href=\"#View-Buffer\" aria-label=\"View Buffer permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>뷰 버퍼는 원본 버퍼와 데이터를 공유하지만, 자체적인 속성 (예: position, limit, capacity 등)을 가진다.\n이는 뷰 버퍼를 통해 데이터를 읽거나 쓸 때 원본 버퍼의 데이터가 변경되며, 반대의 경우도 마찬가지이다.\n위에서 나온 duplicate()와 wrap() 메서드로 만든 버퍼도 뷰 버퍼의 일종으로 볼 수 있다.</p>\n<p>뷰 버퍼의 주요 사용 사례는 ByteBuffer의 바이트 데이터를 다른 원시 타입으로 해석할 필요가 있을 때이다.\n이 때, ByteBuffer의 asIntBuffer(), asCharBuffer() 등의 팩토리 메서드를 통해 원하는 원시 타입의 뷰 버퍼를 생성할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ByteBuffer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Buffer</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Comparable</span> <span class=\"token punctuation\">{</span>\n  \n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">CharBuffer</span> <span class=\"token function\">asCharBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">ShortBuffer</span> <span class=\"token function\">asShortBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">IntBuffer</span> <span class=\"token function\">asIntBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">LongBuffer</span> <span class=\"token function\">asLongBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">FloatBuffer</span> <span class=\"token function\">asFloatBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">DoubleBuffer</span> <span class=\"token function\">asDoubleBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>    </code></pre></div>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bcf2377a68a305cc95f39ad0d3300f94/3a6ec/img_5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFElEQVR42n2RZ6rEMAyEc/+T5QbZ/MmGTds00nvR8gkc8iA8g7BsS6OZsSX/rOM45DxPjaf8aVlPlxSv6ypZlklVVZLnuRRFceVlWcr3+5WmaaTvexmGQbqu0x7rCWiaJpnnWRsAADhNU83jOJYkSSQIAgXZtk2WZdE+mCvgvu96yTSCR+4IGtjHcdQBBEDUM5j3uwUKaFjc5bEbebDiDgDkceYN1uSQMP4qYBiG4nmeNjGdJqKuax1i27ZEUSRGjeu6F8vX6yWO41yWKSAsDLvP53N5So5EwPENAJQYhlgDGYZB5o9kAKHu+75KI2g03r7fb/ULYH6Yc9u2WmM+SgGN9nvwAbAyRt/fzGIQNXyIqQHwB5utto08uG2NAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"char형 view buffer\"\n        title=\"\"\n        src=\"/static/bcf2377a68a305cc95f39ad0d3300f94/ca1dc/img_5.png\"\n        srcset=\"/static/bcf2377a68a305cc95f39ad0d3300f94/e7570/img_5.png 170w,\n/static/bcf2377a68a305cc95f39ad0d3300f94/f46e7/img_5.png 340w,\n/static/bcf2377a68a305cc95f39ad0d3300f94/ca1dc/img_5.png 680w,\n/static/bcf2377a68a305cc95f39ad0d3300f94/3a6ec/img_5.png 686w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">char형 view buffer</figcaption>\n  </figure></p>\n<h2 id=\"정리\" style=\"position:relative;\">정리<a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p><strong>버퍼 기반 I/O</strong></p>\n<ul>\n<li>운영체제의 모든 I/O 작업은 버퍼를 통해 이루어진다.</li>\n<li>프로세스는 데이터를 버퍼에 쓰거나 버퍼에서 데이터를 읽음으로써 I/O를 수행한다.</li>\n<li>사용자 공간에서는 하드웨어에 직접 접근할 수 없으며, 모든 I/O는 커널 공간을 통해 이루어진다.   </li>\n</ul>\n<p><strong>Java NIO</strong></p>\n<ul>\n<li>기존 java.io 라이브러리와 NIO의 주요 차이는 데이터 처리 방식에 있다.</li>\n<li>운영 체제는 데이터를 큰 덩어리(버퍼)로 처리하는 반면, 스트림 기반 I/O는 작은 단위로 데이터를 처리한다.</li>\n<li>NIO는 이러한 불일치를 해결하며, 한 번에 여러 바이트의 데이터 블록을 처리한다.   </li>\n</ul>\n<p><strong>Buffer</strong></p>\n<ul>\n<li>Buffer는 고정된 양의 데이터를 관리하는 컨테이너로, 데이터 전송의 출발지나 대상이 된다.</li>\n<li>Buffer는 채워지고 비워지며, 주요 속성으로는 mark, position, limit, capacity가 있다.</li>\n<li>Buffer는 데이터를 읽고 쓸 때 상대적 연산과 절대적 연산을 제공한다.   </li>\n</ul>\n<p><strong>ByteBuffer</strong></p>\n<ul>\n<li>ByteBuffer는 특별하며, 바이트 중심의 I/O 작업의 대상이 될 수 있다.</li>\n<li>ByteBuffer는 direct buffer와 non-direct buffer 두 종류가 있으며, direct buffer는 네이티브 메모리 영역에 직접 할당된다.</li>\n<li>뷰 버퍼는 원본 버퍼와 데이터를 공유하지만, 자체적인 속성을 가진다.</li>\n</ul>","fields":{"slug":"/java-nio-buffer/","thumbnail":null},"frontmatter":{"date":"October 03, 2023","update":"Oct 03, 2023","title":"Java NIO - Buffer","tags":["Java"],"thumbnail":null}},{"excerpt":"Channel Channel은 파일이나 소켓과 같은 엔티티 간에 데이터를 효율적으로 전송하는 통로이다.\n채널은 일반적으로 운영체제의 파일 디스크립터나 핸들러와 일대일 관계를 가진다.\n채널은 Java의 플랫폼 독립성을 유지하면서도 운영 체제의 네이티브 I/O 기능에 대한 추상화를 제공한다. 아래 그림은 Channel 클래스의 상속관계를 나타낸다.  계층구조…","html":"<h2 id=\"Channel\" style=\"position:relative;\">Channel<a href=\"#Channel\" aria-label=\"Channel permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Channel은 파일이나 소켓과 같은 엔티티 간에 데이터를 효율적으로 전송하는 통로이다.\n채널은 일반적으로 운영체제의 파일 디스크립터나 핸들러와 일대일 관계를 가진다.\n채널은 Java의 플랫폼 독립성을 유지하면서도 운영 체제의 네이티브 I/O 기능에 대한 추상화를 제공한다.</p>\n<p>아래 그림은 Channel 클래스의 상속관계를 나타낸다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/84b1c560243e23d2fe3d8bc7ce7e2bff/1e052/img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 131.1764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAADBElEQVR42oXVh27tOAwE0Pv/v5Qgvffee++9Nz4cAjTWi7xdA4p9JXI0M6SUTvzl+fn5yfHy8hJ7e3txdnYW7+/v8X9P578APcfHx9HX1xczMzPx8PDQWvsV8Pv7O97e3lrj9fU17u7u4vn5OTY3N2NkZCRGR0fj+vo6Pj4+4vPz86+gHTIEeL6+vjJpaWkpVlZWUurR0VHMz8/HxsZGbG1txe7ubszOzsbBwcGvjBMQUD1ra2vR1dUVPT09+b24uBjd3d3Nb5sNDQ3lPF9/BSyG3sDJxeDy8jKTFMb78fExx8nJSVxdXaWam5ubVrE6gs/Pz+Pw8DB9sjMg8qamppKRxPX19RgeHs63dWynp6czhyXyE1ABFhYWUlJvb28GSQK8vb2dXvLMmmSxNgFSBKjhbSPZwBIQADIuLi5iYmIi505PT3MeawOb+/v7tGF/fz8VtNpGskXe+Aag/0gz59smfOOhby2FyNPTU9ze3jZ16KiQBO2hTTTw8vJybgAY8xrAvVdXV9MOG5T/vhtAyZOTkzlIqKrZvVjzkc/j4+MZbw5Lj34E3ALkF5OBMhxbzLGUrOL9/f0J6HfJr43NNYCSxsbG8sySA8hQvWJoQ2u+Dd1RD6YNoKLYDSNDVVWyiqQA5GgnLKlwvlUWEbm1aasoOzs7aTRACc4uPxVLsGKR7KJw9MRXN3jriAZQlXhHNv+wcgQVB2uA1oHpADE2taYgerJh6A8m/HMJYGjRjoYTQD7JgDCuFkKEf/qwLopkaNFJkFBjbm4uWQAgSXXF+A2ogMtDqlpFQbtOBcaY8hEImSpuDZg35uKwI9vF3PJQMp+YX3LNuwh4hzHQYui3ItVVZr7xUH+5TSRXs7rWMAE2MDCQjEh3u7iA3Tplhze2DSB2g4OD2byOmMW6JDCofwVs0aO6wX2oECVVPLUJqKeqxxREPwLjz7+veLH6EAE+k6vSCtQA2hWgw48d2XavG0ThCpT0igWOtQqLbwBJcqxIBo4d4GqF+qdfseLI/mcbsYaHfwBJp4Fs8VqY8AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Channel 상속 관계\"\n        title=\"\"\n        src=\"/static/84b1c560243e23d2fe3d8bc7ce7e2bff/ca1dc/img.png\"\n        srcset=\"/static/84b1c560243e23d2fe3d8bc7ce7e2bff/e7570/img.png 170w,\n/static/84b1c560243e23d2fe3d8bc7ce7e2bff/f46e7/img.png 340w,\n/static/84b1c560243e23d2fe3d8bc7ce7e2bff/ca1dc/img.png 680w,\n/static/84b1c560243e23d2fe3d8bc7ce7e2bff/1e052/img.png 872w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Channel 상속 관계</figcaption>\n  </figure></p>\n<p>계층구조 상단에 WritableByteChannel과 ReadableByteChannel 인터페이스를 보게 되면 채널은 바이트 버퍼에 대해서만\n작동한다는 것을 짐작할 수 있다. 이는 운영체제의 저수준 I/O가 바이트 단위로 수행하기 때문이다.</p>\n<p>InterruptibleChannel 인터페이스는 채널이 안전하게 중단되고 닫힐 수 있도록 하는 메커니즘을 제공한다.\n스레드가 interruptible 채널에서 I/O 작업에 차단되어 있을 때, 해당 스레드의 interrupt 메서드를 호출하면 채널이 닫히고, 스레드의 중단 상태가 설정되며, 채널에서 ClosedByInterruptException이 발생한다.</p>\n<p>아래는 Channcel 인터페이스의 전체 소스이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Channel</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isOpen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"Channel-Open\" style=\"position:relative;\">Channel Open<a href=\"#Channel-Open\" aria-label=\"Channel Open permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>I/O는 크게 파일 I/O와 스트림(또는 소켓) I/O로 구분된다.\n<strong>Channel 상속 관계</strong> 이미지에서 확인할 수 있듯이 하나의 FileChannel과 세 개의 소켓 채널(SocketChannel, ServerSocketChannel, DatagramChannel)이 있음을 알 수 있다.</p>\n<p>FileChannel은 RandomAccessFile, FileInputStream, FileOutputStream 와 같은 객체에서 getChannel 메서드를 호출해야만 얻을 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">// 파일 채널 생성</span>\n<span class=\"token class-name\">RandomAccessFile</span> raf <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RandomAccessFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"somefile\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">FileChannel</span> fc <span class=\"token operator\">=</span> raf<span class=\"token punctuation\">.</span><span class=\"token function\">getChannel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>나머지 소켓 채널들은 팩토리 메서드를 통해 생성할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">SocketChannel</span> sc <span class=\"token operator\">=</span> <span class=\"token class-name\">SocketChannel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsc<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">InetSocketAddress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"somehost\"</span><span class=\"token punctuation\">,</span>someport<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">ServerSocketChannel</span> ssc <span class=\"token operator\">=</span> <span class=\"token class-name\">ServerSocketChannel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nssc<span class=\"token punctuation\">.</span><span class=\"token function\">socket</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">InetSocketAddress</span><span class=\"token punctuation\">(</span>somelocalport<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">DatagramChannel</span> dc <span class=\"token operator\">=</span> <span class=\"token class-name\">DatagramChannel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"채널-사용\" style=\"position:relative;\">채널 사용<a href=\"#%EC%B1%84%EB%84%90-%EC%82%AC%EC%9A%A9\" aria-label=\"채널 사용 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>채널은 단방향(unidirectional) 또는 양방향(bidirectional)일 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ReadableByteChannel</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Channel</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ByteBuffer</span> dst<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">WritableByteChannel</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Channel</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">int</span> <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ByteBuffer</span> src<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ReadableByteChannel 인터페이스는 read() 메서드를 정의하므로, 이를 구현하는 채널은 데이터를 읽을 수 있다.\n반대로 WritableByteChannel 인터페이스는 write() 메서드를 제공하므로, 이를 구현하는 채널은 데이터를 쓸 수 있다.\n어떤 채널 클래스가 두 인터페이스 중 하나만 구현하면 그 채널은 단방향이고, 두 인터페이스 모두를 구현하면 양방향 채널이 된다.</p>\n<p>ByteChannel 인터페이스는 ReadableByteChannel와 WritableByteChannel를 모두 확장하는데, 모든 File 채널과 소켓 채널이 ByteChannel을 확장하므로 양방향 채널이 된다.\n소켓은 항상 양방향이지만, 파일은 항상 그렇지 않다. 예를 들면 FileInputStream 객체에서 getChannel() 메서드로 얻는 FileChannel은 읽기 전용 채널이 된다.\n만약 해당 채널에 write를 하게 되면 NonWritableChannelException이 발생한다.</p>\n<p>아래는 System.in 채널에서 System.out 채널로 데이터를 복사하는 예제 코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ChannelCopy</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">ReadableByteChannel</span> source <span class=\"token operator\">=</span> <span class=\"token class-name\">Channels</span><span class=\"token punctuation\">.</span><span class=\"token function\">newChannel</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\">WritableByteChannel</span> dest <span class=\"token operator\">=</span> <span class=\"token class-name\">Channels</span><span class=\"token punctuation\">.</span><span class=\"token function\">newChannel</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">channelCopy1</span><span class=\"token punctuation\">(</span>source<span class=\"token punctuation\">,</span> dest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tsource<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tdest<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">channelCopy1</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ReadableByteChannel</span> src<span class=\"token punctuation\">,</span> <span class=\"token class-name\">WritableByteChannel</span> dest<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>\n\n\t\t<span class=\"token class-name\">ByteBuffer</span> buffer <span class=\"token operator\">=</span> <span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">.</span><span class=\"token function\">allocateDirect</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>src<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\tbuffer<span class=\"token punctuation\">.</span><span class=\"token function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tdest<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tbuffer<span class=\"token punctuation\">.</span><span class=\"token function\">compact</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\tbuffer<span class=\"token punctuation\">.</span><span class=\"token function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">.</span><span class=\"token function\">hasRemaining</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\tdest<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"ScatterGather\" style=\"position:relative;\">Scatter/Gather<a href=\"#ScatterGather\" aria-label=\"ScatterGather permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>Scatter/Gather 는 운영 체제에서 I/O 작업을 최적화하는 방법 중 하나이다.</p>\n<ul>\n<li>Scatter: 데이터를 여러 버퍼로 분산하여 읽는 것을 의미한다.</li>\n<li>Gather: 여러 버퍼에서 데이터를 모아서 쓰는 것을 의미한다.</li>\n</ul>\n<p>Scatter/Gather를 사용하면 여러 버퍼의 주소 목록을 한 번의 시스템 호출로 전달할 수 있다.\n이렇게 하면 사용자 프로세스가 여러 시스템 호출을 하는 것을 피할 수 있다.   </p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9360d4367299b407a6b6c26ffe473951/a31f0/img_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVR42nVSWaqEQAyc+19KQfDDFR1QBDcEBVFh3HfzqECLDG8CoeksVelKv67rovM8ad93Oo6DcBeOOHxdV1qWhWtE7pe90NC2LRVFQU3TcNN38ziO9Pl8OA5Dz09AFHmeR7quk23bZBgG+b5PrutSWZZMBkDYc/r/7jegaZrskiQxkGVZDJznOROBUBhkmeeZT2FPUAYMw5Bd0zRuxqTwLMuo73uq65q6rqM0TSmOY3Ich4Ig4DzqxQsYcNs2LlQUhWRZ5gkx1fv9Zk3BDAkQAyhAQAYgkFVVRUmSsOY3YBRFpKoqF6EBBYgBDMuABJBkGIZ7KeKJIMHLRI63PE0T64LRkYAjJr6RMPGNvpfy3PofAkhe5dqKWi8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"3개의 버퍼에서 scattering으로 read\"\n        title=\"\"\n        src=\"/static/9360d4367299b407a6b6c26ffe473951/ca1dc/img_1.png\"\n        srcset=\"/static/9360d4367299b407a6b6c26ffe473951/e7570/img_1.png 170w,\n/static/9360d4367299b407a6b6c26ffe473951/f46e7/img_1.png 340w,\n/static/9360d4367299b407a6b6c26ffe473951/ca1dc/img_1.png 680w,\n/static/9360d4367299b407a6b6c26ffe473951/a31f0/img_1.png 685w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">3개의 버퍼에서 scattering으로 read</figcaption>\n  </figure></p>\n<p>아래는 Scatter/Gather I/O를 지원하는 인터페이스이다. read, write 메서드에 ByteBuffer 배열을 인자로 받는 것을 확인할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">ScatteringByteChannel</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ReadableByteChannel</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">long</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> dsts<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> offset<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> length<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">long</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> dsts<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">GatheringByteChannel</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">WritableByteChannel</span> <span class=\"token punctuation\">{</span>\n\t\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">long</span> <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> srcs<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> offset<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> length<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\t\t\t\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">long</span> <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> srcs<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>아래는 Scatter로 두 개의 버퍼에 분산 저장하는 코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">ByteBuffer</span> header <span class=\"token operator\">=</span> <span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">.</span>allocateDirect <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">ByteBuffer</span> body <span class=\"token operator\">=</span> <span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">.</span>allocateDirect <span class=\"token punctuation\">(</span><span class=\"token number\">80</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buffers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> header<span class=\"token punctuation\">,</span> body <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">int</span> bytesRead <span class=\"token operator\">=</span> channel<span class=\"token punctuation\">.</span>read <span class=\"token punctuation\">(</span>buffers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>채널에 38byte가 준비되어 있다면 header에 10byte, body에 28byte가 저장된다.\n아래는 4개의 버퍼에 Scatter read를 사용한 모습이다.\n<figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/210a33dab5b459d05412c0295e64467e/e6e97/img_2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.64705882352941%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1UlEQVR42pVR2QrDMAzL/39goQ+lJ73vi94aMmR0pRtrQCRxYkm2FS5rXVd0XYdxHLFtG54udb7M84yiKGBZFjzPQ1VVj0k/CKdpgmEYiOMYtm0LOZ0uyyJifNc7cRzHO1ef1TUQRRGCIIDv+6jrGn3fSzLdlmWJpmmQ57mI7ft+7/CsxE9ZlglhmqYIw1BAUvaWAm3bCih4BitR52HofnF3HAeu64orJjPGhF+gGaX7wVKTJBFi9oluWPowDBL7eyicpmmakswzwRI5FA6HYne9+kb4ArBsbucsssTeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"scattering read using four buffers\"\n        title=\"\"\n        src=\"/static/210a33dab5b459d05412c0295e64467e/ca1dc/img_2.png\"\n        srcset=\"/static/210a33dab5b459d05412c0295e64467e/e7570/img_2.png 170w,\n/static/210a33dab5b459d05412c0295e64467e/f46e7/img_2.png 340w,\n/static/210a33dab5b459d05412c0295e64467e/ca1dc/img_2.png 680w,\n/static/210a33dab5b459d05412c0295e64467e/e6e97/img_2.png 864w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">scattering read using four buffers</figcaption>\n  </figure></p>\n<p>Scatter/Gather 적절하게 사용하면 읽은 데이터를 여러 버킷으로 분리하거나 서로 다른 데이터 덩어리를 전체 데이터로 모으는\n번거로운 작업을 운영체제에 위임하여, 시스템 호출을 줄이고 데이터 이동 작업을 줄일 수 있다.</p>\n<h2 id=\"File-Channel\" style=\"position:relative;\">File Channel<a href=\"#File-Channel\" aria-label=\"File Channel permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>FileChannel은 항상 블로킹 모드로 동작하며, 논블로킹 모드로 변경할 수 없다.\n논블러킹 모드가 파일 I/O에는 적용되지 않는 이유는 다음과 같다.</p>\n<ul>\n<li>캐싱과 최적화: 운영 체제의 캐싱과 최적화로 인해, 파일 I/O는 대부분의 경우 빠르게 처리된다. 따라서 논블로킹의 이점이 크게 나타나지 않을 수 있다.</li>\n<li>예측 가능한 데이터: 파일의 크기와 위치는 알려져 있기 때문에, 논블로킹 방식의 필요성이 상대적으로 줄어든다.</li>\n<li>구조화된 데이터: 파일의 구조화된 특성으로 인해, 스트림 지향 I/O와 같은 연속적인 데이터 흐름을 처리하는 논블로킹 방식이 필요하지 않을 수 있다.</li>\n</ul>\n<p>버퍼의 get()과 put() 메서드처럼, read()나 write()로 바이트를 전송할 때 파일의 위치도 자동으로 업데이트된다.\n파일의 위치가 size() 메서드로 반환되는 파일 크기에 도달하면, read()는 파일의 끝(end-of-file)을 나타내는 -1을 반환한다.   </p>\n<p>파일 크기를 넘어서 write()를 수행하면, 새로 쓰는 바이트를 수용하기 위해 파일 크기가 커진다. 이전 파일의 끝과 새로 추가된 바이트 사이의 바이트 값은 FileChannel 클래스에 의해 지정되지 않지만, 대부분의 경우 기본 파일 시스템의 동작을 반영한다.\n운영 체제나 파일 시스템 유형에 따라 파일에 구멍이 생길 수 있다.   </p>\n<p>파일 크기를 줄이려면, truncate()를 사용해 지정한 새 크기를 넘어서는 모든 데이터를 잘라낸다. 현재 크기가 새 크기보다 크면, 새 크기를 넘어서는 모든 바이트는 버려진다. 제공된 새 크기가 현재 파일 크기보다 크거나 같으면 파일은 수정되지 않는다. 어느 경우에든 truncate()의 부수 효과는 파일 위치를 제공된 새 크기로 설정하는 것이다.   </p>\n<p>파일이 로컬 파일 시스템에 있으면, force()에서 반환될 때 채널이 생성된 이후 (또는 마지막으로 force()가 호출된 이후) 파일에 대한 모든 수정 사항이 디스크에 기록되었음이 보장된다.\n이러한 동기화는 데이터 무결성과 신뢰할 수 있는 복구를 위해 중요하다. 예를 들어, 트랜잭션 처리와 같은 중요한 작업에서 이것은 필수적이다.   </p>\n<p>그러나 파일이 NFS와 같은 원격 파일 시스템에 있으면 이러한 동기화를 보장할 수 없다. 다른 파일 시스템에서도 구현에 따라 동일한 문제가 발생할 수 있다.\nJVM은 운영 체제나 파일 시스템이 지키지 않는 약속을 할 수 없다. 시스템 실패에도 데이터 무결성을 유지해야 하는 애플리케이션의 경우, 사용 중인 운영 체제나 파일 시스템이 그러한 측면에서 신뢰할 수 있는지 확인해야 한다.</p>\n<p>아래는 FileChannel로 파일을 Copy 하는 예제 코드이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FileCopyExample</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">String</span> sourceFilePath <span class=\"token operator\">=</span> <span class=\"token string\">\"원본파일경로/원본파일.txt\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\">String</span> destinationFilePath <span class=\"token operator\">=</span> <span class=\"token string\">\"대상파일경로/대상파일.txt\"</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token class-name\">FileInputStream</span> sourceStream <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileInputStream</span><span class=\"token punctuation\">(</span>sourceFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">FileOutputStream</span> destinationStream <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span>destinationFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token class-name\">FileChannel</span> sourceChannel <span class=\"token operator\">=</span> sourceStream<span class=\"token punctuation\">.</span><span class=\"token function\">getChannel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">FileChannel</span> destinationChannel <span class=\"token operator\">=</span> destinationStream<span class=\"token punctuation\">.</span><span class=\"token function\">getChannel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token class-name\">ByteBuffer</span> buffer <span class=\"token operator\">=</span> <span class=\"token class-name\">ByteBuffer</span><span class=\"token punctuation\">.</span><span class=\"token function\">allocate</span><span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">int</span> bytesRead<span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>bytesRead <span class=\"token operator\">=</span> sourceChannel<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\tbuffer<span class=\"token punctuation\">.</span><span class=\"token function\">flip</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 버퍼를 읽기 모드로 전환</span>\n\t\t\t\tdestinationChannel<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 버퍼의 내용을 대상 파일로 복사</span>\n\t\t\t\tbuffer<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 버퍼를 초기화하여 다시 쓰기 모드로 전환</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\n\t\t\tsourceStream<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tdestinationStream<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tsourceChannel<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tdestinationChannel<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"파일이 복사되었습니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\te<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"Memory-Mapped-Files\" style=\"position:relative;\">Memory-Mapped Files<a href=\"#Memory-Mapped-Files\" aria-label=\"Memory Mapped Files permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>FileChannel 클래스의 map() 메서드를 사용하면, 파일과 특별한 유형의 ByteBuffer 사이에 가상 메모리 매핑을 설정할 수 있다. 이렇게 하면 디스크 파일을 기반으로 한 가상 메모리 매핑이 생성되고, 해당 가상 메모리 공간 주위에 MappedByteBuffer 객체가 감싸진다.   </p>\n<p>map()에서 반환된 MappedByteBuffer 객체는 대부분의 면에서 메모리 기반 버퍼처럼 동작한다. 그러나 그 데이터 요소는 디스크에 있는 파일에 저장된다. get()을 호출하면 디스크 파일에서 데이터를 가져오며, 매핑이 설정된 이후에 외부 프로세스에 의해 파일이 수정되었더라도 현재 파일의 내용을 반영한다.    </p>\n<p>메모리 매핑 메커니즘을 통해 파일에 접근하는 것은 채널을 사용할 때조차도 전통적인 방법으로 데이터를 읽거나 쓰는 것보다 훨씬 효율적일 수 있다. 명시적인 시스템 호출을 할 필요가 없기 때문이다. 더 중요한 것은 운영 체제의 가상 메모리 시스템이 자동으로 메모리 페이지를 캐시한다는 것이다.   </p>\n<p>유효한 메모리 페이지가 한 번 생성되면, 다른 시스템 호출을 하지 않고도 전체 하드웨어 속도로 다시 접근할 수 있다. 메모리 매핑을 활용하면, 자주 참조되거나 업데이트되는 인덱스나 다른 섹션이 포함된 큰 구조화된 파일에서 큰 이점을 얻을 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">FileChannel</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractChannel</span>\n\t\t<span class=\"token keyword\">implements</span> <span class=\"token class-name\">ByteChannel</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">GatheringByteChannel</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">ScatteringByteChannel</span> <span class=\"token punctuation\">{</span>\n  \n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">MappedByteBuffer</span> map <span class=\"token punctuation\">(</span><span class=\"token class-name\">MapMode</span> mode<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> position<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MapMode</span> <span class=\"token punctuation\">{</span>\n\n\t\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MapMode</span> <span class=\"token constant\">READ_ONLY</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MapMode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"READ_ONLY\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MapMode</span> <span class=\"token constant\">READ_WRITE</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MapMode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"READ_WRITE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MapMode</span> <span class=\"token constant\">PRIVATE</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MapMode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"PRIVATE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token punctuation\">}</span>\n \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>아래 코드는 FileChannel의 전체 파일 데이터에 대해서 MappedByteBuffer를 생성하는 예이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">buffer <span class=\"token operator\">=</span> fileChannel<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FileChannel<span class=\"token punctuation\">.</span>MapMode</span><span class=\"token punctuation\">.</span><span class=\"token constant\">READ_ONLY</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> fileChannel<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>맵핑 모드는 읽기 전용(MapMode.READ<em>ONLY) 또는 읽기/쓰기(MapMode.READ</em>WRITE)를 나타낼 수 있다. 요청한 매핑 모드는 map() 메서드가 호출되는 FileChannel 객체의 액세스 권한에 따라 제한될 수 있다.   </p>\n<p>MapMode.PRIVATE 모드는 복사 후 쓰기 매핑을 원한다는 것을 나타낸다. 이는 put()을 통해 만든 모든 수정 사항이 MappedByteBuffer 인스턴스만 볼 수 있는 개인 데이터 복사본을 생성한다는 것을 의미한다. 기본 파일에는 변경 사항이 적용되지 않으며, 버퍼가 가비지 컬렉션될 때 변경 사항은 손실된다.   </p>\n<p>복사 후 쓰기는 운영 체제에서 프로세스가 다른 프로세스를 생성할 때 가상 주소 공간을 관리하는 데 일반적으로 사용되는 기술이다. 복사 후 쓰기를 사용하면 부모 프로세스와 자식 프로세스가 메모리 페이지를 공유할 수 있게 되며, 이로 인해 동일한 파일의 여러 매핑에 대한 많은 이점이 생길 수 있다.</p>\n<p>그런데 여기서 중요한 점은, 버퍼가 해당 파일 영역을 아직 수정하지 않았을 때, 실제 파일의 해당 영역에 다른 방법(다른 프로세스나 애플리케이션)으로 변경이 발생하면, MapMode.PRIVATE 모드로 생성된 버퍼는 그 변경 사항을 볼수 있다. 즉, 파일의 원본 데이터가 변경되면, 해당 변경은 버퍼에도 반영된다.</p>\n<p>하지만, 버퍼가 이미 해당 파일 영역을 수정한 경우, 버퍼는 그 영역의 복사본을 가지고 있게 된다. 따라서, 이후에 실제 파일의 해당 영역에 변경이 발생하더라도, 버퍼는 그 변경을 반영하지 않고, 본인이 수정한 복사본의 데이터를 유지한다.   </p>\n<p>예를 들어, 파일에 \"Hello\"라는 문자열이 있고, 이를 MapMode.PRIVATE 모드로 매핑하여 버퍼를 생성했다고 가정하자.\n이후, 다른 프로세스에서 파일의 \"Hello\"를 \"World\"로 변경하면, 버퍼는 \"World\"를 볼 수 있다.\n그러나, 버퍼가 먼저 \"Hello\"를 \"Java\"로 변경한 후에 파일이 \"World\"로 바뀌면, 버퍼는 여전히 \"Java\"를 보게 된다.</p>\n<p>MappedByteBuffer의 isLoaded 메서드는 매핑된 파일이 완전히 메모리에 로드되어 있는지 확인하는 데 사용된다.\ntrue를 반환하면 매핑된 버퍼에 접근할 때 지연이 거의 없거나 전혀 없을 가능성이 높다. false를 반환해도 파일이 메모리에 완전히 로드되지 않았다는 것을 의미하지는 않는다.\n이 메서드는 보증이 아닌 힌트를 제공한다.   </p>\n<p>force 메서드는 MappedByteBuffer에서의 변경 사항을 디스크에 flush한다.\nMappedByteBuffer를 통해 파일을 업데이트할 때는 FileChannel.force() 대신 MappedByteBuffer.force()를 사용해야 한다.</p>\n<h2 id=\"Socket-Channel\" style=\"position:relative;\">Socket Channel<a href=\"#Socket-Channel\" aria-label=\"Socket Channel permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>java.nio 의 Socket Channel은 네트워크 소켓을 모델링한 클래스이다. 파일 채널과는 다르게 nonblocking 모드가 가능하며,\n소켓 연결을 위해 스레드를 할당할 필요가 없으며 하나의 스레드로도 수천 개의 소켓 연결을 관리할 수 있다.</p>\n<p>소켓 채널은 기존의 java.net에 있는 소켓이 프로토콜 연산 대부분에 재사용된다.</p>\n<p>다음 메서드는 채널의 차단 모드와 관련된 메서드이다. 모든 소켓 채널(SocketChannel, ServerSocketChannel, DatagramChannel)이 생성될 때는 그에 대응하는 피어 소켓 객체가 함께 생성된다.\n이 피어 소켓은 Socket, ServerSocket, DatagramSocket 클래스 중 하나이다.</p>\n<p>소켓 채널은 프로토콜 연산을 해당 피어 소켓 객체에 위임한다.\n채널 클래스에서 소켓 메서드가 중복되어 보이는 경우, 그 메서드에는 채널 클래스에만 해당하는 다른 연산이 있다는 의미이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SelectableChannel</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractInterruptibleChannel</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Channel</span> <span class=\"token punctuation\">{</span>\n\t\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">void</span> configureBlocking <span class=\"token punctuation\">(</span><span class=\"token keyword\">boolean</span> block<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isBlocking</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">blockingLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>채널의 블로킹 모드로 설정하려면 configureBlocking() 메서드에 true를 인수로 전달하고, 논블로킹 모드로 설정하려면 false를 인수로 전달하면 된다.</p>\n<p>채널이 현재 어떤 모드에 있는지 확인하려면 isBlocking() 메서드로 알 수 있다.</p>\n<p>blockingLock()으로 반환된 객체는 채널이 블로킹 모드에 변경을 할 때 내부적으로 사용하는 모니터 객체이다.\n이 객체에 잠금을 보유한 스레드만 채널의 블로킹 모드를 변경할 수 있다.\n코드의 중요한 부분 동안 소켓의 블로킹 모드가 변경되지 않도록 하거나, 다른 스레드에 영향을 주지 않고 일시적으로 모드를 변경하는 데 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Object</span> lockObj <span class=\"token operator\">=</span> serverChannel<span class=\"token punctuation\">.</span><span class=\"token function\">blockingLock</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsynchronize <span class=\"token punctuation\">(</span>lockObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">boolean</span> prevState <span class=\"token operator\">=</span> serverChannel<span class=\"token punctuation\">.</span><span class=\"token function\">isBlocking</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  serverChannel<span class=\"token punctuation\">.</span>configureBlocking <span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  socket <span class=\"token operator\">=</span> serverChannel<span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  serverChannel<span class=\"token punctuation\">.</span>configureBlocking <span class=\"token punctuation\">(</span>prevState<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"ServerSocketChannel\" style=\"position:relative;\">ServerSocketChannel<a href=\"#ServerSocketChannel\" aria-label=\"ServerSocketChannel permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>ServerSocketChannel 객체는 내부적으로 ServerSocket 객체(피어 소켓)와 연관되어 있으며,\n이를 통해 일반적인 소켓 연산, 포트 바인딩 등의 작업을 수행할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">ServerSocketChannel</span> ssc <span class=\"token operator\">=</span> <span class=\"token class-name\">ServerSocketChannel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">ServerSocket</span> serverSocket <span class=\"token operator\">=</span> ssc<span class=\"token punctuation\">.</span><span class=\"token function\">socket</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nserverSocket<span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">InetSocketAddress</span><span class=\"token punctuation\">(</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ServerSocketChannel와 기존 ServerSocket 모두 accept() 라는 메서드를 가지고 있다.\n이 메서드는 들어오는 클라이언트 연결을 수락하기 위해 사용된다.</p>\n<p>ServerSocket의 accept() 메서드는 항상 blocking 모드로 동작한다.  즉, 서버는 새로운 연결이 수락될 때까지 대기하게 된다.   </p>\n<p>ServerSocketChannel의 accept() 메서드는 nonblocking 모드로 동작할 수 있다. 즉, 호출 시점에 수락할 연결이 없다면 null을 반환하게 된다.\n따라서, 서버는 새 연결을 기다리는 동안 다른 작업을 계속 수행할 수 있다.   </p>\n<p>ServerSocketChannel은 Selector와 함께 사용했을 때, 새 연결이 도착했을 때 이벤트를 받을 수 있다.</p>\n<h3 id=\"SocketChannel\" style=\"position:relative;\">SocketChannel<a href=\"#SocketChannel\" aria-label=\"SocketChannel permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>모든 SocketChannel 객체는 피어 객체인 Socket과 함께 생성된다.\nSocketChannel의 static 메서드인 open() 메서드는 새로운 SocketChannel 객체를 생성한다.\n새 SocketChannel에서 socket()을 호출하면 해당 피어 Socket 객체가 반환딘다.\n해당 Socket에서 getChannel()을 호출하면 원래 SocketChannel이 반환된다.</p>\n<p>SocketChannel의 연결은 open() 이나 connect() 메서드를 통해 이루어진다.\n아래는 SocketChannel 연결의 예이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">SocketChannel</span> socketChannel <span class=\"token operator\">=</span> <span class=\"token class-name\">SocketChannel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">InetSocketAddress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"8080\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">SocketChannel</span> socketChannel <span class=\"token operator\">=</span> <span class=\"token class-name\">SocketChannel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsocketChannel<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">InetSocketAddress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"8080\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>nonblocking 모드에서 connect()를 호출해서 반환값이 true이면 연결이 즉시 성립되었다는 것이고, 연결이 즉시 성립되지 않으면 connect()는 false를 반환된다.</p>\n<p>만약 연결이 바로 성립되지 않는 경우 (서버에 연결하는 데 시간이 걸리는 경우), 연결은 백그라운드에서 계속 진행된다.\nisConnectPending() 메서드는 연결이 백그라운드에서 진행 중인지 확인할 수 있다.\n예를 들어, 소켓 채널을 nonblocking 모드로 설정하고 연결을 시도했을 때 연결이 즉시 성립되지 않으면 isConnectPending() 메서드는 true를 반환하고, 연결이 성립되가니 연결이 시작되지 않았을 경우 false를 반환한다.</p>\n<p>finishConnect() 메서드는 nonblocking 모드에서 연결을 시도한 후 연결 상태를 확인하는 데 사용된다.\n연결이 성립되었을 경우 true를 반환하고, 그렇지 않을 경우 false를 반환하거나 연결 과정이 시작되지 않았을 때(connect 호출 전) 예외를 발생시킨다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">InetSocketAddress</span> addr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">InetSocketAddress</span><span class=\"token punctuation\">(</span>host<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">SocketChannel</span> sc <span class=\"token operator\">=</span> <span class=\"token class-name\">SocketChannel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsc<span class=\"token punctuation\">.</span>configureBlocking <span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsc<span class=\"token punctuation\">.</span>connect <span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">finishConnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token function\">doSomethingElse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">doSomethingWithChannel</span><span class=\"token punctuation\">(</span>sc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsc<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"참조\" style=\"position:relative;\">참조<a href=\"#%EC%B0%B8%EC%A1%B0\" aria-label=\"참조 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>Java NIO(Ron Hitchens)</li>\n</ul>","fields":{"slug":"/java-nio-channel/","thumbnail":null},"frontmatter":{"date":"October 14, 2023","update":"Oct 14, 2023","title":"Java NIO - Channel","tags":["Java"],"thumbnail":null}},{"excerpt":"Selector Buffer 편에서도 보았듯이, java.nio 는 기존 Java I/O의 한계를 극복하기 위해서 탄생되었다. \nC/C++의 경우에는 이미 POSIX 계열 OS의 select()나 poll() 같은 시스템 호출로 멀티플렉싱을 구현하였지만 기존 Java I/O는 이를 사용할 수 없었다. Selector는 멀티플렉싱 I/O를 가능하게 한다. …","html":"<h2 id=\"Selector\" style=\"position:relative;\">Selector<a href=\"#Selector\" aria-label=\"Selector permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Buffer 편에서도 보았듯이, java.nio 는 기존 Java I/O의 한계를 극복하기 위해서 탄생되었다.\nC/C++의 경우에는 이미 POSIX 계열 OS의 select()나 poll() 같은 시스템 호출로 멀티플렉싱을 구현하였지만 기존 Java I/O는 이를 사용할 수 없었다.</p>\n<p>Selector는 멀티플렉싱 I/O를 가능하게 한다. 멀티플렉싱 I/O는 단일 스레드 또는 프로세스가 여러 I/O 작업을 모니터링하고, 준비된 작업에만 대한 처리를 수행하는 방식을 의미한다.</p>\n<p>Selector는 여러 SelectableChannel 객체를 등록하고, 등록된 채널들 중 어떤 채널이 준비된 상태인지 확인하는 역할을 한다.\nselect() 메서드를 호출하면 Selector는 등록된 채널들을 확인하고, 준비된 채널들의 SelectionKey를 반환한다.</p>\n<p>SelectionKey는 SelectableChannel과 Selector 간의 연결을 나타내는 키이다.\nSelectionKey는 각 채널의 관심 작업(읽기, 쓰기 등)을 기억하며, 해당 채널이 현재 어떤 작업을 수행할 준비가 되었는지 모니터링한다.</p>\n<p>SelectableChannel은 I/O 채널을 나타내는 추상 클래스이다. SocketChannel, ServerSocketChannel 등이 이를 구현한다.\nSelectableChannel은 Selector와 함께 사용되어 특정 작업(읽기,쓰기 등)을 수행할 수 있는지 확인합니다.</p>\n<p>멀티플렉싱 구현의 핵심은 준비된 상태의 채널을 쉽게 확인할 수 있다는 것에 있다. 이를 준비성 선택(readiness selection)이라고 한다.</p>\n<p>준비성 선택은 언뜻보면 non-blocking 모드와 폴링으로 구현이 가능할 것 같지만 작업의 준비 여부를 확인하는 코드와 데이터를 처리하는 코드를 분리하기 어려울 수 있다.\n또한, non-blocking 모드로 각 채널에 대해 직접 준비 여부를 물어보는 것은 많은 시스템 호출로 비용이 많이 드는 작업이다.</p>\n<p>nio 이전에는 준비성 선택을 흉내내기 위해 각 소켓에 대한 각각의 스레드를 만들고 read() 메서드에서 데이터를 기다리도록 하는 방법이 사용되었다.\n이렇게 하면 각 스레드가 소켓 모니터 역할을 수행하고 JVM의 스레드 스케줄러가 알림 메커니즘 역할을 수행한다.</p>\n<p>Java NIO에서는 준비성 선택을 운영 체제에 위임하고, Selector 클래스를 통해 이용할 수 있다.\nSelector는 여러 채널의 상태를 모니터링하고, 해당 채널이 준비 상태인 경우 알려줌으로써 효율적인 I/O 처리를 가능하게 한다.\n이를 통해 다수의 클라이언트와 연결을 관리하고 데이터를 처리할 수 있다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 606px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2168fc5feabb8bd7c1cb526019e46b74/cec09/img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.235294117647065%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABbUlEQVR42nWSbcuCYAyF+/9/qrDIoC99ycyyqDRIK8RKe19cg0nm8wjDm7PtbGdb6/V6CV8URXK5XPRt2Pl8ltPpVMPKshTP8/T9fr8b1sJxv99lNBrJbrerAvnm87naN7bf78VxnKq44fYpIc4gCGqE2GKxkPV6Lc/ns0pIkkTG47FkWSaPx0M7vl6vasS1TNpsNmt0iLTpdKpyDUvTVFzX1U4hYSQ0BAcFlBAHiYfDoSF5uVzWMGLo8F/Jt9tNmSE8Ho/6NttsNmpIMYwYxsOb3O+FKCGVkAHharXSynEca9ckgiOHKyiKQmfq+75st1vNg7TWIRXZcL/fl8FgoIsIw1DJu92u4pBizJSYXq+nvuFw2CS0DTEXKtKhYciFmE1inBcxxEJEbGOGeZ7rxpDClhk6Sfwnk0k1WzDiiKEIfk7o+6SUkABmhVQ7ZIwzarfb0ul09G0447BYijUk21Ko/mscL/aXz1T8Sv4ABrmOHmaMKX8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"selection 연관 클래스들 관계\"\n        title=\"\"\n        src=\"/static/2168fc5feabb8bd7c1cb526019e46b74/cec09/img.png\"\n        srcset=\"/static/2168fc5feabb8bd7c1cb526019e46b74/e7570/img.png 170w,\n/static/2168fc5feabb8bd7c1cb526019e46b74/f46e7/img.png 340w,\n/static/2168fc5feabb8bd7c1cb526019e46b74/cec09/img.png 606w\"\n        sizes=\"(max-width: 606px) 100vw, 606px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">selection 연관 클래스들 관계</figcaption>\n  </figure></p>\n<p>위 그림은 아래 코드로 표현할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Selector</span> selector <span class=\"token operator\">=</span> <span class=\"token class-name\">Selector</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchannel1<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_READ</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchannel2<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_WRITE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchannel3<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_READ</span> <span class=\"token operator\">|</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_WRITE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 채널이 준비될 때까지 최대 10초간 블록킹된다.</span>\nreadyCount <span class=\"token operator\">=</span> selector<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>이 코드는 Selector를 생성한 다음, 각각 다른 관심사 집합을 가지는 기존의 세 개의 소켓 채널을 Selector에 등록한다.\nselector.select(10000) 는 등록된 채널에서 관심 이벤트가 발생할 때까지 최대 10초간 블록킹된다.</p>\n<p>아래는 Selector의 주요 API 목록이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Selector</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Closeable</span> <span class=\"token punctuation\">{</span>\n\n\t\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Selector</span> <span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">SelectorProvider</span><span class=\"token punctuation\">.</span><span class=\"token function\">provider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">openSelector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isOpen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">SelectorProvider</span> <span class=\"token function\">provider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">Set</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">Set</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">selectedKeys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">int</span> <span class=\"token function\">selectNow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">int</span> <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> timeout<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\t\t\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">int</span> <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">Selector</span> <span class=\"token function\">wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">void</span> <span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"SelectableChannel\" style=\"position:relative;\">SelectableChannel<a href=\"#SelectableChannel\" aria-label=\"SelectableChannel permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SelectableChannel</span>\n    <span class=\"token keyword\">extends</span> <span class=\"token class-name\">AbstractInterruptibleChannel</span>\n    <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Channel</span>\n<span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">SelectorProvider</span> <span class=\"token function\">provider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">int</span> <span class=\"token function\">validOps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isRegistered</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">SelectionKey</span> <span class=\"token function\">keyFor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Selector</span> sel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">SelectionKey</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Selector</span> sel<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> ops<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ClosedChannelException</span><span class=\"token punctuation\">;</span>\n\t\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">SelectionKey</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Selector</span> sel<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> ops<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> att<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">throws</span> <span class=\"token class-name\">ClosedChannelException</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Selector의 채널 등록은 SelectableChannel 의 register()로 할 수 있다.\nregister는 Selector 객체와 ops라는 정수 매개변수를 인자로 받는다.</p>\n<p>ops 매개변수는 채널이 등록되는 관심 작업 집합을 나타낸다.\n이 값은 채널의 준비 상태를 확인할 때 Selector가 확힌해야 하는 I/O 작업을 비트 마스크로 표현한 것이다.\n구체적인 작업 비트는 SelectionKey 클래스의 public static 필드로 정의되어 있다.</p>\n<p>JDK 1.4부터는 읽기(OP_READ), 쓰기(OP_WRITE), 연결(OP_CONNECT), 수락(OP_ACCEPT) 작업이 정의되어 있다.\n각 채널마다 지원되는 작업이 있다. SocketChannel의 경우 accept 작업을 수행할 수 없다.\n지원되지 않는 작업에 채널을 Selector에 등록하려고 하면 Exception이 발생한다. validOps() 메서드를 사용하면 해당 채널이 허용하는 작업 집합(비트 마스크)을 얻을 수 있다.</p>\n<p>두번째 register() 메서드에는 att 라는 Objcet를 받는 것을 확인할 수 있다. 해당 객체 참조를 SelectionKey이 전달하고 attch()로 해당 참조를 다시 얻을 수 있다.</p>\n<p>하나의 채널 객체는 여러 Selector에 등록될 수 있다. 채널이 현재 어떤 선택기에 등록되어 있는지 확인하려면 isRegistered() 메서드를 호출하면 된다.\n이 메서드는 채널이 적어도 하나의 선택기에 등록되어 있는지 여부에 대한 정보를 제공하지만, 채널이 어떤 선택기에 등록되어 있는지에 대한 정보는 제공하지 않는다.</p>\n<p>각 채널의 Selector와 채널 등록은 SelectionKey 으로 캡슐화된다. keyFor() 메서드는 특정 채널과 주어진 Selector에 연결된 SelectionKey를 반환한다.</p>\n<h2 id=\"SelectionKey\" style=\"position:relative;\">SelectionKey<a href=\"#SelectionKey\" aria-label=\"SelectionKey permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>SelectionKey는 특정 채널을 특정 Selector와 등록 관계를 나타내며, 해당 채널을 모니터링하고 제어할 수 있다.\n아래는 SelectionKey의 주요 API와 설명이다. </p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SelectionKey</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">OP_READ</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">OP_WRITE</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">OP_CONNECT</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">int</span> <span class=\"token constant\">OP_ACCEPT</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">SelectableChannel</span> <span class=\"token function\">channel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">Selector</span> <span class=\"token function\">selector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">void</span> <span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isValid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">int</span> <span class=\"token function\">interestOps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">void</span> <span class=\"token function\">interestOps</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> ops<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">int</span> <span class=\"token function\">readyOps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isReadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isWritable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isConnectable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isAcceptable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">attach</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> ob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">attachment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>channel()</h4>\n<p>SelectionKey와 관련된 SelectableChannel 객체를 반환한다.</p>\n<h4>selector()</h4>\n<p>SelectionKey와 관련된 Selector 객체를 반환한다.</p>\n<h4>cancel()</h4>\n<p>Selector와 Channel 관계를 해지할 때 사용된다. 해당 선택 키가 무효화되고 연결이 해제된다.\n다만, SelectionKey이 취소된다고 해도 Selector에 채널은 등록된 상태로 남아있다. 채널은 Selector의 다음 select() 메서드 호출 또는 진행 중인 select() 메서드 완료 시점에 해지된다.\n채널이 취소된 SelectionKey와 함께 Selector 등록된 상태에서 해당 SelectionKey를 사용하려고 시도하면 CancelledKeyException이 발생한다.</p>\n<h4>isValid()</h4>\n<p>키가 아직 유효한 등록을 나타내는지 확인한다. 채널이 닫히면 해당 채널과 관련된 모든 SelectionKey이가 자동으로 무효화 된다.</p>\n<h4>interestOps()</h4>\n<p>현재 SelectionKey의 관심 작업 집합을 반환한다. 이 값은 SelectableChannel.register 로 등록할 때 전달된 값이다.\n인수있는 interestOps()를 호출하면 새로운 관심 작업 집합을 설정할 수 있다.</p>\n<h4>readyOps()</h4>\n<p>현재 선택 키와 관련된 채널에서 실제로 수행 가능한 I/O 작업의 집합을 반환한다.\n이 집합은 최근 select() 메서드 호출로 결정된 것으로, 관심 작업 집합 중에서 실제로 수행 가능한 작업을 나타낸다.   </p>\n<p>중요한 점은 readyOps()의 반환값은 절대적인 보장을 의미하는 것은 아니다.\nreadyOps은 Selector가 마지막으로 등록된 채널들의 상태를 확인한 시점에서의 정보를 담고 있기 때문이다.\n따라서, 멀티스레딩 환경에서는 주의가 필요하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">int</span> readyOps <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">readyOps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>readyOps <span class=\"token operator\">&amp;</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_READ</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  key<span class=\"token punctuation\">.</span><span class=\"token function\">channel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read <span class=\"token punctuation\">(</span>myBuffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>isReadable()</h4>\n<p>isReadable(), isWritable(), isConnectable(), isAcceptable() 각 메서드는 채널이 각 작업에 대해 준비 상태인지를 검사하는 역할을 한다.\n예를 들어 <code class=\"language-text\">key.isWritable()</code> 는 <code class=\"language-text\">(key.readyOps() &amp; SelectionKey.OP_WRITE) != 0</code> 와 동일하다.</p>\n<h4>attach()</h4>\n<p>이 메서드는 SelectionKey에 첨부 객체를 설정할 수 있다. 일반적으로 핸들러 객체, 비즈니스 객체, 다른 채널 등과 관련짓는 데 사용할 수 있다.\nSelectableChannel.register의 att 매개변수와 동일하게 사용된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">SelectionKey</span> key <span class=\"token operator\">=</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_READ</span><span class=\"token punctuation\">,</span> myObject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>위의 코드는 아래 코드와 동일하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">SelectionKey</span> key <span class=\"token operator\">=</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_READ</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nkey<span class=\"token punctuation\">.</span><span class=\"token function\">attach</span><span class=\"token punctuation\">(</span>myObject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4>attachment()</h4>\n<p>이 메서드를 호출하면 SelectionKey에 첨부된 객체 핸들을 가져올 수 있다.\n만약 첨부된 객체가 설정되지 않았거나 명시적으로 null이 지정되었다면 이 메서드는 null을 반환한다.</p>\n<h2 id=\"Selector-동작원리\" style=\"position:relative;\">Selector 동작원리<a href=\"#Selector-%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC\" aria-label=\"Selector 동작원리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Selector는 등록된 채널들의 집합을 관리하며, 각 등록은 SelectionKey 객체로 캡슐화된다.\nSelector 객체는 세 가지 종류의 키 집합을 유지한다.</p>\n<ul>\n<li><strong>Registered key set</strong>은 Selector에 등록된 모든 키 집합을 나타낸다. keys() 메서드로 가져올 수 있다.   </li>\n<li><strong>Selected key set</strong>은 등록된 키의 관심 작업 집합 중 적어도 하나의 작업에 대해 준비가 된 키 집합을 의미한다.\nselectedKeys() 메서드로 가져올 수 있다.</li>\n<li><strong>Cancelled key set</strong>은 cancel()로 무효환된 키들의 집합이다. 비공개로 유지되어 직접 접근할 수 없다.</li>\n</ul>\n<p>Selector에서 select() 메서드를 호출하면 다음 세 단계가 수행된다.</p>\n<h4>취소된 키 확인</h4>\n<p>취소된 키 집합을 확인한다. 취소된 키가 있다면 이들은 다른 두 키 집합(Registered key set, elected key set)에서 제거되고, 관련된 채널은 등록 해제된다.\n이 부분은 SelectionKey의 cancel() 메서드에서 이미 설명했다.</p>\n<h4>작업 관심 집합 확인</h4>\n<p>등록된 키 집합의 각 키의 작업 관심 집합을 조사한다.\n이 시점 이후에 작업 관심 집합에 대한 변경 사항은 고려되지 않는다.</p>\n<h4>채널 준비 상태 확인</h4>\n<p>OS에게 현재 채널의 작업 관심 상태를 확인하도록 요청한다.\n이때 스레드는 현재 채널이 준비되지 않았다면 일정 시간 동안 blocking될 수 있다.\n시스템 호출이 완료되면 채널의 준비 상태가 결정된다.</p>\n<p>그 후, OS로부터 각 채널의 키에 대한 <strong>준비된 집합(ready sets)</strong>을 얻게 되는데, 각각의 키가 Selected key set에 포함되지 않으면 해당 키를 Selected key set 에 추가한다.</p>\n<p>만약, 채널의 키가 Selected key set에 이미 포함되어 있다면, 현재 채널이 어떤 작업에(OP_XXXX) 준비되어 있는지를 나타내는 비트를 업데이트한다.</p>\n<h4>취소된 키 재확인</h4>\n<p><strong>채널 준비 상태 확인</strong>에서 스레드가 블록킹되어 시간이 많이 흐를 수 있다. 그 동안 SelectionKey가 취소될 수 있기 때문에 취소된 키를 재확인한다.</p>\n<h4>결과값 리턴</h4>\n<p>select() 메서드로 반환되는 값은 <strong>채널 준비 상태 확인</strong>에서 준비된 집합(ready sets)이 수정된 키의 수를 나타낸다.\nSelection key set 내의 모든 채널의 총 수가 아닌, select 메서드 호출 간에 준비된 채널의 수를 나타낸다.</p>\n<p>예를 들어, 첫 번째 select() 호출에서 2개의 채널이 작업 준비 상태로 판단되면 반환값은 2개 된다.\n두 번째 호출에서 1개의 추가 채널이 작업 준비 상태로 추가되면 반환값 1이 된다.\n세 번째 호출에서 아무 채널도 변경사항이 없으면 반환값은 0이 된다.</p>\n<p>Selector 클래스에는 세 가지 형태의 select() 메서드가 있다. 각각에 대해 알아보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> selector<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>인수없는 select() 는 준비된 채널이 생길 때 까지 블로킹된다. 따라서 반환값은 항상 0 보다 큰 값을 가진다.\n만약, 다른 스레드에서 wakeup() 메서드를 호출하면 0이 반환될 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> selector<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token number\">100000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>다음은 long timeout 매개변수를 받는 select 이다. 준비된 채널을 확인하기 위해  최대 해당 시간만큼 대기할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> selector<span class=\"token punctuation\">.</span><span class=\"token function\">selectNow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>non-blocking 모드의 select 메서드이다. 준비된 채널이 없으면 0을 반환한다.</p>\n<h2 id=\"Selection-작업-중지하기\" style=\"position:relative;\">Selection 작업 중지하기<a href=\"#Selection-%EC%9E%91%EC%97%85-%EC%A4%91%EC%A7%80%ED%95%98%EA%B8%B0\" aria-label=\"Selection 작업 중지하기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h4>wakeup()</h4>\n<p>Selector 객체에 대해 wakeup() 메서드를 호출하면 해당 Selector에서 select() 작업이 진행 중이라면 0을 반환시킨다.\n현재 select() 작업 중이 아니라면, 다음 select() 메서드를 호출할 때 selectNow()로 동작되어 즉시 반환된다. 그 후의 select 호출은 정상적으로 동작된다.</p>\n<h4>close()</h4>\n<p>Selector를 닫으면 현재 선택 작업 중인 스레드를 즉시 깨우고 해당 Selector와 관련된 리소스를 정리한다.</p>\n<h4>interrupt()</h4>\n<p>블로킹된 스레드의 interrupt() 메서드가 호출되면 해당 스레드의 \"인터럽트 상태\"가 설정된다.\n스레드의 인터럽트 상태가 설정된 후에 해당 스레드가 채널에서 I/O 작업을 시도하면 해당 채널이 즉시 닫히고 스레드는 ClosedByInterruptException 과 같은 예외가 발생한다.\n이런 경우에는 Thread.interrupted() 로 인터럽트 상태를 지울 수 있다.</p>\n<h2 id=\"Selector-키-관리\" style=\"position:relative;\">Selector 키 관리<a href=\"#Selector-%ED%82%A4-%EA%B4%80%EB%A6%AC\" aria-label=\"Selector 키 관리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Selector로 간단한 서버를 만들어보자. 클라이언트 요청을 accept 하고 클라이언트로부터 데이터를 읽을 수 있는 간단한 서버이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Example</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n\n\t\t\t<span class=\"token class-name\">ServerSocketChannel</span> serverChannel <span class=\"token operator\">=</span> <span class=\"token class-name\">ServerSocketChannel</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token class-name\">ServerSocket</span> server <span class=\"token operator\">=</span> serverChannel<span class=\"token punctuation\">.</span><span class=\"token function\">socket</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token class-name\">Selector</span> selector <span class=\"token operator\">=</span> <span class=\"token class-name\">Selector</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\tserver<span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">InetSocketAddress</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"localhost\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8080</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\tserverChannel<span class=\"token punctuation\">.</span><span class=\"token function\">configureBlocking</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\tserverChannel<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_ACCEPT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> selector<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token keyword\">continue</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\n\t\t\t\t<span class=\"token class-name\">Iterator</span> it <span class=\"token operator\">=</span> selector<span class=\"token punctuation\">.</span><span class=\"token function\">selectedKeys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>it<span class=\"token punctuation\">.</span><span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token class-name\">SelectionKey</span> key <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">)</span> it<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">isAcceptable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"클라이언트가 연결 요청하였습니다\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t<span class=\"token function\">registerChannel</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t\t\t\n\t\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">isReadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"클라이언트가 데이터를 보내왔습니다\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\n\t\t\t<span class=\"token punctuation\">}</span>\n\n\n\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\te<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">registerChannel</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">final</span> <span class=\"token class-name\">Selector</span> selector<span class=\"token punctuation\">,</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">SelectionKey</span> key<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token class-name\">ServerSocketChannel</span> serverSocket <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ServerSocketChannel</span><span class=\"token punctuation\">)</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">channel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\">SocketChannel</span> socket <span class=\"token operator\">=</span> serverSocket<span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>socket <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\tsocket<span class=\"token punctuation\">.</span><span class=\"token function\">configureBlocking</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tsocket<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span> <span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OP_READ</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\n\t<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>selector.select() 로 등록한 채널의 작업을 모니터링하고 아래 while 문 안에서 <code class=\"language-text\">key.isAcceptable()</code> 와 <code class=\"language-text\">key.isReadable()</code> 메서드를 통해,\naccept 작업과 read 작업 각각에 대해 처리를 하는 코드를 확인할 수 있다. </p>\n<p>하지만, 이 코드는 심각한 문제를 가지고 있는데 서버를 띄우고 클라이언트에서 접속을 하고 데이터를 보내면 다음과 같은 내용을 출력한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">클라이언트가 연결 요청하였습니다\n클라이언트가 연결 요청하였습니다\n클라이언트가 데이터를 보내왔습니다</code></pre></div>\n<p>클라이언트 1대만 접속했지만 <code class=\"language-text\">클라이언트가 연결 요청하였습니다</code> 메시지가 두 번 출력된다.\n이는 <strong>Selector 동작원리</strong> 섹션에 <strong>채널 준비 상태 확인</strong> 에서 설명을 보면 알 사 있다.,\nselect() 메서드는 준비된 작업 집합을 Selected key set에 추가하고, 이미 존재하는 키면 준비 완료된 작업의 비트를 업데이트할 뿐 이다.\n이는 별도로 SelectionKey를 제거하는 것 처럼 관리하지 않는다면 select() 연산의 결과는 계속 누적된다는 의미이다.\n이를 그림으로 표현하면 아래와 같다.\n<figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/595a25bfb9489232c3e91cbbe6c8cb67/35f7f/img_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.64705882352941%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaUlEQVR42qWQ627iMBCF8/4PtX+6lbZLgYWmjbhD7k5iEgLkQi7fTtJKfYBaOvL4+Nia+YwgDFFRhOd5OI5D0zT8ZBnbY8BkbvIyXeIEZ3T+wPYTTGvLbGER6Rv63pE5IZf1gXxpkaoUfWvZnXzJ7Xh5XbA9BRR1j+FGV2ZvG8zVkSgt8ZISV12Ym1vm4ofJHVc8FWREH3tic4OKb2Pu6Gl5u2a6WHFwNemtwWh76PpeBENdNR0PKWrRo+1GDd5wrrpPjbV4TdeP2e+9w9Bao9OzjJYQxxFd2/6Mob138N8s7MU7tqs4X2sZMxM+HuudTZLdyYqWPNTkdsB1c+Si89Fz/XjkaAlb24spH9Jh6Gcksw+SuYU6l9hxyc7RPE+WPP35JzyvnMQLThFq+o76u8QPLpIrWO0Dfsv519OE1WFoRhje5ddC5i+EVVG3FFVDPTD7UjXcVy2l3Jdjrh87GbyR9RfLuvms/wM1yGAR6S/VkgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SelectionKey 상태\"\n        title=\"\"\n        src=\"/static/595a25bfb9489232c3e91cbbe6c8cb67/ca1dc/img_1.png\"\n        srcset=\"/static/595a25bfb9489232c3e91cbbe6c8cb67/e7570/img_1.png 170w,\n/static/595a25bfb9489232c3e91cbbe6c8cb67/f46e7/img_1.png 340w,\n/static/595a25bfb9489232c3e91cbbe6c8cb67/ca1dc/img_1.png 680w,\n/static/595a25bfb9489232c3e91cbbe6c8cb67/35f7f/img_1.png 818w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">SelectionKey 상태</figcaption>\n  </figure></p>\n<p>Loop1 에서 클라이언트 요청이 허용 되면 SelectionKey의 OP_ACCEPT 비트를 켠다.\nLoop2 에서 클라이언트로부터 데이터를 읽을 수 있는 상태가 되면 OP_READ 비트를 켠다.\nOP_READ 비트를 켠다고 OP_ACCEPT 비트가 꺼지는 것은 아니다. 이 정보는 키 집합에서 해당 키가\n제거될 때까지 키에 유지된다.</p>\n<p>이는 등록된 채널의 현재 상태가 제대로 표시되지 않을 수 있으므로 번거러워 보일 수 있지만,\n이는 의도된 설계로 프로그래머에게 많은 유연성을 제공하지만 키를 올바르게 관리하여 키의 상태 정보가 오래되지 않도록 보장하는 책임을 부여한다.</p>\n<p>만약 프로그램이 원래 의도대로 동작하게 하기 위해서는 준비 완료된 키를 처리하고 <strong>Selected key set</strong> 에서 <code class=\"language-text\">it.remove()</code> 로 해당 키를 제거해줘야 한다.\n해당 내용을 반영한 일반적인 Selector를 이용한 채널 관리는 모습은 아래 흐름을 가진다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">selector<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">Iterator</span> it <span class=\"token operator\">=</span> selector<span class=\"token punctuation\">.</span><span class=\"token function\">selectedKeys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">iterator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>it<span class=\"token punctuation\">.</span><span class=\"token function\">hasNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">SelectionKey</span> key<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SelectionKey</span><span class=\"token punctuation\">)</span>it<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">isAcceptable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">registerChannel</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">somethingCall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">.</span><span class=\"token function\">isReadable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">registerChannel</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">somethingCall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    it<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"정리\" style=\"position:relative;\">정리<a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>Selector, SelectableChannel, SelectionKey는 Java NIO의 핵심 요소로, 고성능을 위한 Native I/O 작업을 처리하는 데 사용된다.</li>\n<li>SelectableChannel은 I/O 채널을 나타내는 추상 클래스로, SocketChannel, ServerSocketChannel 등이 이를 구현한다. Selector와 함께 사용하여 채널의 작업 상태를 모니터링하고 관리한다.</li>\n<li>SelectionKey: SelectableChannel과 Selector 간의 연결을 나타내며, 채널의 관심 작업과 현재 작업 준비 상태를 관리한다.</li>\n<li>Selector 동작 원리: Selector의 select() 메서드를 호출하면 채널 상태 확인, 작업 관심 집합 확인, 채널 준비 상태 확인 등의 단계를 수행한다</li>\n<li>채널 등록 및 관리: select()는 결과를 SelectionKey에 누적시킨다. 이는 키 관리에 책임이 프로그래머에 있다.</li>\n</ul>\n<h2 id=\"참조\" style=\"position:relative;\">참조<a href=\"#%EC%B0%B8%EC%A1%B0\" aria-label=\"참조 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>Java NIO (Ron Hitchens)</li>\n</ul>","fields":{"slug":"/java-nio-selector/","thumbnail":null},"frontmatter":{"date":"October 19, 2023","update":"Oct 19, 2023","title":"Java NIO - Selector","tags":["Java"],"thumbnail":null}}]}},"pageContext":{"series":"Java NIO"}},"staticQueryHashes":[],"slicesMap":{}}