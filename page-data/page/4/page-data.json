{"componentChunkName":"component---src-templates-post-pagination-jsx","path":"/page/4/","result":{"data":{"paging":{"group":[{"fieldValue":"데이터 중심 애플리케이션 설계","totalCount":3},{"fieldValue":"실무로 배우는 시스템 성능 최적화","totalCount":7}],"nodes":[{"excerpt":"1. 기본 방향 프로그램 단위에서 접근하는 경우 아래의 6가지 접근법만 이해하면 여러 성능 개선 항목을 도출할 수 있다. 중복 수행 제거 불필요한 수행 제거 최적 수행 필요 이상으로 많은 데이터 건수를 조회하는가? 조회한 항목은 다 사용하는 값인가? 조회하는 항목은 모두 사용자에게 보여줘야 하는가? 업므 데이터의 성격상 쿼리를 개선할 부분이 있는가? 데이…","html":"<h2 id=\"1-기본-방향\" style=\"position:relative;\">1. 기본 방향<a href=\"#1-%EA%B8%B0%EB%B3%B8-%EB%B0%A9%ED%96%A5\" aria-label=\"1 기본 방향 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>\n<p>프로그램 단위에서 접근하는 경우 아래의 6가지 접근법만 이해하면 여러 성능 개선 항목을 도출할 수 있다.</p>\n<ul>\n<li>중복 수행 제거</li>\n<li>불필요한 수행 제거</li>\n<li>최적 수행</li>\n<li>필요 이상으로 많은 데이터 건수를 조회하는가?</li>\n<li>조회한 항목은 다 사용하는 값인가?</li>\n<li>조회하는 항목은 모두 사용자에게 보여줘야 하는가?</li>\n<li>업므 데이터의 성격상 쿼리를 개선할 부분이 있는가?</li>\n<li>데이터 검색 범위는 적절한가?</li>\n<li>수행 통합</li>\n<li>주종 관계로 수행되는 쿼리를 한 개의 쿼리로 통합할 수 있는가?</li>\n<li>상관관계는 없으나 DB 호출을 줄이기 위해 쿼리를 합칠 수 있는가?</li>\n<li>집합 처리</li>\n<li>여러 건 처리 시 입력/수정/삭제를 건별로 처리하고 있는가?</li>\n<li>데이터 처리 단위는 적절한가?</li>\n<li>트랜잭션 처리</li>\n</ul>\n</li>\n</ul>\n<!-- more -->\n<h2 id=\"2-중복-SQL-수행-제거\" style=\"position:relative;\">2. 중복 SQL 수행 제거<a href=\"#2-%EC%A4%91%EB%B3%B5-SQL-%EC%88%98%ED%96%89-%EC%A0%9C%EA%B1%B0\" aria-label=\"2 중복 SQL 수행 제거 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>CBC(Component Based Developmnet) 기반 개발이 보편화되어 재활용성과 유지보성은 좋아졌지만 기초 정보가 동일한 조건으로 반복적으로 호출되는 경우가 빈번하게 발생한다.</li>\n<li>\n<p><strong>빈번한 유효성 검증</strong></p>\n<ul>\n<li>컴포넌트 단위로 안정성과 정합성이 유지될 수 있도록 모듈 단위로 입력 값에 검증을 추가로 수행하는 것이 일반화되어 검증이 반복적으로 수행된다.</li>\n</ul>\n</li>\n<li>\n<p>동일 SQL/모듈의 반복 호출</p>\n<ul>\n<li>상부와 하부 컴포너트 간 호출 빈도나 쓰임새를 고려하지 않고 모든 컴포넌트가 동일한 방식으로 개발되어 SQL/모듈이 한 프로그램 내에서 많게는 수십에서 수천 까지 반복 호출되는 문제를 유발한다.</li>\n</ul>\n</li>\n<li>\n<p>불필요한 기능 수행</p>\n<ul>\n<li>모듈이 범용화되는 과정을 거치게 되는데, 이로 인해 한 모듈이 여러 서비스에서 필요로 하는 다양한 정보를 제공하려는 경향이 있다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"21-애플리케이션-캐시의-종류\" style=\"position:relative;\">2.1 애플리케이션 캐시의 종류<a href=\"#21-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%BA%90%EC%8B%9C%EC%9D%98-%EC%A2%85%EB%A5%98\" aria-label=\"21 애플리케이션 캐시의 종류 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>2.1.1 블록 캐시</h4>\n<ul>\n<li>블록 캐시는 애플리케이션의 특정 블록(함수) 내에서 SQL 중복 수행을 제거하나 처리 결과 중간 값을 저장하는 등의 목적으로 사용하는 캐시다.</li>\n<li>데이터 저장소가 함수 내 로컬 변수로 선언되어 해당 블록 내에서만 유효하다는 특징이 있다.</li>\n<li>특정 함수 내에서 for/while 문으로 여러 개의 데이터를 처리할 때 유용하다.</li>\n<li>저바의 경우 데이터 저장소로 HashMap을 많이 사용한다.</li>\n<li>필요할 때마다 건별로 조회하지 않고 필요 데이터를 한 번에 캐시를 만든 후 while이나 for 문 안에서 참조할 때 캐시에서 찾음으로써 DB 호출을 제거한다.</li>\n</ul>\n<h4>2.1.2 요청 캐시</h4>\n<ul>\n<li>요청 캐시는 사용자 요청 서비스가 시작되어 종료될 때까지 유지되는 캐시다.</li>\n<li>서비스 요청이 들어와 애플리케이션이 시작될 때 캐시가 초기화되어 비어 있고 애플리케이션이 종료될 때 캐시가 지워져 사라지는 구조로 사용자 서비스 간에는 데이터가 공유되지 않는다.</li>\n<li>자바의 경우 캐시가 ThreadLocal이나 서비스 컨텍스트에 위치하게 한다.</li>\n<li>서비스 시작과 종료 시 캐시가 프레임워크에서 자동으로 초기화 및 삭제된다.</li>\n<li>고객관리 시스템에서는 고객 기본정보 조회가 한 서비스 내에서 반복 호출되는 경우가 있는데 기존에 조회된 데이터가 없으면 DB를 조회해 캐시한 후 내보내고, 이미 조회된 데이터가 있으면 캐시된 데이터를 내보낸다.</li>\n</ul>\n<h4>2.1.3 사용자 세션 캐시</h4>\n<ul>\n<li>시스템에 접속한 사용자 세션 단위로 캐시를 가지는 구조로서, 접속한 사용자에 대한 기초 데이터를 보관해서 DB 조회를 최소화하는 방식이다</li>\n</ul>\n<h4>2.1.4 프로세스 캐시</h4>\n<ul>\n<li>WAS 인터턴스 단위 내에서 공유되는 식으로 프로세스 내에서 처리되는 모든 서비스 요청이 캐시를 공유해서 사용한다.</li>\n<li>프로세스 단위로 공유되므로 자바의 싱글턴 구조로 구현된다.</li>\n<li>빈번하게 사용되는 코드성 테이블에 대한 DB 조회를 최소화하기 위해 많이 사용된다.</li>\n</ul>\n<h4>2.1.5 프로세스간 공유 캐시</h4>\n<ul>\n<li>프로세스 단위로 캐시를 구성하는 경우 시스템 전체로 봤을 때 동일한 데이터가 여러 개의 프로세스에 캐시되어 메모리 중복 손실이 발생하고, 힙을 대량으로 사용하면 GC에 악영향을 미치게 된다.</li>\n<li>자바 메모리의 한계를 극보하기 위해 메모리 캐시 전용 솔류션이 사용되고 있는데 대표적으로 Redis가 있다.</li>\n</ul>\n<h4>2.1.6 캐시 특성 분류</h4>\n<h3 id=\"22-요청-캐시-구현\" style=\"position:relative;\">2.2 요청 캐시 구현<a href=\"#22-%EC%9A%94%EC%B2%AD-%EC%BA%90%EC%8B%9C-%EA%B5%AC%ED%98%84\" aria-label=\"22 요청 캐시 구현 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"23-캐시-적용\" style=\"position:relative;\">2.3 캐시 적용<a href=\"#23-%EC%BA%90%EC%8B%9C-%EC%A0%81%EC%9A%A9\" aria-label=\"23 캐시 적용 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h2 id=\"3-불필요한-SQL-수행-제거\" style=\"position:relative;\">3. 불필요한 SQL 수행 제거<a href=\"#3-%EB%B6%88%ED%95%84%EC%9A%94%ED%95%9C-SQL-%EC%88%98%ED%96%89-%EC%A0%9C%EA%B1%B0\" aria-label=\"3 불필요한 SQL 수행 제거 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>\n<p>공통 모듈을 사용하거나 서로 다른 개발자가 개발한 모듈을 사용한 애플리케이션의 경우 로직과 수행 SQL은 최적화가 안되는 경우가 많다.</p>\n<ul>\n<li>특정 컬럼만 조회하면 되지만 공통 모듈의 무거운 쿼리를 사용해서 조회하는 경우</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"4-최적-수행\" style=\"position:relative;\">4. 최적 수행<a href=\"#4-%EC%B5%9C%EC%A0%81-%EC%88%98%ED%96%89\" aria-label=\"4 최적 수행 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"41-Rownum-추가\" style=\"position:relative;\">4.1 Rownum 추가<a href=\"#41-Rownum-%EC%B6%94%EA%B0%80\" aria-label=\"41 Rownum 추가 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>DB에는 한 번에 보내는 레코드 건수를 설정할 수 있는데 이를 Fetch 크기라고 한다.</li>\n<li>Fetch size가 크면 DB와 애플리케이션 간의 턴을 줄일 수 있지만, 필요한 데이터보다 더 많은 데이터를 가져올 수 있다.</li>\n</ul>\n<h3 id=\"42-파티션-키-추가\" style=\"position:relative;\">4.2 파티션 키 추가<a href=\"#42-%ED%8C%8C%ED%8B%B0%EC%85%98-%ED%82%A4-%EC%B6%94%EA%B0%80\" aria-label=\"42 파티션 키 추가 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>파티션 테이블은 배치 메인 쿼리의 경우 전체 테이블 탐색 범위를 줄이기 위해 사용하고 입력에서는 부하분산 등 성능 목적으로 사용하며, 대량 데이터를 관리하는 목적으로 주로 사용한다.</li>\n<li>파티션 테이블이 글로벌 인덱스를 사용하는 경우 주기적으로 보관연한이 지난 파티션을 제거하게 되면 글로벌 인데그삭 사용불가 상태로 바뀐다.</li>\n<li>이 같은 상황을 방지하기 위해 파티션 테이블을 사용할 때는 가급적 로컬 인덱스를 사용하는 것을 기본으로 하고, 단지 로컬 인덱스로 성능 목표를 달성하지 못하는 경우에만 글로벌 인덱스를 사용하는 것을 고려한다.</li>\n<li>파티션 키가 Where 조건에 없다면 모든 파티션 테이블을 순차적으로 조회하는 것과 동일한 성능 저하가 발생할 수 있으므로 어떤 식으로든 파티션 키가 Where 조건에 포함될 수 있게 한다.</li>\n</ul>\n<h3 id=\"43-조회-항목-사용-여부테이블-조인-제거\" style=\"position:relative;\">4.3 조회 항목 사용 여부(테이블 조인 제거)<a href=\"#43-%EC%A1%B0%ED%9A%8C-%ED%95%AD%EB%AA%A9-%EC%82%AC%EC%9A%A9-%EC%97%AC%EB%B6%80%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%A1%B0%EC%9D%B8-%EC%A0%9C%EA%B1%B0\" aria-label=\"43 조회 항목 사용 여부테이블 조인 제거 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>공통으로 사용하는 쿼리는 최대한 많은 컬럼을 조회해서 제공하려 한다.</li>\n<li>조회하는 컬럼을 줄이는 것도 의미가 있지만 테이블의 조인을 제거하것도 효과적이다.</li>\n</ul>\n<h2 id=\"5-쿼리-통합\" style=\"position:relative;\">5. 쿼리 통합<a href=\"#5-%EC%BF%BC%EB%A6%AC-%ED%86%B5%ED%95%A9\" aria-label=\"5 쿼리 통합 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>쿼리 통합은 Select에 대한 집합 처리를 의미한다.</li>\n<li>여러 번 수행하는 쿼리를 한 번에 수행해 성능을 개선하는 것이다.</li>\n</ul>\n<h3 id=\"51-메인서브-쿼리\" style=\"position:relative;\">5.1 메인/서브 쿼리<a href=\"#51-%EB%A9%94%EC%9D%B8%EC%84%9C%EB%B8%8C-%EC%BF%BC%EB%A6%AC\" aria-label=\"51 메인서브 쿼리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"52-병렬-쿼리-통합\" style=\"position:relative;\">5.2 병렬 쿼리 통합<a href=\"#52-%EB%B3%91%EB%A0%AC-%EC%BF%BC%EB%A6%AC-%ED%86%B5%ED%95%A9\" aria-label=\"52 병렬 쿼리 통합 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>고객 통합정보 조회 하면을 떠올려 보자.</p>\n<ul>\n<li>기본정보, 결제이력, 카드 보유 개수, 마케팅 대상 등등..</li>\n<li>20~30개의 쿼리가 순차적으로 수행되는 구조가 된다.</li>\n</ul>\n</li>\n<li>이런 경우에는 Union all이나 일대일 조인 형태로 하나의 쿼리로 통합하면 DB 호출 횟수가 줄어들어 성능 개선이 가능하다.</li>\n</ul>\n<h2 id=\"6-DB-집합-처리\" style=\"position:relative;\">6. DB 집합 처리<a href=\"#6-DB-%EC%A7%91%ED%95%A9-%EC%B2%98%EB%A6%AC\" aria-label=\"6 DB 집합 처리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>10건의 데이터를 개별적으로 입력한다면 애플리케이션 서버와 DB 서버 간 애플리케이션 턴도 10회 생기고 SQL 실행과 결과도 10회 발생한다.</li>\n<li>\n<p>집합 처리는 애플리케이션 턴 1회에 10건의 데이터를 모두 전송함으로서 성능 개선 효과가 있다.</p>\n<ul>\n<li>단건 처리 (<code class=\"language-text\">PreparedStatement.excuteUpdate()</code>)</li>\n<li>집합 처리 (<code class=\"language-text\">PreparedStatement.addBatch()</code>,<code class=\"language-text\">PreparedStatement.executeBatch()</code>)</li>\n</ul>\n</li>\n<li>집합 처리를 수행할 때 수십만 건씩 처리하면 자바 힙 메모리가 부족해지는 현상이 발생해지므로 최대 만 건 이내로, 일반적으로는 천 건 단위로 수행한다.</li>\n</ul>\n<h2 id=\"7-트랜잭션-처리\" style=\"position:relative;\">7. 트랜잭션 처리<a href=\"#7-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EC%B2%98%EB%A6%AC\" aria-label=\"7 트랜잭션 처리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>동일한 레코드를 Update 하는 서비스가 있다고 할 때, Update 문의 위치가 응답시간에 영향을 미친다.</li>\n<li>락을 흭득하는 위치가 트랜잭션 중간이면 다른 트랜잭션이 락을 대기하는 시간이 늘어나기 때문에 트랜잭션의 마지막에 위치하는게 좋다.</li>\n</ul>\n<h2 id=\"8-기타\" style=\"position:relative;\">8. 기타<a href=\"#8-%EA%B8%B0%ED%83%80\" aria-label=\"8 기타 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"81-복합적인-기능을-수행하는-쿼리-제거\" style=\"position:relative;\">8.1 복합적인 기능을 수행하는 쿼리 제거<a href=\"#81-%EB%B3%B5%ED%95%A9%EC%A0%81%EC%9D%B8-%EA%B8%B0%EB%8A%A5%EC%9D%84-%EC%88%98%ED%96%89%ED%95%98%EB%8A%94-%EC%BF%BC%EB%A6%AC-%EC%A0%9C%EA%B1%B0\" aria-label=\"81 복합적인 기능을 수행하는 쿼리 제거 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>복합 기능 쿼리란 하나의 쿼리에 1개 이상의 기능이 담긴 쿼리를 말한다.</li>\n<li>복합 기능 쿼리에서 성능 저하가 발생하는 이유는 DB에서 쿼리가 바인드 변수 값에 따라 실행될 때마다 실행계획을 수립하는 것이 아니라 최초 실행 시 실행계획을 수립하고 이후에는 기존 실행계획을 재사용하기 때문이다.</li>\n<li>쿼리 한 개는 한 개의 실행계획만 가지고 있어 다양한 입력 조건에 맞게 실행계획을 수립할 수 없다.</li>\n<li>Union all 을 이용해서 쿼리를 분리하면 하나의 실행계획으로 안정적인 성능을 기대할 수 있다.</li>\n</ul>\n<h3 id=\"82-스칼라-서브-쿼리-사용-시-주의사항\" style=\"position:relative;\">8.2 스칼라 서브 쿼리 사용 시 주의사항<a href=\"#82-%EC%8A%A4%EC%B9%BC%EB%9D%BC-%EC%84%9C%EB%B8%8C-%EC%BF%BC%EB%A6%AC-%EC%82%AC%EC%9A%A9-%EC%8B%9C-%EC%A3%BC%EC%9D%98%EC%82%AC%ED%95%AD\" aria-label=\"82 스칼라 서브 쿼리 사용 시 주의사항 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>Select 절에 사용된 쿼리를 스칼라 서브 쿼리라고 한다.</li>\n<li>스칼라 서브 쿼리를 사용하는 것은 많은 경우에 있어서 나쁜 성능을 보이기 때문에 Where 조건이 분산도가 좋은 인덱스를 사용하고 전체 쿼리 결과가 소량인 경우에만 사용한다.</li>\n</ul>\n<h3 id=\"83-페이징-처리\" style=\"position:relative;\">8.3 페이징 처리<a href=\"#83-%ED%8E%98%EC%9D%B4%EC%A7%95-%EC%B2%98%EB%A6%AC\" aria-label=\"83 페이징 처리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>페이징 처리 시, 다음과 같은 이유로 테이블을 전체 범위 처리함하면 성능 저하게 발생한다.</p>\n<ul>\n<li>전체 건수/페이지 수의 표시 문제</li>\n<li>무의미한 전체 건수 표시 제거</li>\n<li>변경이 적은 목록은 전체 건수 및 페이지 수를 초기에만 생성 후 재사용</li>\n<li>Order By 이용한 목록 정렬 문제</li>\n<li>Order By 순서와 일치하는 페이징 인덱스를 생성해서 사용</li>\n<li>페이징 인덱스 컬럼 값을 페이지 이동 시 다음 키값으로 사용</li>\n<li>분산도가 좋은 필수 입력항목 부재</li>\n<li>분산도가 좋은 입력항목을 지정하고, 기본값 설정</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"9-배치-성능-개선\" style=\"position:relative;\">9. 배치 성능 개선<a href=\"#9-%EB%B0%B0%EC%B9%98-%EC%84%B1%EB%8A%A5-%EA%B0%9C%EC%84%A0\" aria-label=\"9 배치 성능 개선 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>배치는 DB에서 처리 대상을 추출하는 메인리더 부분과 프로세싱하는 부분, 처리 결과를 DB에 기록하는 부분으로 나뉜다.</li>\n</ul>\n<h3 id=\"91-전체-테이블-탐색\" style=\"position:relative;\">9.1 전체 테이블 탐색<a href=\"#91-%EC%A0%84%EC%B2%B4-%ED%85%8C%EC%9D%B4%EB%B8%94-%ED%83%90%EC%83%89\" aria-label=\"91 전체 테이블 탐색 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>메인리더가 수만 건 내외의 소량건을 조회해서 처리한다면 테이블 인덱스를 사용하는 것이 효과적이지만 수만 건 이상 조회해야 한다면 테이블 전체를 읽어서 조회하는 편이 성능이 좋은 경우가 많다.</li>\n<li>\n<p>인덱스를 사용하면 읽는 블록수가 상대적으로 적어지지만 응답시간이 늦어진다.</p>\n<ul>\n<li>그 이유는 인덱스 탐색은 인덱스를 읽어 조건에 맞는 레코드를 한 건 한건을 순차적으로 읽는 랜덤엑세스가 이뤄지는 반면 전체 테이블 탐색은 멀티블록 읽기 설정에 따라 여러 블록을 한번에 읽어 들일 수 있다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"92-파티션\" style=\"position:relative;\">9.2 파티션<a href=\"#92-%ED%8C%8C%ED%8B%B0%EC%85%98\" aria-label=\"92 파티션 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>대량 건을 조회할 때 전체 테이블 탐색이 성능이 우수하다고 하지만 사이즈가 커질 수록 부담스러운 작업이다.</li>\n<li>이 같은 상황에서 해결책으로 고려해볼 수 있는것이 파티션이다.</li>\n<li>Where 조건에 파티션의 범위를 지정한다면 전체 탐색을 하더라도 지정된 파티션 범위 내에서만 전체 탐색이 발생한다.</li>\n</ul>\n<h3 id=\"93-해시-조인\" style=\"position:relative;\">9.3 해시 조인<a href=\"#93-%ED%95%B4%EC%8B%9C-%EC%A1%B0%EC%9D%B8\" aria-label=\"93 해시 조인 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>테이블 조인에서 조회하는 건수가 소량이고 모든 테이블에 적절한 인덱스가 존재한다면 내포 조인이 가장 효과적이다.</li>\n<li>대량 건을 조회한다면 내포 조인대신 해시 조인을 사용하는 것이 성능상 유리하다.</li>\n</ul>\n<h3 id=\"95-쿼리-통합\" style=\"position:relative;\">9.5 쿼리 통합<a href=\"#95-%EC%BF%BC%EB%A6%AC-%ED%86%B5%ED%95%A9\" aria-label=\"95 쿼리 통합 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>9.5.1 메인리더와 건별 처리 쿼리 통합</h4>\n<ul>\n<li>메인리더에서 읽은 데이터를 기반으로 건별 처리 로직에서 부가 정보를 획득하거나 확인을 위해 추가 쿼리를 수행하는 경우가 많은데 메인리더와 통합하면 성능 개선효과가 있다.</li>\n</ul>\n<h4>9.5.2 메인리더와 Insert 통합</h4>\n<ul>\n<li>건별로 조회하해 데이터를 처리하는 것이 가장 느리다.</li>\n<li>1000건씩 Fetch 하여 집합 처리(batch)를 활용한다면 더 빠를 것 이다.</li>\n<li>마지막으로 시도해볼 수 있는 방법은 <code class=\"language-text\">Insert ... Select</code> 구문을 사용하는 것이다.</li>\n<li>사실상 애플리케이션으로 처리 데이터가 오지 않고 전부 DB 내부에서 처리하는 것 이다.</li>\n</ul>\n<h4>9.5.3 Select / Insert / Update 통합</h4>\n<ul>\n<li>오라클에서는 <code class=\"language-text\">Merge</code>를 통해 Select Insert Update 쿼리를 통합할 수 있다.</li>\n<li>Mysql에서는 <code class=\"language-text\">ON DUPLICATE KEY</code> 로 통합할 수 있다.</li>\n</ul>","fields":{"slug":"/ch7/","thumbnail":null},"frontmatter":{"date":"March 16, 2022","update":"Mar 16, 2022","title":"7부 - 애플리케이션 입장에서의 SQL 튜닝","description":null,"tags":["실무로 배우는 시스템 성능 최적화"],"thumbnail":null}},{"excerpt":"1. 기본 방향 SQL 튜닝 시 중점적으로 점검할 항목 통계 최적 실행계획이 수립되도록 테이블 통계 정보가 존재하고 주기적으로 갱신되는가? 인덱스 적절한 인덱스를 사용하는가? 인덱스가 있음에도 사용하지 못하는가? 인덱스 수가 많아서 INSERT 처리 시간이 오래걸리는가? 조인 처리하는 데이터 양과 연결 관계에 맞는 조인 방식이 선정됐는가? 조인 관계에서 …","html":"<h2 id=\"1-기본-방향\" style=\"position:relative;\">1. 기본 방향<a href=\"#1-%EA%B8%B0%EB%B3%B8-%EB%B0%A9%ED%96%A5\" aria-label=\"1 기본 방향 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>\n<p>SQL 튜닝 시 중점적으로 점검할 항목</p>\n<ul>\n<li>통계</li>\n<li>최적 실행계획이 수립되도록 테이블 통계 정보가 존재하고 주기적으로 갱신되는가?</li>\n<li>인덱스</li>\n<li>적절한 인덱스를 사용하는가?</li>\n<li>인덱스가 있음에도 사용하지 못하는가?</li>\n<li>인덱스 수가 많아서 INSERT 처리 시간이 오래걸리는가?</li>\n<li>조인</li>\n<li>처리하는 데이터 양과 연결 관계에 맞는 조인 방식이 선정됐는가?</li>\n<li>조인 관계에서 선행 테이블은 적합한가?</li>\n<li>테이블</li>\n<li>데이터 수정과 삭제로 테이블 조각화가 발생해 재구성할 필요는 있는가?</li>\n<li>파티션으로 INSERT 부하를 분산해 성능 개선이 가능한가?</li>\n</ul>\n</li>\n</ul>\n<!-- more -->\n<h2 id=\"2-SQL-을-위한-기본-지식\" style=\"position:relative;\">2. SQL 을 위한 기본 지식<a href=\"#2-SQL-%EC%9D%84-%EC%9C%84%ED%95%9C-%EA%B8%B0%EB%B3%B8-%EC%A7%80%EC%8B%9D\" aria-label=\"2 SQL 을 위한 기본 지식 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"21-데이터베이스의-기본-구조\" style=\"position:relative;\">2.1 데이터베이스의 기본 구조<a href=\"#21-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B5%AC%EC%A1%B0\" aria-label=\"21 데이터베이스의 기본 구조 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p><strong>클라이언트</strong></p>\n<ul>\n<li>클라이언트는 DB 솔루션에서 제공하는 클라이언트 모듈을 통해 데이터베이스에 저장된 데이터를 조회하거나 수정할 수 있는 기능을 제공한다.</li>\n<li>클라이언트 측면에서 중요 개선 사항</li>\n<li>복구 건의 레코드를 한번의 호출로 집합 처리하거나 두 개 이상의 쿼리를 통합 처리함으로써 DB 호출 수를 줄인다.</li>\n<li>JDBC Statement를 캐시하거나 SQL 커서를 오픈한 상태로 유지함으로써 쿼리 소프트 파싱을 회피해 성능을 개선할 수 있다.</li>\n<li>패치 크기(Fetch Size)를 증가시켜 DB 엔진에서 클라이언트로 조회된 데이터를 전송 할 때 한번에 많은 데이터를 전송함으로써 성능을 개선할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p><strong>데이터베이스 엔진</strong></p>\n<ul>\n<li>엔진은 클라이언트 요청을 받아 파일시스템에 저장된 데이터를 조회하거나 수정하는 기능을 수행한다.</li>\n<li>엔진 내부에는 락 관리와 트랜잭션 관리가 이뤄진다.</li>\n<li>데이터베이스 엔진은 처리 성능 개선을 위해 동작에 필요한 기초 정보와 파일시스템에 저장된 데이터 중 일부를 메모리에 캐시하고 있어 큰 메모리를 필요로 한다.</li>\n</ul>\n</li>\n<li>\n<p><strong>데이터베이스 엔진 메모리의 주요 용도</strong></p>\n<ul>\n<li>데이터 캐시</li>\n<li>파일시스템에 저장된 데이터가 조회되면 해당 데이터를 메모리 데이터 캐시에 저장해 이후 동일 데이터 조회 시 파일 시스템의 물리적인 입출력이 발생하지 않게 한다.</li>\n<li>실행계획</li>\n<li>SQL이 처음 호출되면 대상 데이터를 찾는 방법이 기술돼 있는 실행계획을 만들고 이후 동일한 SQL이 수행되면 기존에 만들어진 실행계획을 재사용한다.</li>\n<li>DB 정보</li>\n<li>테이블 구성 정보(메타 정보)와 통계를 저장하고 있으면서 SQL을 검증하고 실행계획을 수립할 때 참조한다.</li>\n<li>복구 로그</li>\n<li>복구 로그는 데이터 변경 전후 내역을 모두 저장해 데이터베이스에 장애가 발생했을 때 데이터를 복구하는 용도로 사용한다.</li>\n</ul>\n</li>\n<li>\n<p><strong>데이터베이스 서버 성능 개선을 위해서는 아래 사항에 유의해야 한다.</strong></p>\n<ul>\n<li>데이터 캐시는 클수록 성능 개선 효과가 있지만 개선 효과가 메모리 크기에 비례해서 증가하지는 않는다. 어느 수준이상 증가하면 개선 효과가 감소되는 커브 곡선을 그리므로 캐시 적중률을 참고해서 적당한 크기를 찾아야 한다.</li>\n<li>바인드 변수를 사용하지 않으면 SQL의 조회 조건 값이 달리질 때마다 엔진은 서로 다른 SQL로 인식해 새로운 실행계획을 세우는 하드 파싱이 발생한다.</li>\n<li>테이블과 인덱스 전체 블록 개수, 데이터 건수, 항목별 선택도, 인덱스 현황 등 통계 정보를 기반으로 실행계획을 수립하는데 통계 정보가 없거나 오래되어 실제 데이터 분포와 다른 경우 잘못된 실행계획이 수립되어 성능 저하를 유발할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p><strong>파일 시스템(저장)</strong></p>\n<ul>\n<li>데이터 조회 시 물리적 IO가 발생하므로 데이터베이스 구조에서 가장 느린 부분이다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"22-블록-단위-처리\" style=\"position:relative;\">2.2 블록 단위 처리<a href=\"#22-%EB%B8%94%EB%A1%9D-%EB%8B%A8%EC%9C%84-%EC%B2%98%EB%A6%AC\" aria-label=\"22 블록 단위 처리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>데이터베이스의 저장 구조는 데이터베이스, 테이블스페이스, 세그먼트, 익스텐트, 블록순으로 계층 관계를 이루고 있다.</li>\n<li>불록은 데이터 IO의 가장 작은 단위이며, 할당할 수 있는 최소 단위이기도 하다.</li>\n<li>SELECT를 실행했을 때 읽은 블록이 많다는 것은 레코드를 찾는 과정이 불합리하다는 것을 의미한다.</li>\n<li>SQL 튜닝을 간단하게 정의하면 읽는 블록 수를 줄여주는 것이다.</li>\n</ul>\n<h3 id=\"23-캐시-IO-대-물리-IO\" style=\"position:relative;\">2.3 캐시 IO 대 물리 IO<a href=\"#23-%EC%BA%90%EC%8B%9C-IO-%EB%8C%80-%EB%AC%BC%EB%A6%AC-IO\" aria-label=\"23 캐시 IO 대 물리 IO permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>데이터베이스 구조에서 성능에 가장 영향을 주는 부분은 파일시스템에서 발생하는 물리IO다.</li>\n<li>\n<p>물리 IO가 주로 발생하는 쿼리인데 캐시로 인해 빠르게 조회되어 대상에서 제외될 수도 있다.</p>\n<ul>\n<li>읽은 블록 수가 많다면 줄일 수 있는 방안을 강구하는 것이 먼저다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-성능-개선-대상-식별\" style=\"position:relative;\">3. 성능 개선 대상 식별<a href=\"#3-%EC%84%B1%EB%8A%A5-%EA%B0%9C%EC%84%A0-%EB%8C%80%EC%83%81-%EC%8B%9D%EB%B3%84\" aria-label=\"3 성능 개선 대상 식별 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"31-SQL-수행-통계\" style=\"position:relative;\">3.1 SQL 수행 통계<a href=\"#31-SQL-%EC%88%98%ED%96%89-%ED%86%B5%EA%B3%84\" aria-label=\"31 SQL 수행 통계 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"32-실행-중인-세션-상태\" style=\"position:relative;\">3.2 실행 중인 세션 상태<a href=\"#32-%EC%8B%A4%ED%96%89-%EC%A4%91%EC%9D%B8-%EC%84%B8%EC%85%98-%EC%83%81%ED%83%9C\" aria-label=\"32 실행 중인 세션 상태 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"33-수행-중인-SQL의-수행-상태-확인\" style=\"position:relative;\">3.3 수행 중인 SQL의 수행 상태 확인<a href=\"#33-%EC%88%98%ED%96%89-%EC%A4%91%EC%9D%B8-SQL%EC%9D%98-%EC%88%98%ED%96%89-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8\" aria-label=\"33 수행 중인 SQL의 수행 상태 확인 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"34-락-대기\" style=\"position:relative;\">3.4 락 대기<a href=\"#34-%EB%9D%BD-%EB%8C%80%EA%B8%B0\" aria-label=\"34 락 대기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"35-AWR-보고서\" style=\"position:relative;\">3.5 AWR 보고서<a href=\"#35-AWR-%EB%B3%B4%EA%B3%A0%EC%84%9C\" aria-label=\"35 AWR 보고서 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"36-StatsPack\" style=\"position:relative;\">3.6 StatsPack<a href=\"#36-StatsPack\" aria-label=\"36 StatsPack permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h2 id=\"4-SQL-실행계획\" style=\"position:relative;\">4. SQL 실행계획<a href=\"#4-SQL-%EC%8B%A4%ED%96%89%EA%B3%84%ED%9A%8D\" aria-label=\"4 SQL 실행계획 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"41-SQL-실행계확과-수행-결과\" style=\"position:relative;\">4.1 SQL 실행계확과 수행 결과<a href=\"#41-SQL-%EC%8B%A4%ED%96%89%EA%B3%84%ED%99%95%EA%B3%BC-%EC%88%98%ED%96%89-%EA%B2%B0%EA%B3%BC\" aria-label=\"41 SQL 실행계확과 수행 결과 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>4.1.1 SQL 실행계획 보기</h4>\n<h4>4.1.2 SQL 수행 결과 확인</h4>\n<h3 id=\"42-실행계획의-이해\" style=\"position:relative;\">4.2 실행계획의 이해<a href=\"#42-%EC%8B%A4%ED%96%89%EA%B3%84%ED%9A%8D%EC%9D%98-%EC%9D%B4%ED%95%B4\" aria-label=\"42 실행계획의 이해 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>실행계획이란 옵티마이저가 특정 SQL을 실행하기 위해 수행할 일련의 동작을 트리형식으로 표현한 계획이다.</li>\n</ul>\n<h4>4.2.1 조인</h4>\n<ul>\n<li>기본 조인 방식으로는 내포 조인, 해시 조인, 병합 조인, 스타 조인이라는 방식이 있다.</li>\n<li>\n<p><strong>내포 조인(Neated loops join)</strong></p>\n<ul>\n<li>선행 테이블과 후행 테이블을 오가며 반복적으로 탐색해서 원하는 레코드를 찾는다.</li>\n<li>선행 테이블에서 탐색된 레코드 건수만큼 후행 테이블의 랜덤 엑세스 탐색이 일어난다.</li>\n<li>즉, 선행 테이블의 조회 건수가 조인의 전체 작업량을 좌우한다.</li>\n<li>선행 테이블과 연결고리가 되는 후행 테이블의 조인 항목은 꼭 인덱스가 있어야 한다.</li>\n<li>연골고리에 인덱스가 없는데 내포 조인이 사용되면 후행 테이블에 전체 범위 탐색(Full Scan)이 발생한다.</li>\n</ul>\n</li>\n<li>\n<p><strong>병합 조인(Merge join)</strong></p>\n<ul>\n<li>조인되는 두 테이블의 연결고리가 되는 항목에 대한 인덱스가 없거나 대량 데이터를 처리하는 경우 내포 조인에서 발생하는 후행 테이블의 랜덤 엑세스를 제거하기 위해 사용하는 조인 방식이다.</li>\n<li>조인되는 두 테이블은 조인에 앞서 대상 데이터를 줄이기 위해 각 테이블에 대한 WHERE 조건으로 레코드를 먼저 모두 조회한 후에 연결고리가 되는 항목을 기준으로 정렬한다.</li>\n<li>양쪽에 정렬된 레코드를 순차적으로 비교해 가면서 연결고리가 일치하는 레코드를 찾는다.</li>\n<li>선후행 테이블 어느 것이 되든 상관없다.</li>\n<li>정렬된 데이터를 조인하는 작업은 효과적이지만 정렬을 해야하는 부담이 있다.</li>\n</ul>\n</li>\n<li>\n<p><strong>해시 조인(Hash join)</strong></p>\n<ul>\n<li>선행 테이블에서 조인에 앞어 전체 범위 탐색으로 조인 대상 레코드를 모두 조회해서 연결고리인 항목에 대해 해시 맵을 만든다.</li>\n<li>그리고 후행 테이블은 내부 탐색 조건에 일치하는 레코드를 찾았을 때마다 해시 연산을 통해 해시 맵에 일치하는 레코드가 있는지 비교해서 조인을 수행한다.</li>\n<li>선행 테이블은 한 번에 전체 범위 탐색으로 데이터를 추출하고 후행 테이블은 순차적으로 부분 범위 탐색하므로 부분 범위 처리가 이뤄진다.</li>\n<li>-</li>\n</ul>\n</li>\n</ul>\n<h4>4..2 SQL 실행계획의 동작</h4>\n<h3 id=\"43-인덱스\" style=\"position:relative;\">4.3 인덱스<a href=\"#43-%EC%9D%B8%EB%8D%B1%EC%8A%A4\" aria-label=\"43 인덱스 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>4.3.1 인덱스 구조</h4>\n<ul>\n<li>인덱스는 루트, 브랜치, 리프 블록으로 구성된다.</li>\n</ul>\n<h4>4.3.2 인덱스 종류</h4>\n<h4>4.3.3 인덱스 사용 원칙</h4>\n<ul>\n<li>\n<p><strong>인덱스 생성 원칙</strong></p>\n<ul>\n<li>1순위는 테이블의 기본 키다. 기본 키는 가장 빈도가 높은 테이블 엑세스 경로다.</li>\n<li>2순위는 테이블 간 연결고리로 사용되는 조인 항목 그룹이다. 온라인 SQL은 대부분 내포 조인을 사용하는데 후행 테이블의 연골고리에 인덱스가 없으면 성능에 치명적이다.</li>\n<li>3순위는 테이블 액세스 경로 상에 빈번하게 관찰되는 항목의 그룹이다. 항목 그룹은 해당 테이블을 조회하는 모든 SQL의 조회 조건에 사용된 항목들의 모임을 나열해서 그룹핑했을 때 가장 빈번하게 나타나느 항목 모임이다.</li>\n<li>인덱스를 만들 때는 선행 항목이 중요하다. 조회 조건에 선행 항목이 없으면 인덱스를 사용하지 못한다.</li>\n<li>BETWWEN, &#x3C; > 등 범위를 지정하는 조건이 주로 주어지는 항목은 결합 인덱스에서 일치(=) 조건 항목 이후에 위치하도록 구성해야 인덱스 탐색 범위를 줄일 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>조회 조건에 쓰인 항목에 인덱스가 있는데도 아래와 같은 경우는 인덱스를 사용하지 못한다.</p>\n<ul>\n<li>항목 변형 (<code class=\"language-text\">SUBSTR</code>, <code class=\"language-text\">VALUE * 10</code>)</li>\n<li>NULL 사용 (<code class=\"language-text\">VALUE IS NULL</code>)</li>\n<li>부정 표현 (<code class=\"language-text\">VALUE ≠ null</code>)</li>\n<li>앞 % 사용 (<code class=\"language-text\">VALUE LIKE = ‘%ABC’</code>)</li>\n<li>내부 형변환 (<code class=\"language-text\">NUMBER_VALUE = ‘1000’</code>)</li>\n</ul>\n</li>\n</ul>\n<h4>4.3.4 인덱스 탐색 방식</h4>\n<ul>\n<li>\n<p><strong>인덱스 유일 탐색(Index Unique Scan)</strong></p>\n<ul>\n<li>인덱스를 구성하는 모든 항목이 WHERE 절에 일치(=) 조건으로 들어왔을 때 레코드 한건을 찾아가는 탐색으로 가장 빠르다.</li>\n</ul>\n</li>\n<li>\n<p><strong>인덱스 범위 탐색(Index Range Scan)</strong></p>\n<ul>\n<li>인덱스의 일정한 범위를 읽어내는 인덱스 범위 탐색이다.</li>\n<li>한 개의 항목으로 구성된 일반 단일 인덱스가 있을 때 해당 항목이 WHERE 절에 일치 조건으로 있더라도 인덱스 탐색 방식은 범위 탐색을 수행한다. (유니크 인덱스가 아니기 때문에 동일한 레코드가 있을 수 있다)</li>\n</ul>\n</li>\n<li>\n<p><strong>인덱스 전체 탐색(Index Full Scan)</strong></p>\n<ul>\n<li>테이블 전체 탐색과 마찬가지로 인덱스를 순차적으로 처음부터 끝까지 읽어들이는 탐색 방식이다.</li>\n</ul>\n</li>\n<li>\n<p><strong>인덱스 고속 전체 탐색(Index Fast Full Scan)</strong></p>\n<ul>\n<li>고속 전체 탐색은 멀티 블록 IO로 순서에 관계없이 인덱스 전체를 탐색한다. 병철 처리를 할 수 있다는 점도 차이점이다.</li>\n</ul>\n</li>\n<li>\n<p><strong>인덱스 스킵 탐색(Index Skip Scan)</strong></p>\n<ul>\n<li>일반적으로 결합 인덱스의 선행 항목이 WHERE 절에 없으면 해당 인덱스를 사용하지 않는다.</li>\n<li>그러나 선행 항목의 선택도 값이 커서 유일한 값의 종류가 소수일 때는 인덱스를 사용해 탐색하는 것이 테이블 전체 탐색보다 효율적인 경우가 있다.</li>\n</ul>\n</li>\n</ul>\n<h4>4.3.5 인덱스 수와 성능</h4>\n<ul>\n<li>인덱스 수가 증가하면 INSERT나 UPDATE 처럼 데이터를 변경하는 DML에는 성능 저하가 발생한다.</li>\n<li>데이터 입력이 거의 없는 테이블은 인덱스를 추가하는 데 부담이 없으나 입력이 빈번한 거래 로그나 업무 처리용 테이블은 제약받을 수 밖에 없다.</li>\n</ul>\n<h3 id=\"44-테이블\" style=\"position:relative;\">4.4 테이블<a href=\"#44-%ED%85%8C%EC%9D%B4%EB%B8%94\" aria-label=\"44 테이블 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>테이블에서 데이터를 읽는 방식에는 두 가지가 있다.</p>\n<ul>\n<li>인덱스 탐색을 통해 대상 레코드를 바로 찾아가서 읽는 방법</li>\n<li>전체 테이블을 읽어서 대상 레코드를 필터링해서 찾는 방법 (Table Full Scan)</li>\n</ul>\n</li>\n<li>-</li>\n</ul>\n<h4>4.4.1 Direct-Path와 Conventional-Path</h4>\n<h4>4.4.2 파티션 테이블</h4>\n<ul>\n<li>대용량 데이터베이스의 경우 한 테이블에 존재하는 레코드가 수십억 건을 저장하기도 한다.</li>\n<li>데이터가 분산돼 있어 조회 시 데이터 탐색 범위가 넓어져 성능 저하가 발생한다.</li>\n<li>이러한 문제를 해결하기 위해 데이터베이스는 관리와 조회 시에 중요한 역활을 담당하는 특정 컴럼을 기준으로 여러 개의 테이블로 나눠서 레코드를 저장, 관리하는 파티션이라는 기능이 있다.</li>\n<li>논리적으로는 하나의 테이블이지만 파티션 키 값에 따라 물리적으로 수 개에서 수천 개에 이르는 테이블을 나눠서 저장하게 된다.</li>\n</ul>","fields":{"slug":"/ch6/","thumbnail":null},"frontmatter":{"date":"March 13, 2022","update":"Mar 13, 2022","title":"6부 - SQL 최적화","description":null,"tags":["실무로 배우는 시스템 성능 최적화"],"thumbnail":null}},{"excerpt":"1. 기본 방향 소스코드 최적화 분석 시 중점적으로 체크할 항목 단순 정보성 로깅을 하는 부분이 있는가? 로깅을 하지 않을 때 로깅을 위한 문자열이나 데이터가 만들어지고 있는가? 전문 파싱이나 환경설정 로딩과 같은 작업이 반복 수행되는가? 락 범위를 최소화하거나 락을 회피할 수 있는가? 집합 데이터에 대한 검색 방식은 적절한가? 문자열 처리에 오버헤드가 …","html":"<h2 id=\"1-기본-방향\" style=\"position:relative;\">1. 기본 방향<a href=\"#1-%EA%B8%B0%EB%B3%B8-%EB%B0%A9%ED%96%A5\" aria-label=\"1 기본 방향 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>\n<p>소스코드 최적화 분석 시 중점적으로 체크할 항목</p>\n<ul>\n<li>단순 정보성 로깅을 하는 부분이 있는가?</li>\n<li>로깅을 하지 않을 때 로깅을 위한 문자열이나 데이터가 만들어지고 있는가?</li>\n<li>전문 파싱이나 환경설정 로딩과 같은 작업이 반복 수행되는가?</li>\n<li>락 범위를 최소화하거나 락을 회피할 수 있는가?</li>\n<li>집합 데이터에 대한 검색 방식은 적절한가?</li>\n<li>문자열 처리에 오버헤드가 존재하는가?</li>\n<li>반복 처리 로직이 존재하는가?</li>\n<li>기능이 단순한 함수이지만 호출 횟수가 많아 성능에 영향을 미치고 있는가?</li>\n<li>영업일, 계정과목, 공통코드 같은 소량 테이블에 빈번한 조회가 발생하는가?</li>\n<li>배치 같은 경우 결과가 한정적인 데이터에 대한 반복조회가 많이 있는가?</li>\n<li>포털 화면에서 보여지는 게시물 목록 같은 것을 캐시할 수 있는가?</li>\n<li>프로그램 흐름상 병목이 존재하는가?</li>\n<li>대량건 조회는 가능한가?</li>\n<li>송수신 전문 포맷과 크기는 시스템 특성과 네트워크 환경에 적합한가?</li>\n<li>한 서비스 내에서 연계 시스템과 빈번하게 통신하는가?</li>\n</ul>\n</li>\n</ul>\n<!-- more -->\n<h2 id=\"2-불필요한-작업-제거\" style=\"position:relative;\">2. 불필요한 작업 제거<a href=\"#2-%EB%B6%88%ED%95%84%EC%9A%94%ED%95%9C-%EC%9E%91%EC%97%85-%EC%A0%9C%EA%B1%B0\" aria-label=\"2 불필요한 작업 제거 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"21-로깅\" style=\"position:relative;\">2.1 로깅<a href=\"#21-%EB%A1%9C%EA%B9%85\" aria-label=\"21 로깅 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>로그는 시스템 관리자와 개발자에게 수행된 프로그램에 대한 추가 정보를 제공하기 위해 있는 것이지 로그가 있느냐 여부가 핵심 기능에 영향을 주는 것은 아니다.</li>\n</ul>\n<h4>2.1.1 잘못 사용된 로깅 수준</h4>\n<ul>\n<li>Log4J의 경우 <code class=\"language-text\">전체(ALL)</code>, <code class=\"language-text\">추적(Trace)</code>, <code class=\"language-text\">디버그(Debug)</code>, <code class=\"language-text\">정보(info)</code>, <code class=\"language-text\">경고(Warn)</code>, <code class=\"language-text\">에러(Error)</code>, <code class=\"language-text\">심각(Fatal)</code>, <code class=\"language-text\">끄기(Off)</code>라는 8가지 수준이 제공된다.</li>\n<li>\n<p>운영 시에는 경고, 에러 수준으로 로깅을 설정한다.</p>\n<ul>\n<li>운영 시스템의 로그 수준이 디버그로 낮게 설정돼 있으면 로깅을 위한 오버헤드 코드와 파일 입출력 병목으로 응답시간이 느려질 수 있다.</li>\n</ul>\n</li>\n<li>추적이나 디버그, 정보 성격의 로그를 에러나 심각으로 남기지 않는다.</li>\n</ul>\n<h4>2.1.2 로깅을 위한 불필요한 메시지 생성</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">// CASE <span class=\"token number\">1</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>int <span class=\"token assign-left variable\">i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>n<span class=\"token punctuation\">;</span> i++<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tLog.debug.println<span class=\"token punctuation\">(</span><span class=\"token string\">\"파일 서버에 전송할 입력 매개변수 + \"</span> + output<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n// CASE <span class=\"token number\">2</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>int <span class=\"token assign-left variable\">i</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>n<span class=\"token punctuation\">;</span> i++<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tif<span class=\"token punctuation\">(</span>Log.debug.isEnabled<span class=\"token punctuation\">(</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">{</span>\n\t\tLog.debug.println<span class=\"token punctuation\">(</span><span class=\"token string\">\"파일 서버에 전송할 입력 매개변수 + \"</span> + output<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">CASE 1</code>은 println 내부에서 디버그에 대한 로깅 여부를 확인해 출력하지 않아도 자바에서는 <code class=\"language-text\">“String” + Object.toString()</code> 문자열을 만드는 작업이 수행된다.</li>\n<li><code class=\"language-text\">CASE 2</code>는 <code class=\"language-text\">if(Log.debug.isEnabled())</code> 조건문으로 로깅 코드를 감싸서 로깅 수준이 비활성화 상태면 문자열을 만드는 작업이 수행되지 않는다.</li>\n</ul>\n<h4>2.1.3 로깅을 효율적으로 하기 위한 개선</h4>\n<ul>\n<li>개발 서버에 로깅하는 양이 너무 많아 원하는 로그를 찾는데 시간이 걸리고 성능 저하가 발생한다면 개발 서버도 기본 로그 수준을 경고로 설정하고, 테스트하는 구간만 디버그 수준으로 설정할 수 있다.</li>\n<li>서비스 요청 단위로 로깅을 관리하면 특정 서비스 요청만 디버그 수준으로 설정해 해당 서비스 전체의 성능 저하 없이 셀제 운영환경에서 디버그를 수행할 수 있다.</li>\n</ul>\n<h4>2.1.4 트랜잭션 저널 로그</h4>\n<h3 id=\"22-불필요한-로직\" style=\"position:relative;\">2.2 불필요한 로직<a href=\"#22-%EB%B6%88%ED%95%84%EC%9A%94%ED%95%9C-%EB%A1%9C%EC%A7%81\" aria-label=\"22 불필요한 로직 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>불필요한 로직은 공통 모듈을 사용할 때 주로 나타난다.</p>\n<ul>\n<li>대체로 공통 모듈은 다양한 경우에 대비해 여러 가지 값을 제공한다.</li>\n<li>어떤 로직에서는 필요하지 않은 정보도 함께 읽어오게 된다.</li>\n</ul>\n</li>\n<li>이를 방지하기 위해 포괄적인 정보 외에 사용 패턴을 고려해 세분화된 정보를 제공하는 함수도 다양하게 제공해야 한다.</li>\n</ul>\n<h3 id=\"23-반복-로직\" style=\"position:relative;\">2.3 반복 로직<a href=\"#23-%EB%B0%98%EB%B3%B5-%EB%A1%9C%EC%A7%81\" aria-label=\"23 반복 로직 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>성능에 영향을 주는 부분이 반복 작업으로 분석됐다면 맨 처음에 수행된 결괏값을 저장해 뒀다가 재사용할 수 있게 변수나 캐시를 둠으로써 성능 저하를 해결할 수 있다.</li>\n<li>\n<p>반복의 예</p>\n<ul>\n<li>통신전문에서 동일한 항목을 읽어내는 것임에도 파싱 작업을 한다.</li>\n<li><code class=\"language-text\">for</code>, <code class=\"language-text\">while</code> 문 안에서 매번 동일한 값으로 동일한 계산식을 수행하는 부분이 있다.</li>\n<li>외부 인터페이스를 호출할 때마다 관련 환경설정 파일을 매번 읽어 들인다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"24-불필요한-초기화-과정\" style=\"position:relative;\">2.4 불필요한 초기화 과정<a href=\"#24-%EB%B6%88%ED%95%84%EC%9A%94%ED%95%9C-%EC%B4%88%EA%B8%B0%ED%99%94-%EA%B3%BC%EC%A0%95\" aria-label=\"24 불필요한 초기화 과정 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>내부적으로 초기화 과정이 복잡하고 시간이 오래 걸리는 작업임에도 개발자 입장에서 코드를 작성하는 부분은 너무 단순해 모르고 넘어가는 경우가 있다.</p>\n<ul>\n<li>자바의 JAXB와 스프링 프레임워크의 RestTemplate등 이 있다.</li>\n</ul>\n</li>\n<li>스레드 안전한 클래스라면 싱글톤으로 선언하여 재사용할 수 있다.</li>\n<li>스레드 안전하지 않다면 ThreadLocal 같은 기능을 사용해 스레드별로 만들어 사용할 수도 있다.</li>\n</ul>\n<h2 id=\"3-로직-최적화\" style=\"position:relative;\">3. 로직 최적화<a href=\"#3-%EB%A1%9C%EC%A7%81-%EC%B5%9C%EC%A0%81%ED%99%94\" aria-label=\"3 로직 최적화 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"31-락-최소화\" style=\"position:relative;\">3.1 락 최소화<a href=\"#31-%EB%9D%BD-%EC%B5%9C%EC%86%8C%ED%99%94\" aria-label=\"31 락 최소화 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>애플리케이션에서도 여러 프로세스나 스레드가 동일 데이터에 접근함으로써 발생할 수 있는 오류를 방지하기 위해 락을 사용한다.</li>\n<li>C/C++는 세마포어, 뮤텍스, 크리티컬 섹션 등으로 락을 제공</li>\n<li>자바는 synchronized, wait/nofity 등 제어 구문 외에도 동시성을 제어하는 클래스를 제공한다.</li>\n</ul>\n<h4>3.1.1 락 범위 최소화</h4>\n<ul>\n<li>캐시를 구성할 때 보통 데이터 종류별로 하나의 메모리 구조로 설계하는 것이 일반적이다.</li>\n<li>이 경우 해당 메모리 전체에 대해서 싱글포인트락이 존재하는 경우 동시 대량 처리 시 락 경합이 발생할 수 있으므로 복수 개의 메모리 구조로 쪼개서 락 경합을 분산할 수 있다.</li>\n</ul>\n<h4>3.1.2 락 제거</h4>\n<h3 id=\"32-문자열-처리-개선\" style=\"position:relative;\">3.2 문자열 처리 개선<a href=\"#32-%EB%AC%B8%EC%9E%90%EC%97%B4-%EC%B2%98%EB%A6%AC-%EA%B0%9C%EC%84%A0\" aria-label=\"32 문자열 처리 개선 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>3.2.1 String.format 메서드</h4>\n<ul>\n<li>StringBuilder 로 처리하는 것에 비해 String.format이 10배정도 느리다.</li>\n</ul>\n<h4>3.2.2 String.replaceAll 메서드</h4>\n<ul>\n<li>replaceAll 내부는 정규 표현식을 사용하는 형태로 구현돼 있어서 복잡하다.</li>\n</ul>\n<h4>3.2.3 문자열 합치기</h4>\n<ul>\n<li>자바 초기에는 “String” + 변수 + “String” 형태로 문자열을 처리하면 합치는 횟수만큼 객체가 생성되어 성능이 좋지 않았다.</li>\n<li>하지만 자바 버전이 올라가면서 컴파일러가 코드 최적화를 통해 StringBuilder로 대체하므로 개선 대상으로 고려하지 않아도 된다.</li>\n</ul>\n<h3 id=\"33-리플렉션-호출-제거\" style=\"position:relative;\">3.3 리플렉션 호출 제거<a href=\"#33-%EB%A6%AC%ED%94%8C%EB%A0%89%EC%85%98-%ED%98%B8%EC%B6%9C-%EC%A0%9C%EA%B1%B0\" aria-label=\"33 리플렉션 호출 제거 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>리플렉션 호출은 프로그램에 유연성과 확장성을 제공하지만 이를 구현하기 위해 객체를 생성하고 메서드를 호출하기 위한 준비 작업 하나하나가 직접 메서드를 호출하는 것과 맞먹는 비용이 든다.</li>\n</ul>\n<h3 id=\"34-채번\" style=\"position:relative;\">3.4 채번<a href=\"#34-%EC%B1%84%EB%B2%88\" aria-label=\"34 채번 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>애플리케이션 코드 내에서 채번이 이뤄지는 경우에는 성능에 큰 영향이 없으나 DB 내에서 채번이 이뤄지는 경우에는 성능 저하의 원인이 되는 경우가 많다.</li>\n<li>\n<p>DB 내 채번 방식</p>\n<ul>\n<li>기존 최대값 조회 MAX+1</li>\n<li>동시에 채번이 이뤄지는 경우 동일한 번호가 채번되어 후속 작업에서 에러가 발생할 수 있다.</li>\n<li>채번 테이블</li>\n<li>채번 테이블에 유형별 레코드로 채번 번호를 관리하는 방식</li>\n<li>DB 채번 기능</li>\n<li>DB에서 재공하는 채번 기능을 사용하는 것으로 세 가지 방식 중 가장 성능이 우수하다.</li>\n</ul>\n</li>\n<li>매번 DB에서 채번하게 되면 10,000번 채번에 DB 호출이 10,000번 수행되어야 한다.</li>\n<li>하지만 채번 테이블의 채번 캐시 크기를  예를 10,00 단위로 사용하게 되면 10,000번 채번 1번당 DB 채번이 이뤄지므로 성능이 훨등히 개선된다.</li>\n</ul>\n<h3 id=\"35-날짜-연산\" style=\"position:relative;\">3.5 날짜 연산<a href=\"#35-%EB%82%A0%EC%A7%9C-%EC%97%B0%EC%82%B0\" aria-label=\"35 날짜 연산 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"36-시간-문자열-처리\" style=\"position:relative;\">3.6 시간 문자열 처리<a href=\"#36-%EC%8B%9C%EA%B0%84-%EB%AC%B8%EC%9E%90%EC%97%B4-%EC%B2%98%EB%A6%AC\" aria-label=\"36 시간 문자열 처리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"37-순차-검색-제거\" style=\"position:relative;\">3.7 순차 검색 제거<a href=\"#37-%EC%88%9C%EC%B0%A8-%EA%B2%80%EC%83%89-%EC%A0%9C%EA%B1%B0\" aria-label=\"37 순차 검색 제거 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"38-파일-입출력-단위\" style=\"position:relative;\">3.8 파일 입출력 단위<a href=\"#38-%ED%8C%8C%EC%9D%BC-%EC%9E%85%EC%B6%9C%EB%A0%A5-%EB%8B%A8%EC%9C%84\" aria-label=\"38 파일 입출력 단위 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>파일 처리는 입출력 단위가 큰 것이 성능에 유리하다.</li>\n<li>버퍼를 가지고 있는 입출력 클래스를 사용해 버퍼 단위로 입출력이 발생하게 하는 편이 우수한 성능을 발휘한다.</li>\n<li><code class=\"language-text\">BufferedOutpuStream</code>, <code class=\"language-text\">BufferedInputStream</code></li>\n</ul>\n<h3 id=\"39-SQL\" style=\"position:relative;\">3.9 SQL<a href=\"#39-SQL\" aria-label=\"39 SQL permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p><strong>SQL 바인드 변수 처리</strong></p>\n<ul>\n<li>SQL을 수행할 때는 PreparedStatement 객체를 사용하여 바인드 변수 처리하는 것이 기본 원칙이다.</li>\n<li>SQL 캐시효과, 하드 파싱, 공유 풀 경합 등</li>\n<li>바인드 변수를 사용하지 않으면 필요 이상으로 많은 SQL이 공유 풀에 저장되어 메모리 사용량이 증가한다.</li>\n</ul>\n</li>\n<li>\n<p><strong>자원 반납</strong></p>\n<ul>\n<li>SQL을 수행한 후 사용한 JDBC 자원을 반납하지 않으면 성능 저하나 장애가 유발된다.</li>\n<li>Statement를 반납하지 않으면 DB 프로세스 당 할당된 최대 커서 수에 도달해 더는 SQL을 처리할 수 없는 상황이 되고, 자바 메모리 누수 또한 발생한다.</li>\n<li>자원 반납은 ResultSet, Statement, Connection 순으로 수행한다.</li>\n</ul>\n</li>\n<li>\n<p><strong>DB 연결 풀 사용</strong></p>\n<ul>\n<li>DB는 새로운 연결을 맺을 때 많은 비용이 드므로 일반적으로 연결 풀을 사용한다.</li>\n<li>평상시 부하는 연결을 늘리지 않고도 처리할 수 있을 정도로 최소 연결 풀 개수를 유지한다.</li>\n<li>더미 쿼리를 사용해 주기적으로 연결을 테스트함으로써 DB 연결이 방화벽이나 운영체제 설정에 의해 끊어지지 않게 한다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"310-BigDecimal\" style=\"position:relative;\">3.10 BigDecimal<a href=\"#310-BigDecimal\" aria-label=\"310 BigDecimal permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>float 이나 double 숫자 타입은 정확성이 아닌 성능 위주로 설계된 부동 소수 형식을 사용하기 때문에 일부 값이 정확하지 않고 근사값으로 표현된다.</li>\n<li>BigDecimal을 생성할 때 new BigDecimal(double) 보다는 new BigDecimal(String)을 사용한다.</li>\n<li>double로 변환해야 하는 경우에는 BigDecimal.valueOf(double) 메서드를 사용한다.</li>\n</ul>\n<h3 id=\"311-비대기-입출력-사용\" style=\"position:relative;\">3.11 비대기 입출력 사용<a href=\"#311-%EB%B9%84%EB%8C%80%EA%B8%B0-%EC%9E%85%EC%B6%9C%EB%A0%A5-%EC%82%AC%EC%9A%A9\" aria-label=\"311 비대기 입출력 사용 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>논블럭킹 I/O 를 사용하면 읽어내고자 하는 야보다 데이터가 적거나 전혀 없더라도 현재 있는 데이터 양만큼 읽고 나온다.</li>\n</ul>\n<h3 id=\"312-엑셀-처리\" style=\"position:relative;\">3.12 엑셀 처리<a href=\"#312-%EC%97%91%EC%85%80-%EC%B2%98%EB%A6%AC\" aria-label=\"312 엑셀 처리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>엑셀 포맷을 다룰 때 일반적으로 아파치의 POI를 사용한다.</li>\n<li>\n<p>POI는 엑셀 파일을 다룰 때 크게 스트리밍과 인 메모리 트리라는 두 가지 방식을 사용한다.</p>\n<ul>\n<li>인메모리 트리는 문서 내용 전체를 메모리에 유지하므로 메모리 사용량이 크고, 스트리밍에 비해 속도가 느리다.</li>\n</ul>\n</li>\n<li>버퍼드 스트리밍은 전체 데이터를 메모리에 가지고 있지 않고 일정 건수가 되면 디스크로 내리기 때문에 메모리 제약이 없어 큰 용량의 데이터 처리가 가능하다.</li>\n</ul>\n<h3 id=\"313-기타-성능-개선\" style=\"position:relative;\">3.13 기타 성능 개선<a href=\"#313-%EA%B8%B0%ED%83%80-%EC%84%B1%EB%8A%A5-%EA%B0%9C%EC%84%A0\" aria-label=\"313 기타 성능 개선 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"314-코드-성능-측정\" style=\"position:relative;\">3.14 코드 성능 측정<a href=\"#314-%EC%BD%94%EB%93%9C-%EC%84%B1%EB%8A%A5-%EC%B8%A1%EC%A0%95\" aria-label=\"314 코드 성능 측정 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h2 id=\"4-적극적인-캐시-사용\" style=\"position:relative;\">4. 적극적인 캐시 사용<a href=\"#4-%EC%A0%81%EA%B7%B9%EC%A0%81%EC%9D%B8-%EC%BA%90%EC%8B%9C-%EC%82%AC%EC%9A%A9\" aria-label=\"4 적극적인 캐시 사용 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>성능 튜닝의 한 축은 서비스 간이나 서비스 내에서 반복되는 로직을 제거하는 것 이다.</li>\n<li>기존에 작업한 결과를 저장해 뒀다아 이후에 다시 동일한 작업이 수행됐을 때 결과를 재사용하면 반복되는 로직을 제거할 수 있다.</li>\n<li>브라우저</li>\n<li>도메인명에 대한 주소 캐시</li>\n<li>콘텐츠 캐시</li>\n<li>웹 서버</li>\n<li>환경설정 캐시</li>\n<li>콘텐츠 캐시</li>\n<li>WAS</li>\n<li>환경설정 캐시</li>\n<li>프로그램 모듈 캐시</li>\n<li>애플리케이션</li>\n<li>적극적인 사용이 요구되는 부분</li>\n<li>프레임 워크</li>\n<li>환경설정 캐시</li>\n<li>서비스와 프로그램 구성 캐시</li>\n<li>송수신 전문 구조 캐시</li>\n<li>SQL 캐시</li>\n<li>애플리케이션을 위한 캐시 제공</li>\n<li>DBMS</li>\n<li>환경설정 캐시</li>\n<li>테이블, 인덱스, 권한 등 구성정보 캐시</li>\n<li>SQL 실행계획 캐시</li>\n<li>데이터 캐시</li>\n</ul>\n<h2 id=\"5-효율적인-아키텍처-구성\" style=\"position:relative;\">5. 효율적인 아키텍처 구성<a href=\"#5-%ED%9A%A8%EC%9C%A8%EC%A0%81%EC%9D%B8-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B5%AC%EC%84%B1\" aria-label=\"5 효율적인 아키텍처 구성 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"51-병렬-처리\" style=\"position:relative;\">5.1 병렬 처리<a href=\"#51-%EB%B3%91%EB%A0%AC-%EC%B2%98%EB%A6%AC\" aria-label=\"51 병렬 처리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>웹 기반 시스템은 각 구성 서버마다 병렬 처리를 설정할 수 있다.</li>\n<li>웹 서버는 사용자의 모든 서비스 요청을 받아들이는 곳으로, 한 사용자가 6개 이상의 병렬 스레드를 사용할 수도 있다.</li>\n<li>그러나 요청이 WAS 까지 도달하면 스레드를 한두 개 사용한다.</li>\n<li>DB 동시 작업은 애플리케이션 처리시간과 DB 연결 사용시간이 거의 일치하면 스레드 풀 설정과 거의 동등한 수준으로 DB 연결 풀을 사용한다.</li>\n<li>아키텍처를 스레드 병렬 구조로 만들 때는 반드시 앞쪽에 큐를 둬서 스레드가 작압 단위 간에 쉼 없이 연속해서 처리할 수 있도록 해야한다.</li>\n</ul>\n<h3 id=\"52-통신전문\" style=\"position:relative;\">5.2 통신전문<a href=\"#52-%ED%86%B5%EC%8B%A0%EC%A0%84%EB%AC%B8\" aria-label=\"52 통신전문 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>XML의 경우에는 메모리 사용량과 전문 크기가 많다.</li>\n<li>이를 개선하기 위해 컬럼명을 레코드 첫 부분에 한번만 기술하고 이후 반복되는 레코드에서 컬럼명을 생략하고 데이터만 기술하는 변형된 형태의 JSON을 적용했다.</li>\n<li>따라서 고성능 시스템이 필요하거나 사용자가 원격지에 있어 데이터 전송량을 줄여 속도를 개선해야 하는 경우에는 다른 형식의 전문을 고려해야 한다.</li>\n</ul>\n<h3 id=\"53-고객정보-조회-이력-로깅과-마스킹\" style=\"position:relative;\">5.3 고객정보 조회 이력 로깅과 마스킹<a href=\"#53-%EA%B3%A0%EA%B0%9D%EC%A0%95%EB%B3%B4-%EC%A1%B0%ED%9A%8C-%EC%9D%B4%EB%A0%A5-%EB%A1%9C%EA%B9%85%EA%B3%BC-%EB%A7%88%EC%8A%A4%ED%82%B9\" aria-label=\"53 고객정보 조회 이력 로깅과 마스킹 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"54-대량-조회-프레임워크-구성\" style=\"position:relative;\">5.4 대량 조회 프레임워크 구성<a href=\"#54-%EB%8C%80%EB%9F%89-%EC%A1%B0%ED%9A%8C-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EA%B5%AC%EC%84%B1\" aria-label=\"54 대량 조회 프레임워크 구성 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>데이터를 대량으로 조회하다보면 메모리 부족으로 애플리케이션 서버가 다운되는 문제를 경함하게 된다.</li>\n<li>\n<p>아래와 같은 방안으로 대량건 조회를 대처할 수 있다.</p>\n<ul>\n<li>프레임워크 DAO에서 일정건이상 조회하면 예외를 발생시킨다.</li>\n<li>대량건 조회는 페이징 처리를 통해 메모리에 무리가 없는 단위로 나눠서 처리한다.</li>\n<li>대량 조회가 이뤄지지 않도록 조회 건수를 줄이는 필수 조건을 입력하도록 유도한다.</li>\n<li>일반 온라인 업무에 영향을 주지 않도록 대량 조회 전용 WAS 인스턴스를 구성한다.</li>\n<li>배치 같은 별도 프로세스에서 대량 건을 파일로 생성한 다음 파일을 다운로드하게 한다.</li>\n</ul>\n</li>\n<li>프레임워크에서 대량건 조회를 지원하기 위해서는 자바의 경우 JDBC ResultSet과 전문 생성 부분을 바로 연결해야 한다.</li>\n</ul>\n<h3 id=\"55-내부-연계시스템\" style=\"position:relative;\">5.5 내부 연계시스템<a href=\"#55-%EB%82%B4%EB%B6%80-%EC%97%B0%EA%B3%84%EC%8B%9C%EC%8A%A4%ED%85%9C\" aria-label=\"55 내부 연계시스템 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"56-수직확장과-수평확장\" style=\"position:relative;\">5.6 수직확장과 수평확장<a href=\"#56-%EC%88%98%EC%A7%81%ED%99%95%EC%9E%A5%EA%B3%BC-%EC%88%98%ED%8F%89%ED%99%95%EC%9E%A5\" aria-label=\"56 수직확장과 수평확장 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>성능 저하가 발생하면 서버를 늘리는 수평확장보다 CPU나 메모리를 증설하는 수직확장을 선호해 왔다.</p>\n<ul>\n<li>수평확장은 서버간 동기화로 인한 성능 저하가 발생할 수 있기 때문에</li>\n</ul>\n</li>\n<li>수평확장이 가능하도록 아키텍처를 구성하려면 다음과 같은 사항을 고려해야 한다.</li>\n<li>데이터베이스 샤딩</li>\n<li>샤딩은 여러 DB에 데이터를 나눠서 저장하는 기술이다.</li>\n<li>파티션은 한 DB에 분산 저장하는 것이고, 샤딩은 복수 DB에 분산 저장한다.</li>\n<li>샤딩은 DBMS가 제공하는 기능이 아니므로 애플리케이션에서 로직으로 구현해서 적용한다.</li>\n<li>DB 샤딩에서 수평확장이 용이하게 하려면 초기 샤딩 아키텍처를 설계할 때 온라인 상태에서 DB 서버를 늘리고 데이터를 옮길 수 있는 방안을 마련해야 한다.</li>\n<li>DB 서버가 4대에서 6대로 증가할 때 샤딩된 기존 저장된 DB서버를 찾아가고 증가된 DB수에 따라 데이터 재배치가 이뤄질 수 있어야 한다.</li>\n<li>DB 샤딩의 한계는 구축하기가 어렵고, 샤딩된 데이터로 인해 테이블 간에 조인이 제한적이거나 불가능하다는 것이다.</li>\n<li>대량의 데이터 처리를 고려할 때 데이터 저장 솔루션으로 고려하는 것이 NoSQL 이다.</li>\n<li>NoSQL을 이용하면 자동분할과 노드 추가 시 자동 재분배, 이중화에 의한 장애 대응까지 솔류션이 지원하므로 유연한 수평확장이 가능하다.</li>\n<li>StatelessProcessing</li>\n<li>WAS에서 세션을 통해 사용자 인증 정보를 관리하는 경우가 많다.</li>\n<li>여러 대의 WAS 서버를 사용하는 경우 세션 클러스터링 기술을 사용한다.</li>\n<li>그런데 서버 수가 많아지면 이마저도 성능 저하 요인이 된다.</li>\n<li>시스템을 Stateless 아키텍처로 만들어지면 사용자 서비스 요청이 어떤 애플리케이션 서버에서도 처리할 수 있다.</li>\n<li>인메모리 데이터 그리드</li>\n<li>인메모리 데이터 그리드는 키캆 형식의 데이터 캐시 솔류션이다.</li>\n<li>DBMS에 저장된 데이터나 사용자 서비스 호출 간에 공유할 데이터를 캐시해서 성능을 개선할 목적으로 사용한다.</li>\n<li>상대적으로 데이터의 생명주기가 짧고 변경이 발생하지 않는 데이터에 대해 캐시하는 것이다.</li>\n</ul>","fields":{"slug":"/ch5/","thumbnail":null},"frontmatter":{"date":"February 20, 2022","update":"Feb 20, 2022","title":"5부 - 소스코드 최적화","description":null,"tags":["실무로 배우는 시스템 성능 최적화"],"thumbnail":null}},{"excerpt":"4부 - 프로세스 이해하기 1. 기본 방향 애플리케이션 최적화를 하기 위해서 프로세스의 동작 방식을 이해해야 한다. 프로세스 이해에 필요한 기본 지식으로 다음 세 가지가 있다. 수행 중인 코드 : 프로세스가 현재 어떤 함수를 수행하고 있는가? 통신/파일 상태 : 프로세스가 통신으로 연계된 서버는 어디고, 어떤 파일을 열고 있는가? 통신/파일 간 동작 상태…","html":"<h2 id=\"4부---프로세스-이해하기\" style=\"position:relative;\">4부 - 프로세스 이해하기<a href=\"#4%EB%B6%80---%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\" aria-label=\"4부   프로세스 이해하기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h2 id=\"1-기본-방향\" style=\"position:relative;\">1. 기본 방향<a href=\"#1-%EA%B8%B0%EB%B3%B8-%EB%B0%A9%ED%96%A5\" aria-label=\"1 기본 방향 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>애플리케이션 최적화를 하기 위해서 프로세스의 동작 방식을 이해해야 한다.</li>\n<li>\n<p>프로세스 이해에 필요한 기본 지식으로 다음 세 가지가 있다.</p>\n<ul>\n<li><strong>수행 중인 코드</strong> : 프로세스가 현재 어떤 함수를 수행하고 있는가?</li>\n<li><strong>통신/파일 상태</strong> : 프로세스가 통신으로 연계된 서버는 어디고, 어떤 파일을 열고 있는가?</li>\n<li><strong>통신/파일 간 동작 상태</strong> : 연계 서버 또는 파일에 입출력이 얼마나 자주 그리고 오래 이루어지는가?</li>\n</ul>\n</li>\n<li>이번 장에서는 운영체제에서 제공하는 분석 명령어를 바탕으로 프로세스의 현재 상태와 동작을 이해하는 법과 개선 하는 방법을 습득한다.</li>\n</ul>\n<!-- more -->\n<h2 id=\"2-수행-중인-코드\" style=\"position:relative;\">2. 수행 중인 코드<a href=\"#2-%EC%88%98%ED%96%89-%EC%A4%91%EC%9D%B8-%EC%BD%94%EB%93%9C\" aria-label=\"2 수행 중인 코드 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"21-스택에-대한-이해\" style=\"position:relative;\">2.1 스택에 대한 이해<a href=\"#21-%EC%8A%A4%ED%83%9D%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%B4%ED%95%B4\" aria-label=\"21 스택에 대한 이해 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>현재 수행 중인 프로그램이 코드 중 어디를 수행하고 있는지 알고 싶을 때는 해당 프로그램의 스택 정보를 획득하면 알 수 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">leegisu<span class=\"token operator\">></span> jstack <span class=\"token number\">12341</span>\n\nFull thread dump OpenJDK <span class=\"token number\">64</span>-Bit Server VM <span class=\"token punctuation\">(</span><span class=\"token number\">11.0</span>.12+7-LTS mixed mode<span class=\"token punctuation\">)</span>:\n\n<span class=\"token string\">\"http-nio-8080-Acceptor\"</span> <span class=\"token comment\">#28 daemon prio=5 os_prio=31 cpu=0.55ms elapsed=23.70s tid=0x00007ff0a3232000 nid=0x14b03 runnable  [0x000000030b22f000]</span>\n   java.lang.Thread.State: RUNNABLE\n        at sun.nio.ch.ServerSocketChannelImpl.accept0<span class=\"token punctuation\">(</span>java.base@11.0.12/Native Method<span class=\"token punctuation\">)</span>\n        at sun.nio.ch.ServerSocketChannelImpl.accept<span class=\"token punctuation\">(</span>java.base@11.0.12/ServerSocketChannelImpl.java:533<span class=\"token punctuation\">)</span>\n        at sun.nio.ch.ServerSocketChannelImpl.accept<span class=\"token punctuation\">(</span>java.base@11.0.12/ServerSocketChannelImpl.java:285<span class=\"token punctuation\">)</span>\n        at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept<span class=\"token punctuation\">(</span>NioEndpoint.java:540<span class=\"token punctuation\">)</span>\n        at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept<span class=\"token punctuation\">(</span>NioEndpoint.java:78<span class=\"token punctuation\">)</span>\n        at org.apache.tomcat.util.net.Acceptor.run<span class=\"token punctuation\">(</span>Acceptor.java:129<span class=\"token punctuation\">)</span>\n        at java.lang.Thread.run<span class=\"token punctuation\">(</span>java.base@11.0.12/Thread.java:829<span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"22-스택-정보를-이용한-성능-분석\" style=\"position:relative;\">2.2 스택 정보를 이용한 성능 분석<a href=\"#22-%EC%8A%A4%ED%83%9D-%EC%A0%95%EB%B3%B4%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%84%B1%EB%8A%A5-%EB%B6%84%EC%84%9D\" aria-label=\"22 스택 정보를 이용한 성능 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>스택 정보는 성능 저하나 멈춤 상태에서 프로세스를 분석하는 핵심 정보다.</li>\n</ul>\n<h4>2.2.1 스택 대기 분석</h4>\n<ul>\n<li><code class=\"language-text\">- locked</code> 면 락을 잡았다는 의미</li>\n<li><code class=\"language-text\">- waiting to lock</code> 은 다른 스레드가 사용할 락을 잡고 있어 대기하고 있다는 의미</li>\n</ul>\n<h4>2.2.2 교착상태</h4>\n<h4>2.2.3 스택 성능 분석</h4>\n<h3 id=\"23-스택-수집\" style=\"position:relative;\">2.3 스택 수집<a href=\"#23-%EC%8A%A4%ED%83%9D-%EC%88%98%EC%A7%91\" aria-label=\"23 스택 수집 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>자바 프로그램의 스택 정보 수집</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">jstack <span class=\"token punctuation\">[</span>pid<span class=\"token punctuation\">]</span> // <span class=\"token punctuation\">[</span>JDK <span class=\"token environment constant\">HOME</span><span class=\"token punctuation\">]</span>/bin 디렉터리에 있음\n<span class=\"token function\">kill</span> <span class=\"token parameter variable\">-3</span> <span class=\"token punctuation\">[</span>pid<span class=\"token punctuation\">]</span> // 표준 출력으로 스레드 덤프를 출력</code></pre></div>\n<ul>\n<li>\n<p>자바 힙 덤프 설정</p>\n<ul>\n<li>자바 프로세스에서 아래와 같이 설정이 추가돼 있으면 <code class=\"language-text\">kill -3</code> 시그널에서 힙 덤프가 생성된다.</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token parameter variable\">-XX:+HeapDumpOnCtrlBreak</span></code></pre></div>\n<h3 id=\"24-프로세스-스택-분석-도구\" style=\"position:relative;\">2.4 프로세스 스택 분석 도구<a href=\"#24-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%8A%A4%ED%83%9D-%EB%B6%84%EC%84%9D-%EB%8F%84%EA%B5%AC\" aria-label=\"24 프로세스 스택 분석 도구 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>2.4.1 환경설정</h4>\n<h4>2.4.2 주요 기능 설명</h4>\n<h4>2.4.3 SDPA를 이용한 성능 분석</h4>\n<h2 id=\"3-통신파일-상태\" style=\"position:relative;\">3. 통신/파일 상태<a href=\"#3-%ED%86%B5%EC%8B%A0%ED%8C%8C%EC%9D%BC-%EC%83%81%ED%83%9C\" aria-label=\"3 통신파일 상태 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"31-파일-지시자의-이해\" style=\"position:relative;\">3.1 파일 지시자의 이해<a href=\"#31-%ED%8C%8C%EC%9D%BC-%EC%A7%80%EC%8B%9C%EC%9E%90%EC%9D%98-%EC%9D%B4%ED%95%B4\" aria-label=\"31 파일 지시자의 이해 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7d5892ad5b67ed5ca97e906a13f98a1c/4ab23/img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFElEQVR42jVQy0oDQRDM/18UREQ8CCKBqIgRJIgXf8LEgwaT7OyY3dnZV2bnsdmUPS05FAXdXQ96ZIyB2Rl0pmM2kWnmnOOZsw7BB3RdB2stwfHOdpZmludVVeL9dYa3lyeMPB3HZTwKITD6vse+32MYBhyGA4LzJKrQtjs479hk9bOCTCXqqsby+wu311d4fpxgpHUFKbdQSvHhf8sdMYEMmrqGynKIJEGhCoYipCKFJi61xuJjjsvzU0zGN9GwRJIITluv1tisNxBCYCt/UdEumkkSyzRFnmXcKLatKUhsEjb+XMxxcXaC+2gY/6UppW1bqFwhI5EuYnLJ4rZpuO3xh8eXRHjv4YOnxjmmd2PMpg/4A7VUdOzUU/PYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"\"\n        src=\"/static/7d5892ad5b67ed5ca97e906a13f98a1c/ca1dc/img.png\"\n        srcset=\"/static/7d5892ad5b67ed5ca97e906a13f98a1c/e7570/img.png 170w,\n/static/7d5892ad5b67ed5ca97e906a13f98a1c/f46e7/img.png 340w,\n/static/7d5892ad5b67ed5ca97e906a13f98a1c/ca1dc/img.png 680w,\n/static/7d5892ad5b67ed5ca97e906a13f98a1c/02d09/img.png 1020w,\n/static/7d5892ad5b67ed5ca97e906a13f98a1c/9d567/img.png 1360w,\n/static/7d5892ad5b67ed5ca97e906a13f98a1c/4ab23/img.png 1462w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a96053d6c50ad6777b2298ee33d8b4fa/7daeb/img_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.588235294117645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACEklEQVR42nVSy24aQRDc/z8kJ98slNiOlBBLlsLBB6Iokg2xFsvGwcCCDft+v2YfwC4LVHoGOcolI5V6utVTM1PV0uFwwHa7xXq9xq5psN/vsdvtaL9Ds21EjecNRY44jqHrOqIoQlVXyPMMJuWd9gW6nUtIvNlzPTi2gziMEAYhIoLnuHAJjuMg8Dz4BMu0oCgKRr9H1BeApSlsqj0MBjg9eYer9scjIb/V93zYti3IQz+AoemYTCaYKzNBmMaJeFUYhmAsQ1kWSNMElmFgMJDROnmPb1/PITX0NZYy+L4vyOIoFtF1XWiqBkM3YBomkiQRZKqqipeWZYkizxHQufHzCJcXp/hxfcUJGxRFgaqqsNlssFqthJ7/W1xzjn9XkTHc975j/HgHiRe4EXVdU+P+7wFeO+Ig8La4RNxEHt/6WBJDvuliMpQhbTYVaeeIL3PHsiwjbVLSiVE8gkvCc661MlUwHA6pP0DGctiWDVmW8eW8hf7NT0hVVVPRI1IPumaQZiblDl5eXjEeT6GROVw7TsBd5wQhmZMXJV2QQiN9+70ePp+1IPdvIdX1Vji8eF1iSTANC7PZnISeYKbMaUxmglSni3h9sVAR0Fjl+Qpxwqjfxq/bHtqfPtD43B1Nqaq1QFHk5GYMg0aBO8xYSq4HNKO2mMMpjdHT4xDqYok1uZyzBK5t4enhHt3rDuZzBX8A++TkCGue0YoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img 1\"\n        title=\"\"\n        src=\"/static/a96053d6c50ad6777b2298ee33d8b4fa/ca1dc/img_1.png\"\n        srcset=\"/static/a96053d6c50ad6777b2298ee33d8b4fa/e7570/img_1.png 170w,\n/static/a96053d6c50ad6777b2298ee33d8b4fa/f46e7/img_1.png 340w,\n/static/a96053d6c50ad6777b2298ee33d8b4fa/ca1dc/img_1.png 680w,\n/static/a96053d6c50ad6777b2298ee33d8b4fa/02d09/img_1.png 1020w,\n/static/a96053d6c50ad6777b2298ee33d8b4fa/9d567/img_1.png 1360w,\n/static/a96053d6c50ad6777b2298ee33d8b4fa/7daeb/img_1.png 1386w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>유닉스와 리눅스는 소켓이나 파일을 사용할 때 파일 지시자(FD)라는 것을 사용한다.</li>\n<li>유닉스에서 파일 지시자는 파일 뿐만 아니라 디렉토리, 디바이스, 파이프, 네트워크 소켓, 유닉스 도메인 소켓 등에 접근할 떄도 사용된다.</li>\n<li>유닉스 프로세스 FD 상태 정보는 pfiles ,lsof 명령을 통해 조회할 수 있다.</li>\n</ul>\n<h3 id=\"32-연계-통신파일-상태-정보를-수집하는-방법\" style=\"position:relative;\">3.2 연계 통신/파일 상태 정보를 수집하는 방법<a href=\"#32-%EC%97%B0%EA%B3%84-%ED%86%B5%EC%8B%A0%ED%8C%8C%EC%9D%BC-%EC%83%81%ED%83%9C-%EC%A0%95%EB%B3%B4%EB%A5%BC-%EC%88%98%EC%A7%91%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"32 연계 통신파일 상태 정보를 수집하는 방법 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li><code class=\"language-text\">lsof -p [pid]</code> 로 대상 프로세스의 상태를 조회할 수 있다.</li>\n</ul>\n<h2 id=\"4-통신파일-간-동작\" style=\"position:relative;\">4. 통신/파일 간 동작<a href=\"#4-%ED%86%B5%EC%8B%A0%ED%8C%8C%EC%9D%BC-%EA%B0%84-%EB%8F%99%EC%9E%91\" aria-label=\"4 통신파일 간 동작 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"41-시스템-콜에-대한-이해\" style=\"position:relative;\">4.1 시스템 콜에 대한 이해<a href=\"#41-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%BD%9C%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%B4%ED%95%B4\" aria-label=\"41 시스템 콜에 대한 이해 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>스택 정보와 통신/파일 상태 정보는 시점 정보이기 때문에 파일을 계속 열고 있지 않고 순간적으로 여닫는 경우는 잡히지 않을 수도 있다.</li>\n<li>이러한 정보를 얻기 위해서는 시스템 콜을 모니터링 해야 한다.</li>\n<li>유닉스나 리눅스는 C언어를 기반으로 개발되어 시스템 콜에 보이는 함수가 C로 개발된 시스템 라이브러리에서 제공되는 함수이다.</li>\n</ul>\n<h3 id=\"42-통신파일-상태와-동작-연계-분석\" style=\"position:relative;\">4.2 통신/파일 상태와 동작 연계 분석<a href=\"#42-%ED%86%B5%EC%8B%A0%ED%8C%8C%EC%9D%BC-%EC%83%81%ED%83%9C%EC%99%80-%EB%8F%99%EC%9E%91-%EC%97%B0%EA%B3%84-%EB%B6%84%EC%84%9D\" aria-label=\"42 통신파일 상태와 동작 연계 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"43-스택-정보와-통신파일-간-동작-연계-분석\" style=\"position:relative;\">4.3 스택 정보와 통신/파일 간 동작 연계 분석<a href=\"#43-%EC%8A%A4%ED%83%9D-%EC%A0%95%EB%B3%B4%EC%99%80-%ED%86%B5%EC%8B%A0%ED%8C%8C%EC%9D%BC-%EA%B0%84-%EB%8F%99%EC%9E%91-%EC%97%B0%EA%B3%84-%EB%B6%84%EC%84%9D\" aria-label=\"43 스택 정보와 통신파일 간 동작 연계 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"44-통신파일-간-동작-모니터링-방법\" style=\"position:relative;\">4.4 통신/파일 간 동작 모니터링 방법<a href=\"#44-%ED%86%B5%EC%8B%A0%ED%8C%8C%EC%9D%BC-%EA%B0%84-%EB%8F%99%EC%9E%91-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%EB%B0%A9%EB%B2%95\" aria-label=\"44 통신파일 간 동작 모니터링 방법 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h2 id=\"5-기타\" style=\"position:relative;\">5. 기타<a href=\"#5-%EA%B8%B0%ED%83%80\" aria-label=\"5 기타 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"51-프로그램-소스코드-보기\" style=\"position:relative;\">5.1 프로그램 소스코드 보기<a href=\"#51-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EB%B3%B4%EA%B8%B0\" aria-label=\"51 프로그램 소스코드 보기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"52-바이너리-코어-덤프에서-자바-스택이나-힙-정보를-추출하는-방법\" style=\"position:relative;\">5.2 바이너리 코어 덤프에서 자바 스택이나 힙 정보를 추출하는 방법<a href=\"#52-%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EC%BD%94%EC%96%B4-%EB%8D%A4%ED%94%84%EC%97%90%EC%84%9C-%EC%9E%90%EB%B0%94-%EC%8A%A4%ED%83%9D%EC%9D%B4%EB%82%98-%ED%9E%99-%EC%A0%95%EB%B3%B4%EB%A5%BC-%EC%B6%94%EC%B6%9C%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\" aria-label=\"52 바이너리 코어 덤프에서 자바 스택이나 힙 정보를 추출하는 방법 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"53-프로세스의-현재-작업-디렉터리를-확인하는-법\" style=\"position:relative;\">5.3 프로세스의 현재 작업 디렉터리를 확인하는 법<a href=\"#53-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%9D%98-%ED%98%84%EC%9E%AC-%EC%9E%91%EC%97%85-%EB%94%94%EB%A0%89%ED%84%B0%EB%A6%AC%EB%A5%BC-%ED%99%95%EC%9D%B8%ED%95%98%EB%8A%94-%EB%B2%95\" aria-label=\"53 프로세스의 현재 작업 디렉터리를 확인하는 법 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"54-프로르램에서-사용하는-공유-라이브러리-확인\" style=\"position:relative;\">5.4 프로르램에서 사용하는 공유 라이브러리 확인<a href=\"#54-%ED%94%84%EB%A1%9C%EB%A5%B4%EB%9E%A8%EC%97%90%EC%84%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EA%B3%B5%EC%9C%A0-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%ED%99%95%EC%9D%B8\" aria-label=\"54 프로르램에서 사용하는 공유 라이브러리 확인 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"55-프로세스-생성-관계-보기\" style=\"position:relative;\">5.5 프로세스 생성 관계 보기<a href=\"#55-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%83%9D%EC%84%B1-%EA%B4%80%EA%B3%84-%EB%B3%B4%EA%B8%B0\" aria-label=\"55 프로세스 생성 관계 보기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"56-프로세스의-수행-환경-확인\" style=\"position:relative;\">5.6 프로세스의 수행 환경 확인<a href=\"#56-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EC%9D%98-%EC%88%98%ED%96%89-%ED%99%98%EA%B2%BD-%ED%99%95%EC%9D%B8\" aria-label=\"56 프로세스의 수행 환경 확인 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>","fields":{"slug":"/ch4/","thumbnail":null},"frontmatter":{"date":"February 08, 2022","update":"Feb 08, 2022","title":"4부 - 프로세스 이해하기","description":null,"tags":["실무로 배우는 시스템 성능 최적화"],"thumbnail":null}},{"excerpt":"1. 기본 방향 2. HTTP의 이해 2.1 프로토콜 구조 기본적으로 클라이언트 서버 간에 요청과 응답이 1:1 구조를 띠고 있다. HTTP 요청/응답 모두 헤더와 본문으로 구성돼 있다. 2.2 HTTP 요청 요청은 헤더와 본문으로 나뉘고, 헤더는 다시 요청 라인과 MIME 헤더로 나뉜다. 요청 헤더 요청 방식으로는 8가지가 있다. , , , , , , …","html":"<h2 id=\"1-기본-방향\" style=\"position:relative;\">1. 기본 방향<a href=\"#1-%EA%B8%B0%EB%B3%B8-%EB%B0%A9%ED%96%A5\" aria-label=\"1 기본 방향 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h2 id=\"2-HTTP의-이해\" style=\"position:relative;\">2. HTTP의 이해<a href=\"#2-HTTP%EC%9D%98-%EC%9D%B4%ED%95%B4\" aria-label=\"2 HTTP의 이해 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"21-프로토콜-구조\" style=\"position:relative;\">2.1 프로토콜 구조<a href=\"#21-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%EA%B5%AC%EC%A1%B0\" aria-label=\"21 프로토콜 구조 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>기본적으로 클라이언트 서버 간에 요청과 응답이 1:1 구조를 띠고 있다.</li>\n<li>HTTP 요청/응답 모두 헤더와 본문으로 구성돼 있다.</li>\n</ul>\n<!-- more -->\n<h3 id=\"22-HTTP-요청\" style=\"position:relative;\">2.2 HTTP 요청<a href=\"#22-HTTP-%EC%9A%94%EC%B2%AD\" aria-label=\"22 HTTP 요청 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>요청은 헤더와 본문으로 나뉘고, 헤더는 다시 요청 라인과 MIME 헤더로 나뉜다.</li>\n<li><strong>요청 헤더</strong></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 요청 라인</span>\n<span class=\"token constant\">POST</span> <span class=\"token operator\">/</span>board<span class=\"token operator\">/</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">.</span>jsp <span class=\"token constant\">HTTP1</span><span class=\"token number\">.1</span>\n\n<span class=\"token comment\">// MIME 헤더</span>\n<span class=\"token literal-property property\">Accept</span><span class=\"token operator\">:</span> image<span class=\"token operator\">/</span>jpeg<span class=\"token punctuation\">,</span> \nAccept<span class=\"token operator\">-</span>Language<span class=\"token operator\">:</span> ko<span class=\"token operator\">-</span><span class=\"token constant\">KR</span>\nUser<span class=\"token operator\">-</span>Agent<span class=\"token operator\">:</span> Mozilla<span class=\"token operator\">/</span><span class=\"token number\">4.0</span>\nAccept<span class=\"token operator\">-</span>Encoding<span class=\"token operator\">:</span> gzip<span class=\"token punctuation\">,</span> deflate\n<span class=\"token literal-property property\">Connetion</span><span class=\"token operator\">:</span> Keep<span class=\"token operator\">-</span>Alive\n<span class=\"token literal-property property\">Host</span><span class=\"token operator\">:</span> www<span class=\"token punctuation\">.</span>lgcns<span class=\"token punctuation\">.</span>com\n<span class=\"token literal-property property\">Cookie</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">.</span>lgcns<span class=\"token punctuation\">.</span>eh<span class=\"token operator\">...</span><span class=\"token operator\">...</span><span class=\"token punctuation\">.</span></code></pre></div>\n<ul>\n<li>\n<p>요청 방식으로는 8가지가 있다.</p>\n<ul>\n<li><code class=\"language-text\">GET</code>, <code class=\"language-text\">POST</code>, <code class=\"language-text\">HEAD</code>, <code class=\"language-text\">DELETE</code>, <code class=\"language-text\">TRACE</code>, <code class=\"language-text\">OPTIONS</code>, <code class=\"language-text\">PUT</code>, <code class=\"language-text\">CONNECT</code></li>\n</ul>\n</li>\n<li>\n<p>요청 라인에는 URI 정보가 들어있다. <code class=\"language-text\">(/board/new.jsp)</code></p>\n<ul>\n<li>URI는 웹 서버에서 대상을 유일하게 인식할 수 있는 주소로서 콘텐츠의 위치와 명칭을 가르킨다.</li>\n</ul>\n</li>\n<li>HTTP 버전으로는 <code class=\"language-text\">1.1</code>, <code class=\"language-text\">1.0</code> 등이 있다.</li>\n</ul>\n<h4>MIME 헤더</h4>\n<ul>\n<li>원래 전자우편의 인코딩 방식을 설명하는 표준 포맷이다.</li>\n<li>MIME 헤더 정보는 <code class=\"language-text\">“명칭: 값”</code> 형태로 이루어져 있다.</li>\n<li>HTTP 공통 MIME 헤더</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>헤더</th>\n<th>설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Cache-Control</td>\n<td>캐시가 동작하는 조건을 지정하는 지시문이다.</td>\n</tr>\n<tr>\n<td>Connection</td>\n<td>클라이언트 웹 서버 간 네트워크 연결 시에 대한 Keepalive 여부를 지정한다.</td>\n</tr>\n<tr>\n<td>Date</td>\n<td>현재의 날짜와 시간을 표시</td>\n</tr>\n<tr>\n<td>Progma</td>\n<td>프락시에 대한 지시문으로 웹 서버에서는 무시된다.</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>HTTP 요청 전용 MIME 헤더</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>헤더</th>\n<th>설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Accept</td>\n<td>응답으로 받을 수 있는 MIME 타입을 지정한다. <em>/</em>는 모든 타입이 가능하다는 것을 의미</td>\n</tr>\n<tr>\n<td>Accept-Encoding</td>\n<td>클라이언트가 받을 수 있는 본문 인코딩 형태를 지정</td>\n</tr>\n<tr>\n<td>Accept-Language</td>\n<td>클라이언트가 우선적으로 지원하는 언어를 지정</td>\n</tr>\n<tr>\n<td>Authorization</td>\n<td>URI에 클라이언트가 데이터에 접근할 수 있는 권한을 제공한다.</td>\n</tr>\n<tr>\n<td>Cookie</td>\n<td>서버에서 설정한 소량 데이터가 사용자 PC에 저장되어 요청 간에도 해당 데이터를 서버 측면에서 공유할 수 있는 기능을 수행한다.</td>\n</tr>\n<tr>\n<td>Host</td>\n<td>호스트명과 URI의 포트 번호로 구성된다.</td>\n</tr>\n<tr>\n<td>If-Modified-Since</td>\n<td>URI가 이미 클라이언트 캐시에 있는 경우 해당 콘텐츠의 수정 시간을 서버에 보내서 웹 서버에서 클라이언트 캐시에 있는 콘텐츠 사용 여부를 판단할 수 있게 한다.</td>\n</tr>\n<tr>\n<td>If-Unmodified_Since</td>\n<td>If-Modified-Since와 반대로 동작한다.</td>\n</tr>\n<tr>\n<td>If-Match</td>\n<td>존거부로 요청하는 것을 의미하며, 특정 Entity tags와 매치되게 한다.</td>\n</tr>\n<tr>\n<td>If-None-Match</td>\n<td>If-Match와 반대로 동작한다.</td>\n</tr>\n<tr>\n<td>Referer</td>\n<td>요청된 URI를 참조하는 문서의 URI를 전달한다.</td>\n</tr>\n<tr>\n<td>Range</td>\n<td>요청된 URI에 해당하는 콘텐츠 전체를 받지 않고 범위를 지정해 일부분만 받을 때 사용한다.</td>\n</tr>\n<tr>\n<td>User-Agent</td>\n<td>클라이언트 브라우저에 대한 식별 정보를 전송한다.</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>본문</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">board_id</span><span class=\"token operator\">=</span><span class=\"token number\">12</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">op</span><span class=\"token operator\">=</span>list<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">index</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></code></pre></div>\n<h3 id=\"23-HTTP-응답\" style=\"position:relative;\">2.3 HTTP 응답<a href=\"#23-HTTP-%EC%9D%91%EB%8B%B5\" aria-label=\"23 HTTP 응답 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>HTTP 응답은 헤더와 본문으로 나뉘고, 헤더는 다시 응답 라인과 MIME 헤더로 나뉜다.</li>\n</ul>\n<h3 id=\"24-데이터-송수신\" style=\"position:relative;\">2.4 데이터 송수신<a href=\"#24-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%86%A1%EC%88%98%EC%8B%A0\" aria-label=\"24 데이터 송수신 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>HTTP에서는 요청/응답에 본문이 없는 경우 <code class=\"language-text\">CRLF</code>가 2번 연속 반복될 때까지 전문을 읽으면 된다.</li>\n<li>본문이 있는 경우에는 <code class=\"language-text\">Context-Length</code>나 <code class=\"language-text\">Chunked</code> 방식에 따라 본문 크기를 확인하고 데이터를 읽어낸다.</li>\n</ul>\n<h4>Context-Length 방식</h4>\n<ul>\n<li>헤더인 <code class=\"language-text\">Context-Length</code>에 본문의 크기를 바이트 단위로 기록해서 수신 측에서 본문의 크기를 알 수 있게 하는 방식이다.</li>\n<li>HTTP 헤더 정보를 만드는 시점에 본문 전체 크기를 알 수 있을 때 사용한다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Content-Encoding: <span class=\"token function\">gzip</span>\nContent-Length: <span class=\"token number\">14949</span> // 본문의 크기는 <span class=\"token number\">14949</span> 바이트</code></pre></div>\n<h4>Chunked 방식</h4>\n<ul>\n<li>Chunked 방식은 HTTP 헤더인 Transfer-Encoding이 Chunked 값을 가지고 있다.</li>\n<li>HTTP 헤더 생성 시점에 본문의 크기를 알 수 없을 때 사용하는 방식이다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">// 헤더\nTransfer-Encoding: chunked\n\n// 본문\n27B // 서브 블록 크기\n<span class=\"token punctuation\">{</span><span class=\"token string\">\"status\"</span><span class=\"token builtin class-name\">:</span> N <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span> <span class=\"token punctuation\">}</span>\n2B0 // 서브 블록 크기\n<span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n<span class=\"token number\">0</span> // 블록의 마지막</code></pre></div>\n<h2 id=\"3-화면-응답시간-모니터링\" style=\"position:relative;\">3. 화면 응답시간 모니터링<a href=\"#3-%ED%99%94%EB%A9%B4-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81\" aria-label=\"3 화면 응답시간 모니터링 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"31-화면-응답시간-모니터링-도구\" style=\"position:relative;\">3.1 화면 응답시간 모니터링 도구<a href=\"#31-%ED%99%94%EB%A9%B4-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81-%EB%8F%84%EA%B5%AC\" aria-label=\"31 화면 응답시간 모니터링 도구 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>Fiddler, Dynatrace AJAX Edition, HttpWatch, FireBug, IE 개발자 도구, 크롬 개발자 도구 등</li>\n</ul>\n<h3 id=\"32-인터넷-익스플로러-프로파일링\" style=\"position:relative;\">3.2 인터넷 익스플로러 프로파일링<a href=\"#32-%EC%9D%B8%ED%84%B0%EB%84%B7-%EC%9D%B5%EC%8A%A4%ED%94%8C%EB%A1%9C%EB%9F%AC-%ED%94%84%EB%A1%9C%ED%8C%8C%EC%9D%BC%EB%A7%81\" aria-label=\"32 인터넷 익스플로러 프로파일링 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"33-피들러\" style=\"position:relative;\">3.3 피들러<a href=\"#33-%ED%94%BC%EB%93%A4%EB%9F%AC\" aria-label=\"33 피들러 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"34-HTTP-분석-접근\" style=\"position:relative;\">3.4 HTTP 분석 접근<a href=\"#34-HTTP-%EB%B6%84%EC%84%9D-%EC%A0%91%EA%B7%BC\" aria-label=\"34 HTTP 분석 접근 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>화면 응답시간이 Timeline 내에서 표시된 요청의 처리시간과 일치하는지 확인한다.</li>\n<li>Timeline 중 특별히 처리시간이 긴 요청이 존재하는지 확인한다.</li>\n<li>각 요청에 대한 처리시간은 짧지만 요청 수 자체가 많아서 응답시간이 오래 걸리는지 확인한다.</li>\n<li>\n<p>Timeline 상에서 요청 처리 중간 중간 처리가 없이 비어있는 긴 시간이 있는지 확인한다.</p>\n<ul>\n<li>중간의 빈 부분은 자바스크립트를 로딩하거나 수행하는 시간일 확률이 높다.</li>\n</ul>\n</li>\n<li>요청 목록에서 응답 코드가 200인지 304 Not Modified인지 확인해 캐시가 정상적으로 동작하는지 확인한다.</li>\n<li>전체가 200 OK일 때의 전체 페이지 크기와 개별 요청의 콘텐츠 크기를 확인한다.</li>\n</ul>\n<h2 id=\"4-웹-기반-시스템-성능-개선\" style=\"position:relative;\">4. 웹 기반 시스템 성능 개선<a href=\"#4-%EC%9B%B9-%EA%B8%B0%EB%B0%98-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%84%B1%EB%8A%A5-%EA%B0%9C%EC%84%A0\" aria-label=\"4 웹 기반 시스템 성능 개선 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"41-화면-콘텐츠-구성\" style=\"position:relative;\">4.1 화면 콘텐츠 구성<a href=\"#41-%ED%99%94%EB%A9%B4-%EC%BD%98%ED%85%90%EC%B8%A0-%EA%B5%AC%EC%84%B1\" aria-label=\"41 화면 콘텐츠 구성 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>웹도 동적 컨텐츠나 서블릿 같은 애플리케이션 처리시간이 느린 경우가 많지만 이미지나 자바스크립트, CSS 같은 정적 콘텐츠 수가 많거나 크기나 커서 느린 경우도 있다.</li>\n<li>\n<p>화면 콘텐츠 구성 측면에서 접근하는 성능 개선은 크게 두 가지로 나뉜다.</p>\n<ul>\n<li>화면을 좀 더 간경하게 구성하거나 콘텐츠를 통합함으로써 콘텐츠 수를 줄인다.</li>\n<li>콘텐츠 크기를 줄임으로써 네트워크 전송시간을 개선하고 화면이 빠르게 로딩될 수 있게 한다.</li>\n</ul>\n</li>\n</ul>\n<h4>4.1.1 콘텐츠 수 축소</h4>\n<ul>\n<li>화면을 구성하는 콘텐츠 수가 많을수록 브라우저와 서버 간에 순차적으로 다운로드 하는 애플리케이션 턴이 많이 발생하여 성능 저하를 유발한다.</li>\n<li>\n<p>화면별 요청 수가 많을수록 응답 시간이 느리다.</p>\n<ul>\n<li>이미지를 이용한 화면 구성 최소화</li>\n<li>이미지 대신 CSS를 활용한다.</li>\n<li>맵을 이용한 URL 구성</li>\n<li>메뉴마다 개별 이미지를 사용하는 대신 한 개의 통합 이미지를 사용한다.</li>\n<li>이미지 스프라이트</li>\n<li>한 이미지 파일에 있는 여러 이미지를 개별 이미지 형태로 사용한다.</li>\n<li>자바 스크립트 통합</li>\n<li>자바스크립트 파일을 통합해 파일의 수를 줄임으로써 성능을 개선한다.</li>\n<li>사용하지 않는 콘텐츠 제거</li>\n<li>CSS나 자바스크립트에서 화면마다 사용되지 않는 부분은 제거하여 최적화한다.</li>\n</ul>\n</li>\n</ul>\n<h4>4.1.2 크기별 이미지 준비</h4>\n<ul>\n<li>큰 이미지를 작은 이미지로 변환하는 오버헤드로 CPU 자원과 시간이 소요된다.</li>\n<li>사진 목록 처럼 작은 이미지를 보여줄ㄷ 때는 해당 크기에 맞는 섬네일을 별로도 준비한다.</li>\n</ul>\n<h4>4.1.3 이미지 콘텐츠 파일의 크기 축소</h4>\n<ul>\n<li>파일 크기가 큰 이미지를 사용하기보다 품질을 조정해서 크기를 줄일 이미지를 사용한다.</li>\n</ul>\n<h4>4.1.4 CDN 사용</h4>\n<ul>\n<li>CDN은 웹 서비스 제공자가 웹 서버에 있는 정적 컨텐츠를 인터넷 서비스 제공자 측에 설치된 CDN 서버에 미리 저장해두고 사용자에게 최적 경로로 컨텐츠를 제공하는 기술이다.</li>\n<li>예를 들어, 사용자가 어떤 이미지를 다운로드 하기위해서는 서버 도메인명으로 IP 주소를 조회해 해당 서버로 접속하는 네트워크 연결이 선행돼야 한다.</li>\n<li>CDN을 이용하면 IP 주소 조회 서비스를 제공하는 대신 DNS 서버가 사용자가 위치한 지역에 가장 근접한 CDN 서버의 IP 주소를 보내준다.</li>\n<li>동적 컨텐츠 역시 동일한 도메인을 사용하게 되면 CDN을 경유하게 되므로 동적 컨텐츠, 정적 컨텐츠 도메인을 분리해야 한다.</li>\n</ul>\n<h4>4.1.5 텍스트 콘텐츠의 크기 축소</h4>\n<ul>\n<li>자바스크립트나 CSS 같은 텍스트 컨텐츠를 정리해서 크기를 줄여주는 도구를 사용한다.</li>\n</ul>\n<h4>4.1.6 압축 적용</h4>\n<ul>\n<li>압축은 CPU 위주의 작업이기 때문에 웹 서버 자원에 여유가 있고 전체 응답시간에서 네트워크가 자치하는 비중이 높은 경우에 사용하는 것이 바람직하다.</li>\n<li>압축 동작은 브라우저가 처리할 수 있는 압축 방식을 요청 헤더에 <code class=\"language-text\">Accept-Encoding: gzip, deflate</code>와 같이 담아서 서버로 전송한다.</li>\n<li>아파치, nginx 등 범용 웹 서버에서는 모두 지원한다.</li>\n</ul>\n<h4>4.1.7 웹 가속기</h4>\n<ul>\n<li>\n<p>웹 가속기는 웹 서버 앞에 위치해 사용자 브라우저와의 통신을 최적화하는 역활을 수행한다.</p>\n<ul>\n<li>콘텐츠 압축</li>\n<li>콘텐츠 캐시</li>\n<li>네트워크 연결 관리</li>\n<li>SSL 가속</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"42-캐시-동작\" style=\"position:relative;\">4.2 캐시 동작<a href=\"#42-%EC%BA%90%EC%8B%9C-%EB%8F%99%EC%9E%91\" aria-label=\"42 캐시 동작 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>4.2.1 브라우저 캐시</h4>\n<ul>\n<li>브라우저 캐시는 HTTP 응답 크기를 줄이는 방식과 HTTP 요청 수를 줄이는 방식이 있다.</li>\n</ul>\n<h4>HTTP 응답 크기를 줄이는 캐시 방식</h4>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/234db9bf06c41189fcf0f72b97e517f0/44982/img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.8235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVR42oVSy07DMBDs/38DCP6FHkCEPmhRbyBQL00gDzt24yT2sLNpeuGApZE3zu7s7NgLyIoxYhRwH4YBfd/jv8W8siy1JqWEJGeHtz0W8oXIg5Q00XsP1zqN0wUay/9xHAXxmtvUZiKTzzgmvG62QqjdRoTQa7cg6kIImti2LazAGIOmaVDXDRqJuy6gk5yqrGWaQRsNQ8TqOcOCJMX3N06nHNa2muzPZ01yotZai1OeI8+LibAxOHedKmXN+/sHfqSeU66yZyz4wxgLYwmjvlAZCc9CzJg2dEIyg6roM+tmD7lvVi+i8EJY60i1kgRRSUIjakjovENrp9GpmDlcPJv95L4lIdTsqJ1JyCIWdKFDURSoqkrHbGRcqufozKHP5U+ptz1jnWUkFPaY9MD7aUTn3HUUxmVZCXGtF0NBAy9B8Pn5hd1uj71g+bDE3c3tREhDmdAPvXpJVWwQ+qD+EWxE8DVwGlp1PB5xOBwUm80a93ckFMYxRSXl4igsmH25eoT051165y9vc1QB2dMjfgGQLgP5NDGLxwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/234db9bf06c41189fcf0f72b97e517f0/ca1dc/img.png\"\n        srcset=\"/static/234db9bf06c41189fcf0f72b97e517f0/e7570/img.png 170w,\n/static/234db9bf06c41189fcf0f72b97e517f0/f46e7/img.png 340w,\n/static/234db9bf06c41189fcf0f72b97e517f0/ca1dc/img.png 680w,\n/static/234db9bf06c41189fcf0f72b97e517f0/02d09/img.png 1020w,\n/static/234db9bf06c41189fcf0f72b97e517f0/9d567/img.png 1360w,\n/static/234db9bf06c41189fcf0f72b97e517f0/44982/img.png 1592w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Untitled</figcaption>\n  </figure></p>\n<ul>\n<li>정적 콘텐츠에 대해 HTTP 요청을 하면 웹 서버는 응답시 <code class=\"language-text\">Last-modified</code> 헤더 속성에 콘텐츠의 변경일자를 내려보낸다.</li>\n<li>이후 동일한 콘텐츠에 대해 브라우저가 HTTP 요청을 할 때는 브라우저 캐시에 저장된 해당 콘텐츠의 변경일자 정보를 <code class=\"language-text\">If-Modified-Since</code> 속성에 붙여서 웹 서버로 보낸다.</li>\n<li>웹 서버는 콘텐츠의 변경일자와 브라우저에 있는 콘텐츠 변경일자를 비교해 동일한 콘텐츠이면 브라우저 캐시를 사용하고 그렇지 않으면 새 콘텐츠를 다운로드 한다.</li>\n</ul>\n<h4>HTTP 요청 수를 줄이는 캐시 방식</h4>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"margin-bottom: 16px;\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c850fd228e2fdb2df7cb816205fe942f/d4fa6/img_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.588235294117645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+ElEQVR42oVSaW/TQBD1fwcJkEqBNpSiRlSBKqVtgqq0EWdLG1UEhEDiC0doaQ7HceIzvtaO7TxmJ7K4PrDSaMa74zdv5o3SOjpEeb2E5aXrqO1WoQ01+H6IWMTwvQCOM4Vp2rAdF7puIIoSZGlOPoYgS5IMcZzS94x8BuXDuxa2KhsorS6jefAEujaEYZj433GpgOd5HOf5HFmWsylfPn/CTrWC9bU7eP60Ace2EIYR5vM5XNcldib/LGOD4ul0SgA5deETo5gBZa4Elab0ehfY3nqIG9eu4rBRR+B7nDybzdh7BDDo96GqKiwq5jgOv1mWDSHiP2nPAWWoqahsPiDAK6jvPka/10cQBPxu00/dbo9N3ne+fmNgySgKQ1x8P8dgoHIHckxRJKCMxiNsVx9h5fYS9ut7GOsjTpAskiThtqQJIRAQSBRFfC9HcHrSwtGrY5ydvUG7/ZZYW1Amxhj1vR2s3LqJZ80GDXpKDMN/RJCsCpNHMvRJFCEiFsfzfKRpSoDmBM3GPjbulXBy/IJnZJkWPy6Achp2tjAZZxnfy6IzYvr7/GQtYjjBQaOG8v1VnL5+SSo7tG86t1i0GlKb0qdZxgovAINfKueFyrQ2hmmQujVslu/i4/s2rUxIAzYoWUDTNBKki8sfl+h0OtxWcf5em8J+Agu55NYpvsAcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"\"\n        src=\"/static/c850fd228e2fdb2df7cb816205fe942f/ca1dc/img_1.png\"\n        srcset=\"/static/c850fd228e2fdb2df7cb816205fe942f/e7570/img_1.png 170w,\n/static/c850fd228e2fdb2df7cb816205fe942f/f46e7/img_1.png 340w,\n/static/c850fd228e2fdb2df7cb816205fe942f/ca1dc/img_1.png 680w,\n/static/c850fd228e2fdb2df7cb816205fe942f/02d09/img_1.png 1020w,\n/static/c850fd228e2fdb2df7cb816205fe942f/9d567/img_1.png 1360w,\n/static/c850fd228e2fdb2df7cb816205fe942f/d4fa6/img_1.png 1598w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Untitled</figcaption>\n  </figure></p>\n<ul>\n<li>HTTP 요청 수를 줄이는 방식은 <code class=\"language-text\">Cache-Control</code> 속성을 이용해 HTTP 요청 자체를 하지 않도록 줄이는 방식이다.</li>\n<li><code class=\"language-text\">Cache-Control</code> 의 max-age 설정을 통해 응답디 내려간 이후 일정 시간(max-age:초) 동안 서버에 HTTP 요청 자체를 하지 않게 할 수 있다.</li>\n<li>HTTP 요청 수 자체를 줄여서 성능 개선 효과는 크지만 해당 콘텐츠가 변경되더라도 일정 시간 동안은 갱신할 수 없다는 문제가 있다.</li>\n</ul>\n<h3 id=\"43-병렬비동기-처리\" style=\"position:relative;\">4.3 병렬/비동기 처리<a href=\"#43-%EB%B3%91%EB%A0%AC%EB%B9%84%EB%8F%99%EA%B8%B0-%EC%B2%98%EB%A6%AC\" aria-label=\"43 병렬비동기 처리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>4.3.1 네트워크 연결 증가</h4>\n<ul>\n<li>브라우저는 한 페이지 내에서 한 도메인에 대해 네트워크 연결 개수가 제한돼 있다.</li>\n<li>따라서 콘텐츠를 동시에 내려받을 수 있는 병렬 처리 갯수에 한계가 있다.</li>\n<li>동일한 웹 서버에 대해 2개의 도메인을 구성하면 두 배까지 열 수 있다.</li>\n<li>하지만 웹 서버 내 작업 스레드를 증가시켜 스레드 부족을 유발할 수 있으므로 스레드 수 설정을 증가시킬 필요가 있다.</li>\n</ul>\n<h4>4.3.2 AJAX와 DOM을 이용한 비동기 처리</h4>\n<ul>\n<li>AJAX와 DOM을 효과적으로 이용하면 서버 부하 감소뿐 아니라 클라이언트 측면의 성능 개선도 가능하다.</li>\n<li>\n<p><strong>화면 내 일부분을 비동기 처리</strong></p>\n<ul>\n<li>통계 정보처럼 서버 처리시간이 길어지면 화면 전체가 늦게 완성됨으로써 성능 저하가 발생한다.</li>\n<li>해당 부분을 AJAX로 별도로 분리해서 비동기적으로 처리하면 응답 시간 개선에 도움이 된다.</li>\n</ul>\n</li>\n<li>\n<p><strong>트랜잭션의 비동기 분리</strong></p>\n<ul>\n<li>예전에는 목록 화면에서 한 건을 삭제하거나 새로 입력하면 목록 전체를 다시 조회해서 변경내역을 확인하는 것이 일반적</li>\n<li>현재는 입력, 수정, 삭제 같은 데이터 변경은 AJAX 로 처리하고, 목록에 변경하는 작업은 DOM 처리를 통해 수정한다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"44-기타-성능-개선\" style=\"position:relative;\">4.4 기타 성능 개선<a href=\"#44-%EA%B8%B0%ED%83%80-%EC%84%B1%EB%8A%A5-%EA%B0%9C%EC%84%A0\" aria-label=\"44 기타 성능 개선 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>CSS와 자바스크립트는 병렬 처리를 고려해서 배치한다.</li>\n<li>\n<p>CSS는 HEAD 태그에 기술한다.</p>\n<ul>\n<li>스타일시트가 BODY에 있으면 모든 CSS가 다운로드될 때까지 브라우저는 렌더링을 미룬다.</li>\n</ul>\n</li>\n<li>HTTP 요청은 하나의 패킷으로 처리한다.</li>\n<li>\n<p>HTML 안의 CSS와 자바스크립트는 개별 파일로 처리한다.</p>\n<ul>\n<li>HTML 렌더잉을 지연시켜 성능 저하가 유발된다.</li>\n</ul>\n</li>\n<li>이미지는 HTML에 크기를 명시한다.</li>\n<li>\n<p>HTML의 일부 내용은 먼저 전송되도록 처리한다.</p>\n<ul>\n<li>애플리케이션이 완료되기 전에 응답 일부를 HEAD에 CSS나 자바스크립트를 포함시킬 수 있다.</li>\n</ul>\n</li>\n<li>애플리케이션 응답시간이 긴 경우 진행표시줄을 사용한다.</li>\n<li>CSS에 <code class=\"language-text\">@import</code>를 사용하지 않는다.</li>\n</ul>\n<h3 id=\"45-웹-서버-설정\" style=\"position:relative;\">4.5 웹 서버 설정<a href=\"#45-%EC%9B%B9-%EC%84%9C%EB%B2%84-%EC%84%A4%EC%A0%95\" aria-label=\"45 웹 서버 설정 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>4.5.1 최대 병렬 처리수</h4>\n<ul>\n<li>애플리케이션 서버는 작업 스레드 풀을 필요 이상으로 크게 설정하면 DB 부하가 증가하고 애플리케이션 서버가 낼 수 있는 최대 성능을 넘어서는 동시 처리 요청이 들어오면 TPS는 증가하지 않으면서 응답시간만 증가한다.</li>\n<li>\n<p>반면 웹 서버는 CPU 자원에 대한 사용량보다는 네트워크 자원에 의존도가 높다.</p>\n<ul>\n<li>네트워크가 허용한다면 작업 스레드 수를 다소 높게 설정하는 편이 안정적이다.</li>\n</ul>\n</li>\n<li>웹 서버 스레드 풀 수를 설정할 때는 사용자 당 사용하는 스레드가 1개가 아니라는 점을 고려해야 한다.</li>\n<li>콘텐츠 수가 많으면 한번에 2~4개까지 웹 서버와 연결을 맺을 수 있다.</li>\n</ul>\n<h4>4.5.2 Keepalive</h4>\n<ul>\n<li>Keepalive 설정을 활성화하면 한 번 연 네트워크 연결을 반복 사용해 콘텐츠를 내려받을 수 있다.</li>\n<li>대부분 웹 서버에서는 기본적으로 Keepalive 가 활성화돼 있으며, nginx는 75초가 기본값이다.</li>\n<li>Keepalive는 성능 개선 요소지만 경우에 따라 성능을 악화시키는 요소로 작용하기도 한다.</li>\n<li>\n<p>아파치 웹 서버의 경우에는 Keepalive된 네트워크 연결 1개당 작업 스레드 1개씩 배정해서 작업한다.</p>\n<ul>\n<li>사용자가 다양하고 많은 환경에서 Keepalive를 높게 설정하면 웹 서비스를 처리 중인 스레드 수가 적더라도 Keepalive에 의해 여유 스레드 전체가 특정 사용자에 대해 대기하고 있는 상태가 될 수 있다.</li>\n<li>스레드풀에서 놀고 있는 스레드가 많더라도 해당 스레드 모두가 각기 담당하는 사용자 요청을 대기하고 있어 작업 배정이 안될 수 있다.</li>\n</ul>\n</li>\n<li>Nginx는 이벤트 드리븐 아키텍처로 논블럭킹 입출력을 사용하기 때문에 더 적은 프로세스로도 더 많은 사용자를 처리할 수 있다.</li>\n</ul>\n<h2 id=\"5-웹-서버-모니터링\" style=\"position:relative;\">5. 웹 서버 모니터링<a href=\"#5-%EC%9B%B9-%EC%84%9C%EB%B2%84-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81\" aria-label=\"5 웹 서버 모니터링 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"51-웹-요청-응답시간-모니터링\" style=\"position:relative;\">5.1 웹 요청 응답시간 모니터링<a href=\"#51-%EC%9B%B9-%EC%9A%94%EC%B2%AD-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84-%EB%AA%A8%EB%8B%88%ED%84%B0%EB%A7%81\" aria-label=\"51 웹 요청 응답시간 모니터링 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>애플리케이션 서버에 문제가 있었다면 해당 서버에서 서비스하는 URI에 집중적으로 성능 저하나 5xx HTTP 응답 코드가 타난다.</li>\n<li>웹 서버 마다 처리시간을 액세스 로그에 남기는 방법이 있다.</li>\n</ul>","fields":{"slug":"/ch3/","thumbnail":null},"frontmatter":{"date":"February 05, 2022","update":"Feb 05, 2022","title":"3부 - 화면 응답시간 분석","description":null,"tags":["실무로 배우는 시스템 성능 최적화"],"thumbnail":null}},{"excerpt":"1장. 기본 자세 적극적이고 도전적인 자세를 갖춰라 다른 사람의 설명과 의견에 귀 기울여라 종합적인 시각을 가져라 실행하고 비교하라 2장. 성능 분석 시작하기 클라이언트부터 시작해 웹 서버, 애플리케이션 서버, DB 서버 등 여러 서버를 거쳐서 동작한다. 이런 구성에서 성능 저하가 발생했을 땐 네트워크를 기준으로 각 서버가 전체 응답시간에서 차지하는 비중…","html":"<h2 id=\"1장-기본-자세\" style=\"position:relative;\">1장. 기본 자세<a href=\"#1%EC%9E%A5-%EA%B8%B0%EB%B3%B8-%EC%9E%90%EC%84%B8\" aria-label=\"1장 기본 자세 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>적극적이고 도전적인 자세를 갖춰라</li>\n<li>다른 사람의 설명과 의견에 귀 기울여라</li>\n<li>종합적인 시각을 가져라</li>\n<li>실행하고 비교하라</li>\n</ul>\n<!-- more -->\n<h2 id=\"2장-성능-분석-시작하기\" style=\"position:relative;\">2장. 성능 분석 시작하기<a href=\"#2%EC%9E%A5-%EC%84%B1%EB%8A%A5-%EB%B6%84%EC%84%9D-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0\" aria-label=\"2장 성능 분석 시작하기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>클라이언트부터 시작해 웹 서버, 애플리케이션 서버, DB 서버 등 여러 서버를 거쳐서 동작한다.</li>\n<li>이런 구성에서 성능 저하가 발생했을 땐 네트워크를 기준으로 각 서버가 전체 응답시간에서 차지하는 비중을 분석해 영향도가 큰 집중 분석 대상을 선정하는 것 이다.</li>\n<li>성능이 저하됐을 때 처리 지연이 발생한 위치가 대부분 시스템 내부인 경우가 많기 때문에 내부 처리시간이 사용자 체감 응답시간과 차이가 있는지 확인하는 것이 우선이다.</li>\n</ul>\n<h3 id=\"21-애플리케이션-서버-응답시간-분석\" style=\"position:relative;\">2.1 애플리케이션 서버 응답시간 분석<a href=\"#21-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%84%9C%EB%B2%84-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84-%EB%B6%84%EC%84%9D\" aria-label=\"21 애플리케이션 서버 응답시간 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>애플리케이션 서버 내부에서 세분화된 응답시간을 얻는 방법에는 세 가지가 있다.</p>\n<ul>\n<li><strong>APM</strong></li>\n<li>가장 손쉽게 직관적인 데이터 수집이 가능, 단 프로파일링 설정이 많으면 APM 자체가 성능 저하의 원인이 되기도 한다.</li>\n<li><strong>스택 수집</strong></li>\n<li>주기적으로 스택을 수십 회 이상 수집해서 분석하는 방법</li>\n<li>현재 통신 소켓을 읽거나 쓰고 있는 스택 하위에 있는 연계 인터페이스 메서드를 식별해 각 구성 요소 응답시간 비중을 분석할 수 있다.</li>\n<li><strong>프레임워크 로깅</strong></li>\n<li>프레임워크 내부에서 각 구성 요소에서 소요된 처리시간을 서비스 요청 단위로 로깅하는 기능을 포함시키는 것이다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"22-클라이언트-응답시간-분석\" style=\"position:relative;\">2.2 클라이언트 응답시간 분석<a href=\"#22-%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84-%EB%B6%84%EC%84%9D\" aria-label=\"22 클라이언트 응답시간 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>클라이언트단 단에서 사용자 응답시간을 분석할 때 다음과 같이 나눠서 분석한다.</p>\n<ul>\n<li><strong>클라이언트 처리시간, 네트워크 처리시간, 서버 처리시간 (+ DNS 룩업시간)</strong></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3장-상황별-분석-단계\" style=\"position:relative;\">3장. 상황별 분석 단계<a href=\"#3%EC%9E%A5-%EC%83%81%ED%99%A9%EB%B3%84-%EB%B6%84%EC%84%9D-%EB%8B%A8%EA%B3%84\" aria-label=\"3장 상황별 분석 단계 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"31-화면-응답시간-저하\" style=\"position:relative;\">3.1 화면 응답시간 저하<a href=\"#31-%ED%99%94%EB%A9%B4-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84-%EC%A0%80%ED%95%98\" aria-label=\"31 화면 응답시간 저하 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a257c0f22c42f5cc1249510c59efd084/f0e87/img.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACwUlEQVR42m1UaW/TUBD0v6/4LaAeaVNKPyABEg3QUJEeiZ3mrHP4dhwntuNj2HlpUihYWj0f+2Zn5u1aK4sKeV6iLCsAlayFRInXV1VVfz2X8lw9x2q1wiII8PHyA7ROR8ebgwPMZnMBzhHHMZIkUbFeJ0jTTNY1iqJAvsmRZdkLqBQuihKTyRSt1i3qtRq0IAjRbP5Umwg6n1vYbDZbgLxQgI7jwvd8DAdDuK6nvrPgcDiCLoTaD21ZDRy+ewttJUCO42G5jPHw0FERhgv4UiiKlrBtG+12B23Z4HkBFotIVk+xt6T4rTAbj8bwHAfnpyfQ0md5eZHD933FhFK2cgolcS3f4ySTnH+9dQSIjKMoxEX9FBrBfD9QxpI+g9K63Udhs1BW/HlIvE+S9d7vqfgXSp7vulvANEmxXkmCVGGCaU4wHI3EyzkGwzGm05kqxovFw5BWRKoQ2dFTT2I+m+HiTA4lTVPlCzcRjH654lEknpqTmTooQzfQ7/dhGIY8z5QVO0tM01SFFoGP89rxFlC1iZjMZMPoKqn0jj1GfwLpMeaQGd+Pn57QaHxD46qBz5++4Obml3gvh1I7grbJNiqx1WrhutnE16srfP9xDcuy977RFoITdOthAvPJVJIpnUUCAXxPQLYI26Mnknq9PkbjMfqDgWLB1iBQHK9UT3KzJ13gSl+yX+kz1XDKXAE/OzqExgRfJD32etDFI13X97LZm2RD2bvR40pwsmPDcwQLAXQcG/WToy0gR2duWSos21IF6C3Zc5JcaQmeJpUk6hAX4Mhy33K5RCwHStb1YzkU0i3El9fDT2Zk3X3sqTbixLCtCErmI3nnSCHasm0hATwRQNLPRBKBq/LlD1K+KrK7UzM/neLu7h73EhwK/qE8kXxxJoA7AFT47y/rJco9oG07irElFlF+JcV918bl+Sl+Awi2t75wSZrLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img\"\n        title=\"\"\n        src=\"/static/a257c0f22c42f5cc1249510c59efd084/ca1dc/img.png\"\n        srcset=\"/static/a257c0f22c42f5cc1249510c59efd084/e7570/img.png 170w,\n/static/a257c0f22c42f5cc1249510c59efd084/f46e7/img.png 340w,\n/static/a257c0f22c42f5cc1249510c59efd084/ca1dc/img.png 680w,\n/static/a257c0f22c42f5cc1249510c59efd084/02d09/img.png 1020w,\n/static/a257c0f22c42f5cc1249510c59efd084/9d567/img.png 1360w,\n/static/a257c0f22c42f5cc1249510c59efd084/f0e87/img.png 1554w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li><strong>클라이언트의 자원 사용량 확인</strong></li>\n<li>클라이언트 PC의 주요 자원이 화면을 테스트하는 데 영향을 줄 가능성이 있는지 확인한다.</li>\n<li>프로세스, 프로세스해커 등</li>\n<li><strong>사용자 접점 서버단 패킷 수집</strong></li>\n<li>성능 저하가 특정 사용자에게 발생하지만 사용자 PC에서 직접 모니터링이 불가능한 경우 서버단에서 클라이언트 응답시간을 분석하기 위해 패킷을 수집한다.</li>\n<li>tcpdump, 와이어샤크 등</li>\n<li><strong>클라이언트 응답시간 분석</strong></li>\n<li>클라이언트 응답시간을 클라이언트, 네트워크, 서버 세 구간으로 나눠서 분석한다.</li>\n<li><strong>클라이언트 원인 분석</strong></li>\n<li>클라이언트에서 소요되는 시간이 많은 경우 원인을 분석한다.</li>\n<li>클라이언트 스크립트 로직과 렌더링을 구분해서 분석</li>\n<li>콘텐츠 유형과 응답시간 상관관계 분석</li>\n<li>화면 처리 흐름으로 인한 애플리케이션 턴 수</li>\n<li>HTML 내 자바스크립트와 CSS에 의한 렌더링 영향도 분석</li>\n<li>클라이언트 로킹 영향도 확인</li>\n<li>클라이언트 캐시 동작 여부 확인</li>\n<li>콘텐츠 구성 방식과 크기</li>\n<li><strong>네트워크 원인 분석</strong></li>\n<li>전체 응답시간 중 네트워크에서 소요되는 시간이 많을 때 원인을 분석한다.</li>\n<li>전송 데이터 : 전송 데이터 크기, 콘텐츠 수, 전문 형태, 압축 여부</li>\n<li>통신 방식 : 프로토콜 네트워크 연결 유지 및 연결 수, 네트워크 턴 수</li>\n<li>통신 품질 : 패킷 왕복시간, 재전송, 전송 대역폭</li>\n</ol>\n<h3 id=\"32-시스템-내-응답시간-저하\" style=\"position:relative;\">3.2 시스템 내 응답시간 저하<a href=\"#32-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%82%B4-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84-%EC%A0%80%ED%95%98\" aria-label=\"32 시스템 내 응답시간 저하 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f86dcdbd8102f2a7cb6183223469de42/5e075/img_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.58823529411764%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACm0lEQVR42k1TW1PaQBjlx9eOiNr60GdnnP6CWl9sdYqXF7GtCiIDAYRggoQkkPsNTr+zkJnuzDeb7Ga/PbdUXNfB8fExOp0OONI0xWq1wv9jvV6rKoqV2uNzOav1PEP3pYUvR4eohGGARuMOuq5jOp1C0zT0+wOM9TF8z0cUhXBdF71eD6PRCEEQwPM8jF5HaDVb+PP7L26urvH15ARHB1VU1ls0PPTw8IDHxyc07u/x+PSE99kMcRTDcRx10duboRgUciaKIti2g/nchmlOcVWv4/PBHiqkkWa5ahqGIZIkUXTyPEccJ5uStTCM1LOQRCZ7pSzCWI22oP1UqwlCWcmLAkuhYds2HEFKWpY1x3K5VDK8tDt4Fbq9nsihDTCzLCxkLwxChXA4GODy5wUOa4JwpcQuFDpusiFpZVkG3/cVHWoWCXW+87I4jhUDVr/fR7PZxI/zc0EoGhJ6sYXPD0mHNNiUCE3TVE3IgheTIb9J5ULDMNHT+gJkjtuba1R3Pmw0zKX4ZSZahiI2UbK64my3q2H6/i7GuFgsloLWF7MsZWKr9SzVgimNLy8uUf24s6W8Wm8pFGomapqzoRkoU7jOUaLkOy8xDEMY+Gjc3WG/uotKIs6R0mQywXA4FARLQbKAJZFhRhkZmuG6C6UhadI8as4z1HDh2oLwArVqlZQLpZ0lzpXBLU3JslTljaH3lRmbCLGSJMVczozHOjzRul7/hX26zANExF+PxRuNtw0NNuYIBI363YQrJfIlLo6EWtcnaLdfMJGZCPeZw2LrXhkDomWjSIJMisyhwej4oRjGFBQCwJP1mTAaYyAZ1ESSs9Mz7O0KZYpfUiwRcXCdsSFdHqIcfE/TTGZPGfL83BZWXTV//3aKg1oN/wDDZhFzj4vBugAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img 1\"\n        title=\"\"\n        src=\"/static/f86dcdbd8102f2a7cb6183223469de42/ca1dc/img_1.png\"\n        srcset=\"/static/f86dcdbd8102f2a7cb6183223469de42/e7570/img_1.png 170w,\n/static/f86dcdbd8102f2a7cb6183223469de42/f46e7/img_1.png 340w,\n/static/f86dcdbd8102f2a7cb6183223469de42/ca1dc/img_1.png 680w,\n/static/f86dcdbd8102f2a7cb6183223469de42/02d09/img_1.png 1020w,\n/static/f86dcdbd8102f2a7cb6183223469de42/5e075/img_1.png 1338w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li><strong>애플리케이션 서버 응답시간 분석</strong></li>\n<li>서버 내 애플리케이션 프로세스를 대상으로 스택을 분석한다.</li>\n<li>예를 들어 사용자 요청을 처리 중인 스택이 총 100개이고 그중 64개가 SQL을 수행 중이고, 20개가 로그 라면 SQL은 65%, 로깅은 20% 비중을 차지하고 있다고 불 수 있다.</li>\n<li>클라이언트 응답이 느린데 애플리케이션 서버 응답이 빠르다면 채널단이나 웹 서버가 느린것으로 판단할 수 있다.</li>\n<li><strong>채널/웹 서버 원인 분석</strong></li>\n<li>웹 서버에서 애플리케이션 서버로 작업을 즉시 넘기지 못하는 원인을 찾는다.</li>\n<li>\n<p>서비스 스레드 부족 같은 병목 발생 여부를 확인하고, 웹 서버와 애플리케이션 서버 간 인터페이스 항목과 방식에 대해 분석을 진행한다.</p>\n<ul>\n<li>병목발생 : 큐잉 여부, 작업 중인 스레드 수, 접속 클라이언트 수, 웹 KeepAlive 여부와 설정 시간</li>\n<li>인터페이스 : 웹 서버와 애플리케이션 서버 간 동작 분석, 콘텐츠 유형별 서비스 담당 서버 확인, 일부 애플리케이션 서버가 비정상적으로 동작할 경우 웹 서버 서비스 분해 확인</li>\n</ul>\n</li>\n<li>netstat, jstack, pstack 등</li>\n<li><strong>DB 원인 분석</strong></li>\n<li>SQL 응답시간이 느린 원인을 분석한다.</li>\n<li>락 대기 유무, 실행계획, 수행 통계를 바탕으로 원인 분석</li>\n<li>동작 중인 세션 : 현재 SQL을 수행 중인 세션의 상태(대기 이벤트)</li>\n<li>락 대기 : 수행 중인 SQL 간 락 영향도를 확인(락 트리)</li>\n<li>실행계획 : 저성능 SQL의 실행계획 및 실행 통계 확인</li>\n<li>수행 통계 : DB 운영 통계</li>\n<li><strong>연계 서버 원인 분석</strong></li>\n<li>타 시스템 서비스를 호출하므로 이를 내부와 외부로 구분해 처리시간을 측정하는 것</li>\n<li><strong>애플리케이션 내부 원인 분석</strong></li>\n<li>애플리케이션 내부 코드에서 발생한 성능 저하 원인을 분석할 때는 수집된 스택이 핵심 자료다.</li>\n<li>병목 빌셍 : 스레드 풀, DB 연결 풀 상태(부족 여부 확인)</li>\n<li>불필요한 작업 : 로깅과 모니터링, 환경 반복 로딩 등</li>\n<li>비효율적인 로직 : 업무 로직, 탐색 로직, 날짜/수치 연산 로직, 문자열 처리 로직</li>\n<li>SQL 수행 패턴 분석 : 서비스당 SQL 수행 유형과 횟수, 바인딩 변수를 기준으로 한 반복 수행 여부 분석</li>\n<li>SQL 수행로그, jstack, pstack, SDPA(분석)</li>\n</ol>\n<h3 id=\"33-서비스-멈춤-현상\" style=\"position:relative;\">3.3 서비스 멈춤 현상<a href=\"#33-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%A9%88%EC%B6%A4-%ED%98%84%EC%83%81\" aria-label=\"33 서비스 멈춤 현상 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a91def52a64b8a7d6dd9ca20a89f813a/f7833/img_2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.52941176470587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC5UlEQVR42n1TW08aYRDl99dUWo3aSq218cHGkpI+2AS0vlTRVgR94H5ZYJf7HXZhl8vpmSGSPvVLJrvffjtnzpw5n+/syxl+XFxA1mKxwP/WcrncvK+WK91LzOceft/f43BvF77LqytcX1+jUqnCMAw02230+314nofZzIXjTNFud5DN5dHtdWHbNiaTCUzLQuwxjpubW4TDl/Bv+7G99Qo+wyjj8TGBaPQev26j+BOLwSC47TgYj8cEnRGoj2KpxP1E96vVavO9x6jXGwiFQtjxv4bPYaJUnE6nm+d8Pt9IIKDNZlPZV6tVDAYDSI78p0HgCVn/ZKd7b/3wSTWJf9fLzvPmbH8Aq1ZDvdFAp9PVAmvtVlpwuVwQ2EEkHMauMHTJpssko1xBrVYnS1urutTQ45m0JjEcjVXnEQFHo5G2KsV6vZ7qfRWJsOUtApJFp9tDvlDUhKH8zKEII9OqocUhySDGOoiaFhwOR6qn6GqapuaHgsE1oFCX9aKJsHL4FNBava7shLEs23a0XfkmLI1ymQOp6/u34FdquA2f6CTtidASMhDXdfWndqejZwIoDBvNlnYgOkq7xeKaoTzP6eeDnTfwyUHi6RnRuzvEEwm2ZdJ3bSRTKSQST8pA2s5ks3h4eCBog8WGyGYz9F8E0ds72i6Oo8B7vNsloFTrcnrJVBIlo6Rt246NXD6HdDqtVlos5lokl8spc89zOfE2UixqmlVYjM/Hhwjs78AnCeKtQrGoPhNA0ahSrcAiW7GEfMuSYYymb7ZaOlX5Pplw4sMBC2Vw+ukDAgcEFG3EX0/PzyhXyqqh5844GEe1fLFNf9AnyxbZT9aWcnk1eS6apjNpnBwJIO9ym2AVMpN205mM+lH2cjMkypxkPp9HQaJYQJbJyWQSqWSaw1h3lYjHcXZ6go+H+xxKb0D/VSh2k6BlamLxZtT18lsM8WO1amoR3fPeNjntDh0guSKXxbPvwXMcBw7wF6GRTNIiQJEQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img 2\"\n        title=\"\"\n        src=\"/static/a91def52a64b8a7d6dd9ca20a89f813a/ca1dc/img_2.png\"\n        srcset=\"/static/a91def52a64b8a7d6dd9ca20a89f813a/e7570/img_2.png 170w,\n/static/a91def52a64b8a7d6dd9ca20a89f813a/f46e7/img_2.png 340w,\n/static/a91def52a64b8a7d6dd9ca20a89f813a/ca1dc/img_2.png 680w,\n/static/a91def52a64b8a7d6dd9ca20a89f813a/02d09/img_2.png 1020w,\n/static/a91def52a64b8a7d6dd9ca20a89f813a/f7833/img_2.png 1348w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>프로세스가 멈춘 상태로 더 이상 사용자 요청을 처리하지 못하는 경우에도 자원 부족 여부를 먼저 확인한 후 애플리케이션 상태를 확인한다.</li>\n<li>서버 자원은 CPU 사용량과 메모리 스와핑 여부를 확인한다.</li>\n<li>DB 서버는 데이터 캐시 영역이 스왑 영역으로 내라가면 급격한 성능 저하가 발생한다.</li>\n<li>자바 프로세스는 연속 Full GC로 인해 멈춤 상태에 있을 수도 있으므로 GC 상태를 모니터링해야 한다.</li>\n<li>\n<p>자원에 문제가 없다면 애플리케이션 스택을 분석한다.</p>\n<ul>\n<li>락 영향도와 현재 수행중인 기능</li>\n<li>작업 스레드 소진 등</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"34-시스템-전반에-걸친-성능-개선\" style=\"position:relative;\">3.4 시스템 전반에 걸친 성능 개선<a href=\"#34-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%A0%84%EB%B0%98%EC%97%90-%EA%B1%B8%EC%B9%9C-%EC%84%B1%EB%8A%A5-%EA%B0%9C%EC%84%A0\" aria-label=\"34 시스템 전반에 걸친 성능 개선 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>전체 수행시간이 긴 애플리케이션과 SQL이 시스템 자원을 가장 많이 사용한다고 볼 수 있기에 개선 효과도 크게 나ㅏ난다.</li>\n<li>\n<p>애플리케이션과 SQL 모두 수행 빈도와 총 수행시간이라는 두 가지 측면에서 비중이 가장 높은 것부터 개선 가능성을 검토한다.</p>\n<ul>\n<li>응용 수행시간 총합 Top 10</li>\n<li>응숑 수행 횟수 Top 10</li>\n<li>SQL CPU 사용 총합 Top 10</li>\n<li>SQL 수행시간 총합 Top 10</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"35-서버-자원-사용량-확인\" style=\"position:relative;\">3.5 서버 자원 사용량 확인<a href=\"#35-%EC%84%9C%EB%B2%84-%EC%9E%90%EC%9B%90-%EC%82%AC%EC%9A%A9%EB%9F%89-%ED%99%95%EC%9D%B8\" aria-label=\"35 서버 자원 사용량 확인 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/19937ffa04f97bee030705d86783c417/51584/img_3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2ElEQVR42o1T227aQBT0H6e/0IcqqpSHUikNUe5RX/oBUZVKBaTmuYEkEBtiLuZqgw0GG7ANnp7Z4Kh960ory7tnz5kzM0dbr9fIH+fx6+4Om80G88UCE9fFdDrFdrsFV5qmYFwQBLAdR8VxRVEMR/7HkwkeKxV8+3oJLYoi3P64hWEYWEiydrsNVxI64zE8zwPvJ/KAicIwVDE8d10Pz7qOh8dHtFsd6NUazo8PoW131WYzHy+mqfZyuVQoojjCarXCcDTCYDhEIAmJlndxHMubGayOhfncR89q4+rsy2vCKFojSRJVvd8fYCqBLlHIZjszf6YSZO1nK4kTVZBdmI06rk6PoDFRxgmDHWeMXq+Hrmyr24Vt29K+o3hl27btvCUkpyNB33gxUSoUcPjpABrJXixCden7vtpBIFzJfySoeE6hWKDZaqkC8/lcnZnNluJ+Inw+lCs4y+eg2VKhWCihUCzi9/29VHtBfyBtT2eqFaIiagrB4htRPpGO1nLH85YUIVUt08D1ubQcChrTbMo2VbJu9xUJW6RtSAeTeWKjaB39wyMLUpg03aJt6rg82XHIB+RiOBzAsroihos4ibEUwmmhXr8vfFoIRX0iowuIti/nA+mGCBt6FZdKFOFp6k2VykTEYCpHz7GIUa9jJLxRad6RPwKg8dkuO5sJPQ2jiosT8eFSHlq9rqDoqUTcTM6uSLzt2Kp92odfTgZj3lQejtT/c62C/OFnaDQtxdANXSGhusFuItqdjjI6E1F9cpb5jisMlwqtrhv4fnOD0zwRShusxC9tkk0CNzljgYwO3mXzzaTkj6NKMUvFn5JQbJPuArLFfypdrdXw9FTFfbms5pXK+/5cTRF5pCC6zHKj3oDnTlB9KOP64ug1IStnVuB3ESxUy3xIW3ATbRZHm6xE5Y5loSO0cM5zuRwOPu5DkxT438Wa6V8+pK3Id1MmZu/dHvY/vMcfbHqqHx50YdAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img 3\"\n        title=\"\"\n        src=\"/static/19937ffa04f97bee030705d86783c417/ca1dc/img_3.png\"\n        srcset=\"/static/19937ffa04f97bee030705d86783c417/e7570/img_3.png 170w,\n/static/19937ffa04f97bee030705d86783c417/f46e7/img_3.png 340w,\n/static/19937ffa04f97bee030705d86783c417/ca1dc/img_3.png 680w,\n/static/19937ffa04f97bee030705d86783c417/02d09/img_3.png 1020w,\n/static/19937ffa04f97bee030705d86783c417/51584/img_3.png 1292w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"36-CPU-과다-사용-분석\" style=\"position:relative;\">3.6 CPU 과다 사용 분석<a href=\"#36-CPU-%EA%B3%BC%EB%8B%A4-%EC%82%AC%EC%9A%A9-%EB%B6%84%EC%84%9D\" aria-label=\"36 CPU 과다 사용 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d4e3d7ace404098e7493945dcddbde0e/248ed/img_4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.05882352941177%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChUlEQVR42k1Ty27TQBT1b7JE7NggvqKwQC2gCtqQBFCFhAQSoIpK0LKiixTyjuMkTuzYeTuJ837ayeHe6yTC0mjsmTln7j3nWImeHeHB/Xu4+n4Jfnzfl3m7BTabDY3tbmxobXvY4/ctrfP54BwNWlPCRPj40UPcXN+g0WzBNKvodnuYzxcECkj48GKxRL/fR6fjYDqZYr1eY7VayWVCTmc9fwMlcvYEL58/RT6fh1m1YFQMxONJdHs9Ac1mMwyHQ9iWjWKhiFw2h7JeRo/2XdfFcrncVS1lQwm9PsKb8xeo1epSmeN00Wq1hMjzfAF4nietzedzWSekkHDl4/Ek6MIP5FFCr4gwdApNK8jNPPi93W5jtV4R4UpAhmGgVNJFkmajiZpdg0PtTyYT+KzfnvBd5Bl+Xn2htkawLAsmAQ3DpNkUIANG47FIkk6lkcupSCRSiMX+oFAoYTafHUzhrpX30WNc/7gkMltIjHIFWr4AVVXJgA66To8MWUiL3P5gMMB0OhUJeOYOhJC+fa7wQ/QEt79/kW5t0ZErLGhF6LpOZF0iGAoRg1jbdDqNYrGE0Wgk1bO+0q4MIryIHCObSZCjnpByu2wMk7AJrjuQqjgu9XpDCPkyx3Fkf5/dzU5H5ePFKeq1qmwwIbfNevLNDBgQYY/cr1RMZLMqMpkscmqeNNUoOn3RjQk9HpQK5eunMBp1C25/IDpqmkZOmmg1m5K/MRni9l25yLZtOlsPzCO3WY59BpmUZ+Xb57eknUWjJrHQKTYcXm69SiDWirWN/41T4BPIpDNiGDvO4T6Eevco4fMT3MXuiEQlM8jdXB7JZIqMuiVQZhdkHP7l/8F7suD3DH7Rf+yXv8wE5EmGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img 4\"\n        title=\"\"\n        src=\"/static/d4e3d7ace404098e7493945dcddbde0e/ca1dc/img_4.png\"\n        srcset=\"/static/d4e3d7ace404098e7493945dcddbde0e/e7570/img_4.png 170w,\n/static/d4e3d7ace404098e7493945dcddbde0e/f46e7/img_4.png 340w,\n/static/d4e3d7ace404098e7493945dcddbde0e/ca1dc/img_4.png 680w,\n/static/d4e3d7ace404098e7493945dcddbde0e/02d09/img_4.png 1020w,\n/static/d4e3d7ace404098e7493945dcddbde0e/248ed/img_4.png 1268w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li><strong>특정 프로세스 CPU 과다 사용 작업 분석</strong></li>\n<li>특정 프로세스가 CPU를 많이 사용하게 만드는 기능과 소스코드를 식별해 개선 가능성을 검토한다.</li>\n<li><strong>시스템 CPU 과다 사용 작업 분석</strong></li>\n<li>CPU를 조금씩 사용하는 프로세스가 많이 모여서 CPU 사용률이 높은 경우에는 perf, caliper 와 같은 CPU 프로파일링 도구를 사용해 시스템 전반적으로 CPU를 많이 사용하는 라이브러리 함수를 식별할 수 있다.</li>\n<li><strong>SQL 개선 가능성 검토</strong></li>\n<li>SQL 튜닝 : 실행계획 검토(사용 블록 감소), 통계 생성</li>\n<li>DB 튜닝 : DB 캐시, 테이블 입출력 분산, 동시 트랜잭션 확대</li>\n<li>애플리케이션 튜닝 : 불필요한 수행 제거, 조회 결과 캐시, SQL 통합</li>\n<li>오렌지 같은 SQL 튜닝 도구</li>\n</ol>\n<h3 id=\"37-메모리-과다-사용-분석\" style=\"position:relative;\">3.7 메모리 과다 사용 분석<a href=\"#37-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EA%B3%BC%EB%8B%A4-%EC%82%AC%EC%9A%A9-%EB%B6%84%EC%84%9D\" aria-label=\"37 메모리 과다 사용 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8686ac2e57274e004ee057e99feb79b5/aaa27/img_5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfElEQVR42k1Ti7aaMBDk/3/i9hfafkLrWy9XxQcqKoi8FASrKIpOd2K15pw9CSE7mZ2daK7r4ueP79hut+C43W643+9qzflyueB0OqnguixLXK9XtX4Onj4XV8xmM2jTyRTfPj5gWXPs93/gOI6AxwijDbZxrIAIcj6fEcme5/lYuWuYpqlyplMLju0gP50xGo2hbeMEI3OCVquDWq2BdudTQsfvShWmXHYRNhyHwxHD4QjdXh8DmT91Hc1mG9VqDR3JOeUnjGVfI/WiKBSLWBhFm40CKaX08q38pwSUJNntsFza8IMQvu8jSRIpucBwMIDGn5mUSiAy4O1rz3tp9A5IsMPhgPV6DXfl4ng8vs4VxQVGvw+Nm0xi8KYgCCTxP8g7uyc2tQ6FHc+xQcQ45jn6vS4BcykhVZtpmqqyyYIHnxc9B6XY7/eqObFov5PqmM818/q9HjQm80ZqECc8lKoy3oHeS76WVwUURdHj+1qqSJIdel/6g2GWZUglVqLLYrFQt4WS4ImWcRK/5PADH7azEp2HMKQBtIk5mcAVG5GI3ulAy6V2W7w3HA3RardQqVZRq9dRrzegizUsy1Ls2IiZrI3BEPpXV9mr1WrDMAbiyQl2aYZ2s/UAnM0szBdzjMWsfcMQs86E6VJ1OwhDBUg3BGGk2HhiFd8PFGvqfhD9aXy93RQN+VGckQplR8phubm8DnqTa76MucgwEZPP53MJC3yufKr07qthlwLdTuNhmyzbi4ap0m8jfmSjuM9E27ZVSeOxqWZ6ldpxn6Msbyr4RBu1CrT7v8fNIAhv5k/aJhRPUjvqyCDD5VKkWHuqXDbrAVjK08vRqPzCX5PrGst++muVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img 5\"\n        title=\"\"\n        src=\"/static/8686ac2e57274e004ee057e99feb79b5/ca1dc/img_5.png\"\n        srcset=\"/static/8686ac2e57274e004ee057e99feb79b5/e7570/img_5.png 170w,\n/static/8686ac2e57274e004ee057e99feb79b5/f46e7/img_5.png 340w,\n/static/8686ac2e57274e004ee057e99feb79b5/ca1dc/img_5.png 680w,\n/static/8686ac2e57274e004ee057e99feb79b5/02d09/img_5.png 1020w,\n/static/8686ac2e57274e004ee057e99feb79b5/aaa27/img_5.png 1316w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"38-디스크-과다-사용-분석\" style=\"position:relative;\">3.8 디스크 과다 사용 분석<a href=\"#38-%EB%94%94%EC%8A%A4%ED%81%AC-%EA%B3%BC%EB%8B%A4-%EC%82%AC%EC%9A%A9-%EB%B6%84%EC%84%9D\" aria-label=\"38 디스크 과다 사용 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b6884c80ef715731b32cbaf1bd83b87c/5b89d/img_6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACWElEQVR42n1Tx44TURCcD0dCAsSFGxcuK6I4rEAiHBBojyBj2R7HwdnjwHqcx2HGYYJddPXYCyee1Hr9Und1dT3jzYunePjgHkbOb3Acj0ccTyeEUYQ4jpN1fNQz2T7Pp/MZ7aR3YrkTR0cYV8+e4PGj+5hNp4gkyGKxwHQ6w2q1wnq9xnDoYDyewPe3iCRIGEYIggDn0JokSZCY8eXzaxTMH3q83+8l2BSj8RhLdynBhigWSiiXLXTtLjaep0kmkykOh8PfigQl0UVE+PH9c7y7fotsNod8Po9CvoCc+I7j6IPdbidBNoqi3+sjb+Zh5kyk02mY4luVigIhUg349dNL1KpFLcm5HWI2m2G5XGogBqERBYfn+XBdV+7McSt3XamC6yiKz6VDEF5fwRn2ERwC4XGml1gOjZkvTfB9XxvB/W63i2azia2AiCXZerXWsjmk5FfC2xibjSfcTGTenB8G2G13uAxyF4ah2lg4JiWBBOeaDeQbJjZuvn3QzcujwWCAfn+ATqeDer0haHqayJOGzOcL9UejkTaPPve2220iGzEj9f3mDgUvFYslZDJZFApF9U3TFL5ulVuWyaaxgeVyWayCRqMJX7hlyaFwaVjlzB1P/xtEXyqVkEr91EQMrElFVr6XcKldtkom7E5PDygDPmCZF8EyM2eKnnTUqjXUanWRi6U+G0T0F3Ebg56tMiBvCXe2/hRKgUH4MzhTMu12G5b1S0ulVatVtFstuAs3EbeY4S7m/yg+sSgKVR6Uks7y1ViyIz/HloRsVksC2bate54o5DL+ALVbzJmrj8lPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img 6\"\n        title=\"\"\n        src=\"/static/b6884c80ef715731b32cbaf1bd83b87c/ca1dc/img_6.png\"\n        srcset=\"/static/b6884c80ef715731b32cbaf1bd83b87c/e7570/img_6.png 170w,\n/static/b6884c80ef715731b32cbaf1bd83b87c/f46e7/img_6.png 340w,\n/static/b6884c80ef715731b32cbaf1bd83b87c/ca1dc/img_6.png 680w,\n/static/b6884c80ef715731b32cbaf1bd83b87c/02d09/img_6.png 1020w,\n/static/b6884c80ef715731b32cbaf1bd83b87c/9d567/img_6.png 1360w,\n/static/b6884c80ef715731b32cbaf1bd83b87c/5b89d/img_6.png 1410w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"4개선-방향성\" style=\"position:relative;\">4.개선 방향성<a href=\"#4%EA%B0%9C%EC%84%A0-%EB%B0%A9%ED%96%A5%EC%84%B1\" aria-label=\"4개선 방향성 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>병렬/분산 처리</li>\n<li>비동기 처리</li>\n<li>캐시</li>\n<li>집합 처리</li>\n<li>오버헤드 제거</li>\n<li>경합 제거</li>\n<li>SQL 개선</li>\n<li>송수신 효율화</li>\n<li>자원 사용 효율화</li>\n<li>물리적인 자원 증설</li>\n</ul>","fields":{"slug":"/ch2/","thumbnail":null},"frontmatter":{"date":"February 04, 2022","update":"Feb 04, 2022","title":"2부 - 성능 개선","description":null,"tags":["실무로 배우는 시스템 성능 최적화"],"thumbnail":null}},{"excerpt":"1. 성능이란? 고객의 특정 업무를 대상으로 운영환경하에서 고객이 수긍할 수 있는 응답시간 내에 처리할 수 있는 거래량이라고 정의할 수 있다. 1.1 동시 사용자 성능 테스트나 운영 시 시스템에 발생하는 부하의 의미로 많이 사용되는 용어가 바로 동시 사용자다. 동시 사용자에 대한 정의는 개발자와 업무담당자간에 다르게 해석할 수 있다. 동시에 시스템에 트랜…","html":"<h2 id=\"1-성능이란\" style=\"position:relative;\">1. 성능이란?<a href=\"#1-%EC%84%B1%EB%8A%A5%EC%9D%B4%EB%9E%80\" aria-label=\"1 성능이란 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>고객의 특정 업무를 대상으로 운영환경하에서 고객이 수긍할 수 있는 응답시간 내에 처리할 수 있는 거래량이라고 정의할 수 있다.</li>\n</ul>\n<!-- more -->\n<h3 id=\"11-동시-사용자\" style=\"position:relative;\">1.1 동시 사용자<a href=\"#11-%EB%8F%99%EC%8B%9C-%EC%82%AC%EC%9A%A9%EC%9E%90\" aria-label=\"11 동시 사용자 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>성능 테스트나 운영 시 시스템에 발생하는 부하의 의미로 많이 사용되는 용어가 바로 동시 사용자다.</li>\n<li>\n<p>동시 사용자에 대한 정의는 개발자와 업무담당자간에 다르게 해석할 수 있다.</p>\n<ul>\n<li>동시에 시스템에 트랜잭션을 유발시키는 사용자</li>\n<li>시스템과 접속을 유지하고 있는 사용자 수</li>\n</ul>\n</li>\n<li>동시 사용자 수 = 요청 사용자 수 + 비요청 사용자 수</li>\n</ul>\n<h3 id=\"12-처리량\" style=\"position:relative;\">1.2 처리량<a href=\"#12-%EC%B2%98%EB%A6%AC%EB%9F%89\" aria-label=\"12 처리량 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>처리량은 서버가 일정 시간 내에 처리한 트랜잭션의 양이다.</li>\n<li>\n<p>서버가 인식하는 트랜잭션 양과 사용자가 인식하는 트랜젹션 양은 다르다.</p>\n<ul>\n<li>고객 입장에서는 화면 조회라는 1개의 트랜잭션을 보낸다.</li>\n<li>서버 입장에서는 API, DB, 웹 등 여러 쿼리 호출이 발생한다.</li>\n</ul>\n</li>\n<li>성능에서 중요한건 고객의 업무를 얼마나 빨리 처리할 수 있는가다.</li>\n<li>따라서 처리량의 평가 단위로서 TPS(Transaction Per Second)의 T는 고객의 업무 처리 건수가 되는 것이 의사소통이나 평가 하는데 적합하다.</li>\n</ul>\n<h3 id=\"13-응답시간\" style=\"position:relative;\">1.3 응답시간<a href=\"#13-%EC%9D%91%EB%8B%B5%EC%8B%9C%EA%B0%84\" aria-label=\"13 응답시간 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>응답시간은 요청한 후부터 응답을 받을 때까지 소요된 시간으로 츠겆ㅇ하는 위치에 따라 여러 유형으로 나뉜다.</p>\n<ul>\n<li>클라이언트 응답 시간</li>\n<li>사용자가 요청한 후 부터 화면에 응답이 나타날 때까지 경과된 시간, 클라이언트 내부 처리시간도 포함된다.</li>\n<li>네트워크 응답 시간</li>\n<li>클라이언트에서 요청이 네트워크로 전송된 후부터 응답이 클라이언트 네트워크에 도착하는 데까지 경과되는 시간을 으미한다.</li>\n<li>서버 응답 시간</li>\n<li>서버가 사용자 요청을 받은 후 부터 처리 결과를 내보는는 데까지 경과된 응답시간이다. APM 기반으로 측정하는 경우가 여기에 해당된다.</li>\n<li>연계 응답 시간</li>\n<li>서버 처리 중 외부 시스템과 연계해서 처리할 경우 연계 서버에 요청을 보내 응답을 받기까지 경과된 시간이다.</li>\n</ul>\n</li>\n<li>\n<p>응답시간을 산술 평균으로 계산한다면 정확한 분석이 어려워 보통 백분율 응답시간을 사용한다.</p>\n<ul>\n<li>측정시간 동안 200개의 트랜잭션이 발생했고, 가장 응답시간이 빠른 것부터 줄세워 180등을 기록한 트랜잭션의 응답시간이 3.5였다면, 해당 업무의 90% 응답시간은 3.5초가 된다. <code class=\"language-text\">p90</code></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"14-자원\" style=\"position:relative;\">1.4 자원<a href=\"#14-%EC%9E%90%EC%9B%90\" aria-label=\"14 자원 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>서버의 CPU, 메모리, 디스크, 네트워크, WAS의 스레드 풀, DB연결 풀, 힙 메모리, 프로세스 수, 오픈 가능한 커서 수, 공유 캐시 메모리 등 물리적인 자원부터 소프트웨어 설정값까지 다양한 자원이 있다.</li>\n<li>성능 측면에서 자원은 한정된 값을 가진 시스템 구성 요소 중 애플리케이션이 동작할 때 사용하며, <code class=\"language-text\">부족한 경우\n나 사용량 변화에 따라 성능에 영향을 미치는 요소</code>를 의미한다.</li>\n</ul>\n<h4>1.4.1 적정성</h4>\n<ul>\n<li>자원 사용량에 대한 목표 달성과 부족 여부를 확인하는 것이다.</li>\n<li>자원이 부족한 경우 경함과 대기가 발생해 성능이 저하되므로 늘려줘야 하지만 다른 자원에 악영향을 주어 개선 효과를 보지 못할 수도 있다.</li>\n</ul>\n<h4>1.4.2 효율성</h4>\n<ul>\n<li>동일한 TPS를 기준으로 할 때 CPU나 메모리를 적게 사용하는 시스템이 효율적으로 작업을 수행한 것 이다.</li>\n<li>DB 사용량을 줄이고 애플리케이션 코드의 수행시간을 줄여 시스템 자원을 더 적게 사용하도록 개선함으로써 효율성을 높인다.</li>\n</ul>\n<h4>1.4.3 안정성</h4>\n<ul>\n<li>시스템 운영시간이 지남에 따라 성능이 저하되거나 장애가 발생하는 등의 문제가 발생하지 않아야 한다.</li>\n</ul>\n<h4>1.4.4 가용성</h4>\n<ul>\n<li>일정 기간 동안 시스템이 정상적으로 서비스된 시간 비율을 의미한다.</li>\n<li>카드 승인 시스템 같은 시스템은 장애는 사업 기회의 손실로 이어지므로 100%에 가까운 가용성을 유지해야 한다.</li>\n</ul>\n<h4>1.4.5 확장성</h4>\n<ul>\n<li>확장성은 향후 시스템 사용량 증가에 따라 시스템 증설이 필요할 때 각 자원이 얼마나 용이하게 증설될 수 있는가를 평가하는 것 이다.</li>\n</ul>\n<h2 id=\"2-성능-특성\" style=\"position:relative;\">2. 성능 특성<a href=\"#2-%EC%84%B1%EB%8A%A5-%ED%8A%B9%EC%84%B1\" aria-label=\"2 성능 특성 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"21-성능-곡선\" style=\"position:relative;\">2.1 성능 곡선<a href=\"#21-%EC%84%B1%EB%8A%A5-%EA%B3%A1%EC%84%A0\" aria-label=\"21 성능 곡선 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"22-성능에-대한-이해\" style=\"position:relative;\">2.2 성능에 대한 이해<a href=\"#22-%EC%84%B1%EB%8A%A5%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%B4%ED%95%B4\" aria-label=\"22 성능에 대한 이해 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>성능은 업무와 시스템 특성에 따라 다르게 나타난다.</p>\n<ul>\n<li>시스템에 A,B 두 업무가 있다고 가정할 때 각 업무의 비중이 10%,90% 일 때와 90%,10% 일 때 시스템의 최대 성능과 응답시간이 다를 것이다.</li>\n<li>따라서 시스템의 성능을 이야기할 때는 업무의 고유한 특성과 시나리오하에서만 논의할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>모든 시스템에 일괄 적용할 수 있는 응답시간 기준은 없고 100% 만족시킬 수도 없다.</p>\n<ul>\n<li>화면 구성이 비슷하더라도 업무의 성격에 따라 처리하는 데이터의 양과 로직의 복잡도가 달라진다.</li>\n</ul>\n</li>\n<li>\n<p>동시 사용자 수가 시스템 성능을 의미하는 것은 아니다.</p>\n<ul>\n<li>웹 기반 시스템에서는 동시 사용자(접속자) 수 보다 초당 들어오는 요청의 수, 웹 서버에 물리적으로 맺어진 네트워크 연결 수가 성능에 더 큰 영향을 준다.</li>\n</ul>\n</li>\n<li>\n<p>시스템 성능은 비용과 수익으로 평가할 수도 있다.</p>\n<ul>\n<li>시스템 자원 부족으로 서버를 추가 도입하거나 부족한 자원을 증설하기 위해서는 비용이 든다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-성능-이론\" style=\"position:relative;\">3. 성능 이론<a href=\"#3-%EC%84%B1%EB%8A%A5-%EC%9D%B4%EB%A1%A0\" aria-label=\"3 성능 이론 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"31-기초-성능-이론\" style=\"position:relative;\">3.1 기초 성능 이론<a href=\"#31-%EA%B8%B0%EC%B4%88-%EC%84%B1%EB%8A%A5-%EC%9D%B4%EB%A1%A0\" aria-label=\"31 기초 성능 이론 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"32-사용률-이론\" style=\"position:relative;\">3.2 사용률 이론<a href=\"#32-%EC%82%AC%EC%9A%A9%EB%A5%A0-%EC%9D%B4%EB%A1%A0\" aria-label=\"32 사용률 이론 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"33-비율-분석\" style=\"position:relative;\">3.3 비율 분석<a href=\"#33-%EB%B9%84%EC%9C%A8-%EB%B6%84%EC%84%9D\" aria-label=\"33 비율 분석 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h2 id=\"4-성능-테스트\" style=\"position:relative;\">4. 성능 테스트<a href=\"#4-%EC%84%B1%EB%8A%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8\" aria-label=\"4 성능 테스트 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"41-성능-테스트-유형\" style=\"position:relative;\">4.1. 성능 테스트 유형<a href=\"#41-%EC%84%B1%EB%8A%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%9C%A0%ED%98%95\" aria-label=\"41 성능 테스트 유형 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"42-성능-테스트-구성-요소\" style=\"position:relative;\">4.2 성능 테스트 구성 요소<a href=\"#42-%EC%84%B1%EB%8A%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B5%AC%EC%84%B1-%EC%9A%94%EC%86%8C\" aria-label=\"42 성능 테스트 구성 요소 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h3 id=\"43-성능-테스트-시-주의사항\" style=\"position:relative;\">4.3 성능 테스트 시 주의사항<a href=\"#43-%EC%84%B1%EB%8A%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%8B%9C-%EC%A3%BC%EC%9D%98%EC%82%AC%ED%95%AD\" aria-label=\"43 성능 테스트 시 주의사항 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>성능 테스트는 통상 제약된 환경에서 테스트하므로 실제 운영 시스템 대상으로 테스트를 진행했더라도 운영에 들어가면 예상치 못한 장애가 발생하기도 한다.</li>\n</ul>\n<h4>4.3.1 테스트 데이터</h4>\n<ul>\n<li>\n<p>테스트 데이터에 따라 확연히 다른 결과가 나오는 경우도 많기 때문에 성능 테스트 시에는 테스트 데이터에 대해 다음과 같은 사항을 고려해야 한다.</p>\n<ul>\n<li><strong>시스템 데이터(데이터 대상 DB)</strong></li>\n<li>통상 전체 성능의 70% 이상이 DB에 자우되는데, 테스트 대상이 되는 테이블의 데이터 양이나 패턴이 다르면 쿼리의 실행계획이 달라져 성능이 다르게 나타난다.</li>\n<li>데이터가 소량이면 실제 디스크 입출력이 일어나야 하는데 모두 메모리에 로드되어 성능이 빠른 것으로 착각할 수 있다.</li>\n<li>원칙적으로 성능 테스트는 실 데이터가 전환된 데이터베이스를 대상으로 수행해야 한다.</li>\n<li><strong>스크립트 데이터(입력용 데이터)</strong></li>\n<li>소량의 스크립트 데이터를 사용한 경우 테스트 초기 입력 데이터가 DB에 메모리에 캐시됨으로써 성능이 좋게 나올 수 있다.</li>\n<li><strong>초기 데이터 제로 테이블</strong></li>\n<li>시스템을 오픈할 때 비어있는 테이블은 시간이 지나면서 성능 문제를 일으키는 경우가 많다.</li>\n<li>초기 건수가 0이지만 운영하면서 건수가 큰 폭으로 증가하는 테이블은 데이터가 쌓여있을 때의 통계정보로 테이블 통계정보를 변경해 달라고 요청해야 한다.</li>\n</ul>\n</li>\n</ul>\n<h4>4.3.2 화면 처리시간</h4>\n<ul>\n<li>대부분의 성능 테스트 도구는 클라이언트 측 네트워크 시간을 기준으로 응답시간을 측정한다.</li>\n<li>클라이언트마다 PC 환경이 다르고, 테스트 환경에서는 클라이언트에서 수행되는 로직이 동작할 경우 CPU 등 자원부족으로 성능 측정이 부정확하게 되기 때문이다.</li>\n<li>중요 화면에 대해서는 화면 응답시간을 측정해 성능 기준 만족 여부를 평가하고, 서버 처리시간과 비교 분석해 클라이언트 성능 개선이 필요한지 여부를 판단한다.</li>\n</ul>\n<h4>4.3.3 네트워크</h4>\n<ul>\n<li>성능 테스트 시 부하 발생기가 연결돼 있는 스위치를 바로 백본 스위치에 연결해 테스트를 수행하는 경우가 많다.</li>\n<li>이는 내부 네트워크와 서버 중심으로 처리시간을 측정하고, 외부 네트워크는 제외하는 것 이다.</li>\n<li>서버 문제가 없음에도 네트워크 지연으로 애플리케이션 종료가 지연되어 작업 프로세스나 스레드 풀이 소진되어 큐잉이 발생함으로써 전체 사용자가 성능 저하를 경함할 수 있다.</li>\n</ul>\n<h4>4.3.4 가상 사용자 특성</h4>\n<ul>\n<li>실사용자라면 응답이 20~30초씩만 늦어져도 기다리지 못하고 다시 반복요청한다.</li>\n<li>즉 성능 테스트하에서는 특정 가상 사용자 수 이상 큐잉이 발생할 가능성은 낮지만 운영 환경에서는 동일 사용자에 의한 서비스 반복 요청이 이뤄져 대량의 큐잉이 발생할 수 있다.</li>\n<li>테스트 환경에서만 발생하는 패턴임에도 실제 환경에서도 발생하는 패턴으로 인식해버릴 수도 있다.</li>\n</ul>\n<h4>4.3.5 업무 시나리오</h4>\n<ul>\n<li>각 테스트 대상 업무에서 부수적인 서비스 호출을 제외하고 중요 서비스 호출만 시나리오에 포함시키면 운영 시 측정한 성능과 테스트 시 측정한 성능이 달라질 수 있다.</li>\n<li>부하 발생기가 일으키는 서비스 요청 이외에 백엔드에서 수행되는 배치나 후속 작업들을 생략하는 것이다.</li>\n<li>성능 측정 대상으로서 중요성은 떨어지더라도 정상적인 운영 시 시스템 백엔드에서 일정하게 발생하는 부하가 있다면 성능 테스트 시나리오에 포함해야 한다.</li>\n</ul>\n<h4>4.3.6 대상 업무와 성능 개선</h4>\n<ul>\n<li>자바 기반 애플리케이션의 경우 한 개의 업무에서 발생한 메모리 누수나 대량 데이터 조회 문제로도 전체 업무에 성능 저하와 장애가 발생할 수 있다.</li>\n<li>성능 테스트에서 목표를 만족한 것은 시스템 오픈을 위한 최소한의 기준일 뿐, 안정적으로 운영될 것이라고 담보하지는 못한다.</li>\n</ul>","fields":{"slug":"/ch1/","thumbnail":null},"frontmatter":{"date":"February 03, 2022","update":"Feb 03, 2022","title":"1부 - 성능 기초","description":null,"tags":["실무로 배우는 시스템 성능 최적화"],"thumbnail":null}},{"excerpt":"분산 시스템을 다루는 것은 한 컴퓨터에서 실행되는 소프트웨어를 작성하는 일과는 다르다. 뭔가 잘못될 수 있고 새롭고 흥미진진한 방법이 많다는 점이다. 이번장은 분산 시스템에서 잘못될지도 모르는 것에 관한 개요이다. 결함과 부분 장애 단일 컴퓨터에서 실행되는 소프트웨어는 하드웨어가 올바르게 동작하면 같은 연산은 항상 같은 결과를 낸다. 좋은 소프트웨어가 설…","html":"<ul>\n<li>\n<p>분산 시스템을 다루는 것은 한 컴퓨터에서 실행되는 소프트웨어를 작성하는 일과는 다르다.</p>\n<ul>\n<li>뭔가 잘못될 수 있고 새롭고 흥미진진한 방법이 많다는 점이다.</li>\n</ul>\n</li>\n<li>이번장은 분산 시스템에서 잘못될지도 모르는 것에 관한 개요이다.</li>\n</ul>\n<!-- more -->\n<h2 id=\"결함과-부분-장애\" style=\"position:relative;\">결함과 부분 장애<a href=\"#%EA%B2%B0%ED%95%A8%EA%B3%BC-%EB%B6%80%EB%B6%84-%EC%9E%A5%EC%95%A0\" aria-label=\"결함과 부분 장애 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>단일 컴퓨터에서 실행되는 소프트웨어는 하드웨어가 올바르게 동작하면 같은 연산은 항상 같은 결과를 낸다.</li>\n<li>좋은 소프트웨어가 설치된 각각의 컴퓨터는 보통 완전하게 동작하거나 전체 장애가 발생하지 그 중간 상태가 되지는 않는다.</li>\n<li>네트워크로 연결된 여러 컴퓨터에서 실행되는 소프트웨어를 작성할 때는 근본적으로 상황이 다르다.</li>\n<li>분산 시스템에서는 시스템의 어떤 부분은 잘 동작하지만 다른 부분은 예측할 수 없는 방식으로 고장난다. 이를 <code class=\"language-text\">부분 장애(partial failure)</code>라고 한다. <code class=\"language-text\">부분 장애는 비결정적이라서 어렵다.</code></li>\n<li>비결정성과 부분 장애 가능성이 분산 시스템을 다루게 어렵게 한다.</li>\n</ul>\n<aside>\n💡  신뢰성 없는 구성 요서를 사용해 신뢰성 있는 시스템 구축하기 \n<p>네트워크의 오류 수정 코드, TCP 프로토콜이 대표적인 예이다.</p>\n<p>오류 수정 코드는 무선 네트워크에서 발생하는 전파 장애 등의 이유로 일부 비트가 잘못되는 통신 채널을 통해 디지털 데이터를 정확히 전송할 수 있게 한다.</p>\n<p>TCP는 신뢰성이 없는 IP 계층 위에서 손실된 패킷을 재전송하고 중복된 것은 제거하여 패킷을 보낸 수넛에 맞춰 재조립되도록 보장해준다.</p>\n</aside>\n<h2 id=\"신뢰성-없는-네트워크\" style=\"position:relative;\">신뢰성 없는 네트워크<a href=\"#%EC%8B%A0%EB%A2%B0%EC%84%B1-%EC%97%86%EB%8A%94-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC\" aria-label=\"신뢰성 없는 네트워크 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>분산 시스템을 구축하는 유일한 방법은 아니지만 몇 가지 이유로 인터넷 서비스로 구축하는 방법이 주된 방법이 됐다.</li>\n<li>인터넷과 데이터센터 내부 네트워크 대부분은 비동기 패킷 네트워크다.</li>\n<li>노드에서 다른 노드로 패킷을 보낼 수 있지만 네트워크는 패킷이 언제 도착할지 혹은 메시지가 도착하기는 할 것인지 보장하지 않는다.</li>\n<li>\n<p>요청을 보내고 응답을 기다릴 때 여러가지가 잘못될 수 있다.</p>\n<ul>\n<li>요청이 손실됐을 수 있다.</li>\n<li>요청이 큐에서 대기하다 나중에 전송될 수 있다.</li>\n<li>원격 노드의 장애</li>\n<li>원격 노드의 일시적인 중지</li>\n<li>원격 노드 응답의 손실</li>\n<li>원격 노드 응답의 지연</li>\n</ul>\n</li>\n<li>이런 문제를 다루는 흔한 방법은 <code class=\"language-text\">타임아웃</code>이다. 얼마 간의 시간이 지나면 응답 대기를 멈추고 응답이 도착하지 않는다고 가정한다.</li>\n</ul>\n<h4>현실의 네트워크 결함</h4>\n<ul>\n<li>아직 신뢰성 있는 네트워크를 만드는데 성공하지 못했다.</li>\n<li>네트워크 중단의 주요 원인인 인적 오류로부터 보호해주지 못하기 때문이다.</li>\n<li>네트워크 결함이 드물더라도 <strong>일어날 수 있고</strong> 소프트웨어가 이를 처리할 수 있어야 한다.</li>\n<li>반드시 네트워크 결함을 견뎌내도록 처리할 필요는 없다.</li>\n<li>네트워크가 평상시에는 상당히 믿을 만하다면 네트워크에 문제가 있을 때 그냥 사용자에게 오류 메시지를 보여주는 것도 타당한 방법이다.</li>\n</ul>\n<h4>결함 감지</h4>\n<ul>\n<li>\n<p>많은 시스템은 결함 있는 노드를 자동으로 감지할 수 있어야 한다.</p>\n<ul>\n<li>로드 밸런서는 죽은 노드로 요청을 그만 보내야 한다.</li>\n<li>단일 리더 복제를 사용한다면 분산 데이터베이스에서 리더에 장애가 나면 팔로워 중 하나가 리더로 승격돼야 한다.</li>\n</ul>\n</li>\n<li>하지만 네트워크에 관한 불확실성 때문에 노드가 동작 중인지 아닌지 구별하기 어렵다.</li>\n<li>뭔가 동작하지 않는다고 명시적으로 알려주는 피드백을 받을 수 있다.</li>\n</ul>\n<h3 id=\"타임아웃과-기약-없는-지연\" style=\"position:relative;\">타임아웃과 기약 없는 지연<a href=\"#%ED%83%80%EC%9E%84%EC%95%84%EC%9B%83%EA%B3%BC-%EA%B8%B0%EC%95%BD-%EC%97%86%EB%8A%94-%EC%A7%80%EC%97%B0\" aria-label=\"타임아웃과 기약 없는 지연 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>타임아웃만이 결함을 감지하는 확실한 수단이라면 타임아웃은 얼마나 길어야 될까?</li>\n<li>타임아웃이 길면 노드가 죽었다고 선언될 때까지 기다리는 시간이 길어진다.</li>\n<li>\n<p>타임아웃이 짧으면 노드가 일시적으로 느려졌을 뿐인데도 죽었다고 잘못 선언할 위험이 높아진다.</p>\n<ul>\n<li>노드가 죽었다고 선언되면 그 노드의 책무를 다른 노드로 전달돼야 해서 다른 노드와 네트워크에 추가적인 부하를 준다.</li>\n</ul>\n</li>\n<li>비동기 네트워크는 패킷을 가능한 빨리 보내려고 하지만 패킷이 도착하는 데 걸리는 시간에 상한치는 없다.</li>\n<li>서버 구현은 대부분 어떤 최대 시간 내에 요청을 처리한다고 보장할 수 없다.</li>\n</ul>\n<h4>네트워크 혼잡과 큐 대기</h4>\n<ul>\n<li>자동차를 운전할 때 코통 체증 때문에 이동 시간이 달리지는 것 처럼 컴퓨터 네트워크에서 패킷 지연의 변동성은 큐 대기 때문인 경우가 많다.</li>\n<li>여러 장비가 같은 목적지로 네트워크 트래픽을 보내면 스위치 큐가 가득찰 수 있다.</li>\n<li>\n<p>TCP는 타임아웃 안에 확인 응답을 받지 않으면 패킷이 손실됐다고 간주하고 손실된 패킷은 자동으로 재전송한다.</p>\n<ul>\n<li>애플리케이션에서는 패킷 손실이나 재전송이 보이지 않지만 그 결과로 생기는 지연은 보인다.</li>\n</ul>\n</li>\n<li>지연의 변동성이 얼마나 되는지 알아내는 방법은 어렵다.</li>\n<li>더 좋은 방법으로는 고정된 타임아웃을 설정하는 대신 시스템이 지속적으로 응답 시간과 그들의 변동성을 측정하고 관찰된 응답 시간 분포에 따라 타임아웃을 자동으로 조절하게 하는 것이다. 카산드라가 사용한다.</li>\n</ul>\n<aside>\n💡 화상 회의나 인터넷 전화처럼 지연 시간에 민간함 애플리케이션은 TCP 대신 UDP를 사용한다.\n신뢰성과 지연 변동성 사이에 트레이드오프 관계가 있다. UDP는 흐름 제어를 하지 않고 손실된 패킷을 재전송하지 않으므로 네트워크 지연이 크게 변하게 하는 원인 중 일부를 제거한다.\n</aside>\n<h3 id=\"동기-네트워크-대-비동기-네트워크\" style=\"position:relative;\">동기 네트워크 대 비동기 네트워크<a href=\"#%EB%8F%99%EA%B8%B0-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EB%8C%80-%EB%B9%84%EB%8F%99%EA%B8%B0-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC\" aria-label=\"동기 네트워크 대 비동기 네트워크 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>동기식 네트워크가 대표적인 예는 고정 회선 전화 네트워크다.</p>\n<ul>\n<li>전화 네트워크는 극단적인 신뢰성을 지닌다.</li>\n<li>음성 프레임이 지연되거나 통화가 유실되는 일은 매우 드물다.</li>\n<li>통화를 할 때 회선(circuit)이 만들어지고 통화를 하는 두 명 사이에 있는 전체 경로를 따라서 그 통화에 대해 고정되고 보장된 양의 대역폭이 만들어진다.</li>\n<li>데이터가 여러 라우터를 거치더라도 큐 대기 문제를 겪지 않는다.</li>\n</ul>\n</li>\n<li>회선은 만들어져 있는 동안 다른 누구도 사용할 수 없는 고정된 양의 예약된 대역폭이지만 TCP 연결의 패킷은 가용한 네트워크 대역폭을 기회주의적으로 사용한다.</li>\n<li>\n<p>인터넷 네트워크는 회선 교환 방식으로 패킷을 교환한다.</p>\n<ul>\n<li>이들은 순간적으로 몰리는 트래픽에 최적화됐기 때문이다.</li>\n<li>통화는 초당 비트 개수가 고정돼지만 웹 페이지 요청은 가능하면 빨리 완료되기만 하면 된다.</li>\n<li>순간적으로 몰리는 데이터 전송에 전용 회선을 쓰면 네트워크 용량을 낭비하고 전송이 불필요하게 느려진다.</li>\n<li>TCP는 가용한 네트워크 용량에 맞춰 데이터 전송률을 동적으로 조절한다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"신뢰성-없는-시계\" style=\"position:relative;\">신뢰성 없는 시계<a href=\"#%EC%8B%A0%EB%A2%B0%EC%84%B1-%EC%97%86%EB%8A%94-%EC%8B%9C%EA%B3%84\" aria-label=\"신뢰성 없는 시계 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>네트워크에 있는 개별 장비는 자신의 시계를 갖고 있다.</li>\n<li>이 장치는 정확하지 않아서 각 장비는 자신만의 시간 개념이 있으며 이는 다른 장비보다 약간 빠를 수도 느릴 수도 있다.</li>\n</ul>\n<h3 id=\"단조-시계-대-일-기준-시계\" style=\"position:relative;\">단조 시계 대 일 기준 시계<a href=\"#%EB%8B%A8%EC%A1%B0-%EC%8B%9C%EA%B3%84-%EB%8C%80-%EC%9D%BC-%EA%B8%B0%EC%A4%80-%EC%8B%9C%EA%B3%84\" aria-label=\"단조 시계 대 일 기준 시계 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>컴퓨터는 최소 두 가지 종류의 시계를 갖고 있다.</p>\n<ul>\n<li><strong>일 기준 시계(time-of-day clock)</strong></li>\n<li><strong>단조 시계(monotonic clock)</strong></li>\n</ul>\n</li>\n</ul>\n<h4><strong>일 기준 시계(time-of-day clock)</strong></h4>\n<ul>\n<li>\n<p>일 기준 시계는 현재 날짜와 시간을 반환한다.</p>\n<ul>\n<li>예를 들어 자바의 <code class=\"language-text\">System.currentTimeMillis()</code>는 <code class=\"language-text\">에포크(epoch</code>) 이래로 흐른 밀리초를 반환한다.</li>\n<li>에포크(epoch)란 UTC(협정세계시) 1970년 1월 1일 자정을 가르킨다.</li>\n</ul>\n</li>\n<li>일 기준 시계는 보통 NTP로 동기화 된다.</li>\n<li>로컬 시계가 NTP 서버 보다 너무 앞서면 강제로 리셋되어 과거 시점으로 거꾸로 뛰는 것처럼 보일 수 있다.</li>\n</ul>\n<h4><strong>단조 시계(monotonic clock)</strong></h4>\n<ul>\n<li>\n<p>단조 시계는 타임아웃이나 서비스 응답 시간 같은 시간 구간을 재는 데 적합하다.</p>\n<ul>\n<li>자바의 <code class=\"language-text\">System.nanoTime()</code> 이 있다.</li>\n</ul>\n</li>\n<li>\n<p>단조 시계란 이름은 항상 앞으로 흐른다는 사실에서 나왔다.</p>\n<ul>\n<li>일 기준 시계는 시간이 거꾸로 뛸 수도 있다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"시계-동기화와-정확도\" style=\"position:relative;\">시계 동기화와 정확도<a href=\"#%EC%8B%9C%EA%B3%84-%EB%8F%99%EA%B8%B0%ED%99%94%EC%99%80-%EC%A0%95%ED%99%95%EB%8F%84\" aria-label=\"시계 동기화와 정확도 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>단조 시계는 동기화가 필요 없지만 일 기준 시계는 NTP서버로 동기화되어야 한다.</li>\n<li>하드웨어 시계나 NTP 서버는 시계 정확도에 오차가 생길 수 있다.</li>\n<li>\n<p>충돌 해소 전략 중 하나인 <code class=\"language-text\">최종 쓰기 승리(last write wins, LWW)</code> 는 이런 시간의 오차로 문제가 발생할 수 도 있다.</p>\n<ul>\n<li>따라서 가장 최근 값을 유지하고 다른 것들을 버림으로써 충돌을 해소하고 싶어도 <strong>최근</strong>의 정의는 로컬 일 기준 시계에 의존하며 그 시계는 틀릴 수 있다는 것을 아는게 중요하다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"지식-진실-그리고-거짓말\" style=\"position:relative;\">지식, 진실, 그리고 거짓말<a href=\"#%EC%A7%80%EC%8B%9D-%EC%A7%84%EC%8B%A4-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EA%B1%B0%EC%A7%93%EB%A7%90\" aria-label=\"지식 진실 그리고 거짓말 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>분산 시스템에는 공유 메모리가 없고 지연 변동이 큰 신뢰할 수 없는 네트워크를 통해 메시지를 보낼 수 있을 뿐이며 부분 장애, 신뢰성 없는 시계, 프로세스 중단에 시달릴 수 있다.</li>\n<li>원격 노드가 응답하지 않으면 그 노드가 어떤 상태에 있는지 알 방법은 없다.</li>\n<li>분산 시스템에서 우리는 동작에 관해 정한 가정을 명시하고, 이런 가정을 만족시키는 방식으로 실제 시스템을 설계 할 수 있다.</li>\n<li>이번 장의 나머지 부분에서 분산 시스템의 지식과 진실에 관한  개념을 살펴본다.</li>\n</ul>\n<h3 id=\"진실은-다수결로-결정된다\" style=\"position:relative;\">진실은 다수결로 결정된다<a href=\"#%EC%A7%84%EC%8B%A4%EC%9D%80-%EB%8B%A4%EC%88%98%EA%B2%B0%EB%A1%9C-%EA%B2%B0%EC%A0%95%EB%90%9C%EB%8B%A4\" aria-label=\"진실은 다수결로 결정된다 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>분산 시스템은 한 노드에만 의존할 수는 없다. 노드에 언제든 장애가 나서 잠재적으로 시스템이 멈추고 복구할 수 없게 될 수 있기 때문이다.</li>\n<li>\n<p>여러 분산 알고리즘은 정족수, 즉 노드들 사이의 투표에 의존한다.</p>\n<ul>\n<li>특정한 노드 하나에 대한 의존을 줄이기 위해 결정을 하려면 여러 노드로부터 어떤 최소 개수의 투표를 받아야 한다.</li>\n</ul>\n</li>\n</ul>\n<h4>리더와 잠금</h4>\n<ul>\n<li>분산 시스템에서 어떤 노드를 선택하는 행위<code class=\"language-text\">(파티션의 리더, 잠금을 획득한 자, 사용자명을 차지는데 성공한 사용자의 요청)</code>는 주의해야한다.</li>\n<li>어떤 노드가 이전에 리더였더라도 시간이 흐른 사이에 다른 노드들이 그 노드가 죽었다고 선언하면 그 노드는 강등되고 다른 리더가 이미 선출됐을지도 모르기 때문이다.</li>\n<li>분산 잠금을 잘못 구현 : 클라이언트 1은 임차권이 마료됐는데도 여전히 유효하다고 생각해서 저장소에 있는 파일을 오염시킨다.</li>\n</ul>\n<h4>펜싱 토큰</h4>\n<ul>\n<li>위의 분산 잠금 문제를 해결하기 위해서는 자신이 <code class=\"language-text\">선택된 자</code>라고 잘못 믿고 있는 노드가 나머지 시스템을 방해할 수 없도록 보장해야 한다.</li>\n<li>이 목적을 달성하는 기법으로 <code class=\"language-text\">펜싱(fencing)</code>이 있다.</li>\n<li>\n<p>잠금 서버가 잠금이나 임차권을 승인할 때마다 <code class=\"language-text\">펜싱 토큰</code>도 반환하도록 한다.</p>\n<ul>\n<li>펜싱 토큰은 잠금이 될 때마다 증가하는 숫자다.</li>\n<li>클라이언트가 쓰기 요청을 할 때 이 펜싱 토큰을 함께 보내 현재 알고 있는 펜싱 토큰값과 비교하여 선택된 자를 식별할 수 있다.</li>\n</ul>\n</li>\n<li>이 메커니즘은 오래된 토큰을 사용해서 쓰는 것을 거부함으로써 토큰을 확인 역활을 한다.</li>\n</ul>\n<h3 id=\"비잔틴-결함\" style=\"position:relative;\">비잔틴 결함<a href=\"#%EB%B9%84%EC%9E%94%ED%8B%B4-%EA%B2%B0%ED%95%A8\" aria-label=\"비잔틴 결함 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>노드가 거짓말(임의의 결함이 있거나 오염된 응답을 보냄)을 할지도 모른다는 위험이 있다면 훨씬 더 어려워진다.</p>\n<ul>\n<li>펜신 토큰에서 클라이언트는 고의로 가짜 펜신 토큰을 보내면 시스템의 보장을 무너뜨릴 수 있다.</li>\n</ul>\n</li>\n<li>어떤 노드가 실제로는 받지 않은 메시지를 받았다고 주장할 수 있는데 이런 동작을 <code class=\"language-text\">비잔틴 결함(Byzantine fault)</code>라고 한다.</li>\n<li>이렇게 신뢰할 수 없는 환경에서 합의에 도달하는 문제를 <code class=\"language-text\">비잔틴 장군 문제</code>라고 한다.</li>\n<li>일부 노드가 오동작하고 프로토콜을 준수하지 않거나 악의적인 공격자가 네트워크를 방해하더라도 시스템에 계속 올바르게 동작한다면 <code class=\"language-text\">비잔틴 내결함성을 지닌다</code>라고 한다.</li>\n<li>\n<p>웹 애플리케이션은 웹브라우저 같은 클라이언트 행동이 임의적이고 악의적이라고 예상해야 한다. 이는 입력 확인, 변환, 출력 이스케이핑이 중요한 이유다.</p>\n<ul>\n<li>예를 들어 SQL 인젝션이나 XSS 같은 해킹을 막아야 한다.</li>\n</ul>\n</li>\n<li>대부분의 비잔틴 내결함성 알고리즘은 노드의 2/3 이상의 다수가 올바르게 동작하기를 요구한다.</li>\n</ul>\n<h3 id=\"정리\" style=\"position:relative;\">정리<a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>분산 시스템에서 나타날 수 있는 문제는 광범위하다.</p>\n<ul>\n<li>네트워크 결함</li>\n<li>노드 간 시계의 오차</li>\n<li>원격노드의 상태를 알 수 없는 문제</li>\n</ul>\n</li>\n<li>대부분의 분산 알고리즘은 원격 노드를 아직 쓸 수 있는지 결정하기 위해 타임아웃을 사용한다.</li>\n<li>분산 시스템에선 한 노드에만 의존할 수 없으므로 정족수를 이용하는 프로토콜이 필요하다.</li>\n</ul>","fields":{"slug":"/ch8/","thumbnail":null},"frontmatter":{"date":"February 02, 2022","update":"Feb 02, 2022","title":"8장 - 분산 시스템의 골칫거리","description":null,"tags":["데이터 중심 애플리케이션 설계"],"thumbnail":null}},{"excerpt":"애매모호한 트랜잭션의 개념 ACID의 의미 트랜잭션이 제공하는 안정성 보장은 원자성(Atomicity), 일관성(Consistency), 격리성(Isolation), 지속성(Durability) 을 의미하는  로 잘 알려져 있다. 그러나 현실에서는 데이터베이스마다 ACID 구현이 재각각이다. 시스템에서 실제로 어떤 것을 기대할 수 있는지 분명하지 않다. …","html":"<h2 id=\"애매모호한-트랜잭션의-개념\" style=\"position:relative;\">애매모호한 트랜잭션의 개념<a href=\"#%EC%95%A0%EB%A7%A4%EB%AA%A8%ED%98%B8%ED%95%9C-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98%EC%9D%98-%EA%B0%9C%EB%85%90\" aria-label=\"애매모호한 트랜잭션의 개념 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"ACID의-의미\" style=\"position:relative;\">ACID의 의미<a href=\"#ACID%EC%9D%98-%EC%9D%98%EB%AF%B8\" aria-label=\"ACID의 의미 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>트랜잭션이 제공하는 안정성 보장은 <strong>원자성(Atomicity), 일관성(Consistency), 격리성(Isolation), 지속성(Durability)</strong> 을 의미하는 <code class=\"language-text\">ACID</code> 로 잘 알려져 있다.</li>\n<li>그러나 현실에서는 데이터베이스마다 ACID 구현이 재각각이다. 시스템에서 실제로 어떤 것을 기대할 수 있는지 분명하지 않다.</li>\n</ul>\n<!-- more -->\n<h4>원자성</h4>\n<ul>\n<li>원장성은 클라이언트가 쓰기 작업 몇 개를 실행하려고 하는데 그 중 일부만 처리된 후 결함이 생기면 무슨 일이 생기는지 설명한다.</li>\n<li>여러 쓰기 작업이 하나의 원자적 단위인 트랜잭션으로 묶여 있는데 결함 때문에 커밋될 수 없다면 어보트되고 지금까지 실행한 쓰기를 무시하거나 취소해야하 한다.</li>\n<li>원자성은 여러 프로세스가 동시에 같은 데이터에 접근하려고 할 때 무슨 일이 생기는지 설명하지 않는다.</li>\n<li>오류가 생겼을 때 트랜잭션을 어보트하고 해당 트랜잭션에서 기록한 모든 내용을 취소하는 <code class=\"language-text\">어보트 능력(abortability)</code> 능력이 원자성의 결정적 특징이다.</li>\n</ul>\n<h4>일관성</h4>\n<ul>\n<li>\n<p>일관성이란 단어는 굉장히 여러 의미로 쓰인다.</p>\n<ul>\n<li>복제 일관성과 비동기식 복제되는 시스템에서 발생하는 최종적 일관성 문제</li>\n<li>일관성 해싱은 어떤 시스템들에서 재균형화를 위해 사용하는 파티셔닝 방법</li>\n<li>CAP 정리에서 일관성은 선형성을 의미한다.</li>\n<li>ACID 맥락에서 일관성은 데이터베이스가 “좋은 상태”에 있어야 한다는 애플리케이션에 특화된 개념을 가르킨다.</li>\n</ul>\n</li>\n<li>일관성의의 아이디어는 데이터에 관한 어떤 불변식이 항상 진실이어야 한다는 것이다.</li>\n<li>트랜잭션이 이런 불변식이 유요한 데이터베이스에서 시작하고 트랜잭션에서 실행된 모든 쓰기가 유효성을 보존한다면 불변식이 항상 만족된다고 확신할 수 있다.</li>\n<li>일관성의 아이디어는 애플리케이션의 불변식 개념에 의존하고, 일관성을 유지하도록 트랜잭션을 올바르게 정의하는 것은 애플리케이션의 책임이다.</li>\n<li>\n<p>데이터베이스 불변식을 위반하는 잘못된 데이터를 쓰지 못하도록 막을 수 없다</p>\n<ul>\n<li>외래 키, 기본키 제약 조건같은 특정 종류의 불변식을 지원하지만 일반적으로 애플리케이션에서 데이터가 유효한지 아닌지를 정의하고 데이터베이스는 데이터를 저장할 뿐이다.</li>\n</ul>\n</li>\n</ul>\n<h4>격리성</h4>\n<ul>\n<li>클라리언트들이 동일한 데이터베이스 레코드에 접근하면 동시성 문제가 발생한다.</li>\n<li>여러 트랜잭션이 동시에 실행됐더라도 트랜잭션이 커밋됐을 때의 결과가 트랜잭션이 순차적으로 실행됐을 때의 결과와 동일하도록 보장한다.</li>\n</ul>\n<h4>지속성</h4>\n<ul>\n<li>트랜잭션이 성공적으로 커밋됐다면 하드웨어 결함이 발생하거나 데이터베이스가 죽더라도 트랜잭션에서 기록한 모든 데이터는 손실되지 않는다는 보장이다.</li>\n</ul>\n<h3 id=\"단일-객체-연산과-다중-객체-연산\" style=\"position:relative;\">단일 객체 연산과 다중 객체 연산<a href=\"#%EB%8B%A8%EC%9D%BC-%EA%B0%9D%EC%B2%B4-%EC%97%B0%EC%82%B0%EA%B3%BC-%EB%8B%A4%EC%A4%91-%EA%B0%9D%EC%B2%B4-%EC%97%B0%EC%82%B0\" aria-label=\"단일 객체 연산과 다중 객체 연산 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>ACID에서 원자성과 격리성은 클라이언트가 한 트랜잭션 내에서 여러 번의 쓰기를 하면 데이터베이스가 어떻게 해야하는지를 서술한다.</li>\n<li>다중 객체 트랜잭션은 어떤 읽기 연산과 쓰기 연산이 동일한 트랜잭션이 속하는지 알아낼 수단이 있어야 한다.</li>\n<li>관계형 데이터베이스에서 이것은 전형적으로 클라이언트와 데이터베이스 서버 사이의 TCP 연결을 기반으로 한다.</li>\n<li>어떤 특정 연결 내에서 <code class=\"language-text\">BEGIN TRANSACTION</code> 문과 <code class=\"language-text\">COMMIT</code> 문 사이의 모든 것은 같은 트랜잭션에 속하는 것으로 여긴다.</li>\n<li>반명 비관계형 데이터베이스는 한 연산 내에서 여러 키를 갱신하는 다중 객체 연산을 묶는 방법이 없는 경우가 많다.</li>\n<li>어떤 키에 대한 연산은 성공하고 나머지 키에 대한 연산은 실패해서 데이터베이스가 부분적으로 갱신된 상태가 될 수 있다.</li>\n</ul>\n<h4>단일 객체 쓰기</h4>\n<ul>\n<li>저장소 엔진들은 보편적으로 한 노드에 존재하는 단일 객체 수준에서 원자성과 격리성을 제공하는 것을 목표로 한다.</li>\n<li>어떤 데이터베이스는 증가 연산처럼 더 복잡한 원자적 연산을 제공하기도 한다.</li>\n<li>이러한 단일 객체 연산은 여러 클라이언트에서 동시에 같은 객체에 쓰려고 할 때 갱신 손실을 방지하므로 유용하다.</li>\n</ul>\n<h4>다중 객체 트랜잭션의 필요성</h4>\n<ul>\n<li>다중 객체 트랜잭션은 여러 파티션에 걸쳐서 구현하기가 어렵고 매우 높은 가용성과 성능이 필요한 곳에서는 방해가 되는 시나리오도 있기 때문에 지원하기가 어렵다.</li>\n<li>단일 객체 삽입, 갱신, 삭제만으로 충분한 사용 사례가 있다. 트랜잭션이 없더라도 이런 애플리케이션ㅇ들은 구현할 수 있다.</li>\n<li>하지만 원자성이 없으면 오츄 처리가 훨씬 더 복잡해지고 격리성이 없으면 동시성 문제가 생길 수 있다.</li>\n</ul>\n<h4>오류와 어보트 처리</h4>\n<ul>\n<li>트랜잭션의 핵심 기능은 오류가 생기면 어보트되고 아전하게 재시도할 수 있다는 것이다.</li>\n<li>하지만 리더 없는 복제를 사용하는 데이터스토어는 이러한 철학을 따르지 않는다. <code class=\"language-text\">최선을 다하는 원칙</code>을 기반으로 더 많은 일을 한다.</li>\n</ul>\n<h2 id=\"완화된-격리-수준\" style=\"position:relative;\">완화된 격리 수준<a href=\"#%EC%99%84%ED%99%94%EB%90%9C-%EA%B2%A9%EB%A6%AC-%EC%88%98%EC%A4%80\" aria-label=\"완화된 격리 수준 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>두 트랜잭션이 동일한 데이터에 접근하지 않으면 서로 의존하지 않으므로 병렬 실행 될 수 있다.</li>\n<li>동시성 문제(경쟁 조건)는 트랜잭션이 다른 트랜잭션에서 동시에 변경한 데이터를 읽거나 두 트랜잭션이 동시에 같은 데이터를 변경하려고 할 때만 나타난다.</li>\n<li><code class=\"language-text\">트랜잭션 격리</code>를 제공함으로써 애플리케이션 개발들에게 동시성 문제를 감췄다.</li>\n<li>직렬성 격리는 성능 빙용이 있고 많은 데이터베이스들은 그 비용을 지불하려고 하지 않는다.</li>\n<li>따라서 어떤 동시성 이슈로부터는 보호해주지만 모든 이슈로부터 보호해주지는 않는 완화된 격리 수준을 사용하는 시스템들이 흔하다.</li>\n<li>이번 절에서는 완화된(비직렬성) 격리 수준 몇 가지를 살펴보고 발생할 수 있는 경쟁 조건과 발생할 수 없는 경쟁 조건을 설명한다.</li>\n</ul>\n<h3 id=\"커밋-후-읽기\" style=\"position:relative;\">커밋 후 읽기<a href=\"#%EC%BB%A4%EB%B0%8B-%ED%9B%84-%EC%9D%BD%EA%B8%B0\" aria-label=\"커밋 후 읽기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>가장 기본적인 수준의 트랜잭션 격리는 <code class=\"language-text\">커밋 후 읽기(read committed)</code>다.</p>\n<ul>\n<li>데이터베이스 읽을 때 커밋된 데이터만 보게 된다. (더티 읽기가 없음)</li>\n<li>데이터베이스에서 쓸 때 커밋된 데이터만 덮어쓰게 된다. (더티 쓰기가 없음)</li>\n</ul>\n</li>\n</ul>\n<h4>더티 읽기 방지</h4>\n<ul>\n<li>\n<p>트랜잭션이 데이터베이스에 데이터를 썻지만 아직 커밋되거나 어보트되지 않았을 때, 다른 트랜잭션이 커밋되지 않은 데이터를 읽을 수 있는 것을 더티 읽기라고 부른다.</p>\n<ul>\n<li>트랜잭션이 일부는 갱신된 값을, 일부는 갱신되지 않은 값을 볼 수 있다.</li>\n<li>커밋되지 않은 데이트를 볼 수 있다.</li>\n</ul>\n</li>\n</ul>\n<h4>더티 쓰기 방지</h4>\n<ul>\n<li>아직 커밋되지 않은 데이터에 다른 트랜잭션이 쓰기 작업을 하는 것을 <code class=\"language-text\">더티 쓰기(dirty write)</code>라고 한다.</li>\n</ul>\n<h4>커밋후 읽기 구현</h4>\n<ul>\n<li>\n<p>더티 쓰기의 가장 흔한 방법으로 데이터베이스는 로우 수준 잠금을 사용해 더티 쓰기를 방지한다.</p>\n<ul>\n<li>트랜잭션에서 특정 객체(로우나 문서)를 변경하고 싶다면 먼저 해당 객체에 대한 잠금을 획득하고, 트랜잭션이 완려될 때까지 잠금을 보유하고 있어야 한다.</li>\n<li>다른 트랜잭션이 쓰기를 원한다면 첫 번째 트랜잭션이 완료되어 잠금을 얻어 진행할 수 있다.</li>\n</ul>\n</li>\n<li>\n<p>더티 읽기는 잠금을 써서 객체를 읽기 원하는 트랜잭션이 잠시 잠금을 획득한 후 읽기가 끝난 후 바로 해제하게 하는 것 이다.</p>\n<ul>\n<li>그러나 읽기 잠금은 트랜잭션들의 응답 시간에 해를 끼치며 운용성이 나쁘다.</li>\n<li>쓰여진 모든 객체에 대해 데이터베이스는 과거에 커밋된 값과 현재 쓰기 잠금을 갖고 있는 트랜잭션에서 쓴 새로운 값을 모두 기억한다.</li>\n<li>해당 트랜잭션이 그 객체를 읽으려고 하면 과거의 값을 읽게 된다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"스냅숏-격리와-반복-읽기\" style=\"position:relative;\">스냅숏 격리와 반복 읽기<a href=\"#%EC%8A%A4%EB%83%85%EC%88%8F-%EA%B2%A9%EB%A6%AC%EC%99%80-%EB%B0%98%EB%B3%B5-%EC%9D%BD%EA%B8%B0\" aria-label=\"스냅숏 격리와 반복 읽기 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>커밋된 읽기 격리 수준을 사용하더라도 동시성 버그가 생길 수 있다.</p>\n<ul>\n<li>앨리스는 두 계좌에 500달러 씩 있고, 한 계좌에서 다른 계좌로 100달러를 전송하는 트랜잭션을 실행한다.</li>\n<li>트랜잭션이 처리되고 있는 순간에 계좌 잔고를 보게 되면 입금되기 전 상태인 500달러, 출금된 후 상태인 400달러를 보게되어 총 900달러만 있는 것처럼 나온다.</li>\n<li>앨리스가 봤던 계좌 잔고들은 읽은 시점에 커밋된 상태였다.</li>\n<li>이런 현상을 <code class=\"language-text\">비반복 읽기(nonrepeatable read)</code>나 <code class=\"language-text\">읽기 스큐(read skew</code>)라고 한다.</li>\n<li>스냅</li>\n</ul>\n</li>\n<li>\n<p>스냅숏 격리는 이런 문제의 가장 흔한 해결책이다.</p>\n<ul>\n<li>각 트랜잭션은 데이터베이스의 일관된 스냅숏으로부터 읽는다.</li>\n<li>즉 트랜잭션은 시작할 때 데이터베이스에 커밋된 상태였던 모든 데이터를 본다.</li>\n</ul>\n</li>\n</ul>\n<h4>스냅숏 격리 구현</h4>\n<ul>\n<li>스냅숏 격리 구현은 커밋 후 읽기 격리처럼 쓰기 잠금을 사용한다. 그러나 읽을 때는 아무 잠금도 필요하지 않다.</li>\n<li>스냅숏 격리의 핵심 원리는 <code class=\"language-text\">읽는 쪽에서 쓰는 쪽을 결코 차단하지 않고 쓰는 쪽에서 읽는 쪽을 결코 차단하지 않는다는</code> 것이다.</li>\n<li>따라서 데이터베이스는 잠금 경쟁 없이 일관성 있는 스냅숏에 오래 실행되는 읽기 작업을 처리할 수 있다.</li>\n<li>여러 트랜잭션에서 서로 다른 시점의 데이터베이스 상태를 봐야 할 수도 있기 때문에 데이터베이스는 객체마다 커밋된 버전 여러 개를 유지할 수 있어야 한다.</li>\n<li>이런 기법을 <code class=\"language-text\">다중 버전 동시성 제어(MVCC)</code>라고 한다.</li>\n<li>\n<p>데이터베이스가 커밋 후 읽기 격리만 제공할 필요가 있다면 객체마다 커멋된 버전, 커멋되지 않은 버전 두 개씩만 유지하면 충분하다.</p>\n<ul>\n<li>커밋 후 읽기는 질의마다 독립된 스냅숏을 사용하고 스냅숏 격리는 전체 트랜잭션에 대해 동일한 스냅숏을 사용하는 것이다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"갱신-손실-방지\" style=\"position:relative;\">갱신 손실 방지<a href=\"#%EA%B0%B1%EC%8B%A0-%EC%86%90%EC%8B%A4-%EB%B0%A9%EC%A7%80\" aria-label=\"갱신 손실 방지 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>커밋 후 읽기와 스냅숏 격리 수준은 동시에 실행되는 쓰기 작업이 있을 때 읽기 전용 트랜잭션이 무엇을 볼 수 있는지에 대한 보장과 관련된 것 이다.</li>\n<li>갱신 손실 문제는 애플리케이션이 데이터베이스에서 값을 읽고 변경한 후 변경된 값을 다시 쓸 때 발생할 수 있다.</li>\n<li>이 작업을 동시에 하면 두 번째 쓰기 작업이 첫 번째 변경을 포함하지 않으므로 변경 중 하나는 손실될 수 있다.</li>\n</ul>\n<h4>원자적 쓰기 연산</h4>\n<ul>\n<li>이 연산은 애플리케이션 코드에서 read-modify-write 주기를 구현할 필요를 없애 준다</li>\n<li>다음 명령은 대부분의 관계형 데이터베이스에서 동시성 안전(concurrency-safe)하다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token constant\">UPDATE</span> conters <span class=\"token constant\">SET</span> value <span class=\"token operator\">=</span> value <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token constant\">WHERE</span> key <span class=\"token operator\">=</span> <span class=\"token string\">'foo'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>원자적 연산은 보통 객체를 읽을 때 독접적인(exclusive) 잠금을 획득해서 구현한다. 갱신이 적용될 때까지 다른 트랜잭션에서 그 객체를 읽지 못한다.</li>\n<li>ORM 프레임워크를 사용하면 데이터베이스가 원자적 연산을 사용하는 대신  read-modify-write 주기를 실행하는 코드를 작성하기 쉽다.</li>\n</ul>\n<h4>명시적인 잠금</h4>\n<ul>\n<li>데이터베이스에 내장된 원자적 연산이 필요한 기능을 제공하지 않을 때 갱신 손실을 막는 또 다른 선택지는 애플리케이션에서 갱신할 객체를 명시적으로 잠금하는 것이다.</li>\n<li>read-modify-write 주기를 수행할 수 있고 다른 트랜잭션이 동시에 같은 객체를 읽으려고 하면 read-modify-write 주기가 완료될 때까지 기다리도록 강제된다.</li>\n<li><code class=\"language-text\">SELEFT FOR UPDATE</code> 절은 이 질의에 의해 반환된 모든 로우에 잠금을 획득해야 함을 가르킨다.</li>\n</ul>\n<h4>갱신 손실 자동 감지</h4>\n<ul>\n<li>지금까지 설명한 갱신 손실 방지 방법은 연산을 순차적으로 실행되도록 강제함으로써 갱신 손실을 방지하는 방법이다.</li>\n<li>대안으로 이들의 병렬 실행을 허용하고 트랜잭션 관리자가 갱신 손실을 발견하면 트랜잭션을 어보트 시키고 쓰기를 재시도하도록 강제하는 방법이 있다.</li>\n<li>Mysql의 반복 읽기는 갱신 손실을 감지하지 않는다.</li>\n</ul>\n<h4>Compare-and-set</h4>\n<ul>\n<li>트랜잭션을 제공하지 않는 데이터베이스 중에는 원자적 compare-and-set 연산을 제공하는 것도 있다.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token constant\">UPDATE</span> wiki_pages <span class=\"token constant\">SET</span> content <span class=\"token operator\">=</span> <span class=\"token string\">'new content'</span>\n<span class=\"token constant\">WHERE</span> id <span class=\"token operator\">=</span> <span class=\"token number\">1234</span> <span class=\"token constant\">AND</span> content <span class=\"token operator\">=</span> <span class=\"token string\">'old content'</span></code></pre></div>\n<h4>충돌 해소와 복제</h4>\n<ul>\n<li>복제가 적용된 데이터베이스에서 갱신 손실을 막는 것은 다른 차원의 문제다.</li>\n<li>여러 쓰기가 동시에 실행되고 비동기식으로 복제되는 것을 허용하므로 데이터의 최신 복사본이 하나만 있으리라고 보장할 수 없다.</li>\n<li><strong>동시 쓰기 감지</strong> 처럼 여러 개의 충돌된 버전(sibling)을 생성하는 것을 허용하고 사후에 충돌을 해소하고 병합하는 것이다.</li>\n</ul>\n<h3 id=\"쓰기-스큐write-skew와-팬텀\" style=\"position:relative;\">쓰기 스큐(write skew)와 팬텀<a href=\"#%EC%93%B0%EA%B8%B0-%EC%8A%A4%ED%81%90write-skew%EC%99%80-%ED%8C%AC%ED%85%80\" aria-label=\"쓰기 스큐write skew와 팬텀 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>\n<p>쓰기 스큐는 두 트랜잭션이 같은 객체들을 읽어서 그중 <code class=\"language-text\">일부</code>를 갱신할 때 나타날 수 있다.</p>\n<ul>\n<li><code class=\"language-text\">동일한 객체를 갱신하는 경우</code> 더티 쓰기나 갱신 손실 이상 현상을 겪는다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"직렬성\" style=\"position:relative;\">직렬성<a href=\"#%EC%A7%81%EB%A0%AC%EC%84%B1\" aria-label=\"직렬성 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>여러 트랜잭션이 병렬로 실행되더라도 최종 결과는 동시성 없이 한 번에 하나씩 직렬로 실행될 때와 같도록 보장한다.</li>\n<li>즉 데이터베이스가 발생할 수 있는 <strong>모든</strong> 경쟁 조건을 막아준다.</li>\n<li>\n<p>오늘날 직렬성을 제공하는 데이터베이스는 대부분 세 가지 기법 중 하나를 사용한다.</p>\n<ul>\n<li>트랜잭션을 순차적으로 실행하기</li>\n<li>2단계 잠금</li>\n<li>직렬성 스냅숏 격리 같은 낙관적 동시성 제어</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"실제적인-직렬-실행\" style=\"position:relative;\">실제적인 직렬 실행<a href=\"#%EC%8B%A4%EC%A0%9C%EC%A0%81%EC%9D%B8-%EC%A7%81%EB%A0%AC-%EC%8B%A4%ED%96%89\" aria-label=\"실제적인 직렬 실행 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>한 번에 트랜잭션 하나씩만 직렬로 단일 스레드에서 실행하면 된다.</li>\n<li>\n<p>과거 30년 동안 높은 성능을 위해 다중 스레드 동시성이 필수적인 것으로 여겨졌지만 최근이 돼서야 단일 스레드 루프에서 트랜잭션을 실행하는 게 실현 가능하도고 결론지었다.</p>\n<ul>\n<li>램 가격이 저렴해지면서 활성화된 데이터셋 전체를 메모리에 유지할 수 있을 정도가 됐다.</li>\n<li>OLTP 트랜잭션이 보통 짧고 실행하는 읽기와 쓰기의 개수가 적다는 것을 알았다. 반대로 오래 실행되는 분석 질의는 직렬 실행 루프 밖에서 일관된 스냅숏을 사용해 실행할 수 있다.</li>\n</ul>\n</li>\n</ul>\n<h4>트랜잭션을 스토어드 프로시저 안에 캡슐화하기</h4>\n<ul>\n<li>트랜잭션이 사용자의 입력을 기다려야 한다면 데이터베이스는 대부분 유휴 상태일 것 이다.</li>\n<li>이를 효율적으로 처리할 수 없어서 거의 모든 OLTP 애플리케이션은 트랜잭션 내에서 사용자 응답을 대기하는 것을 회피함으로써 트랜잭션을 짧게 유지한다.</li>\n<li>애플리케이션에서 질의를 실행하고 그 결과를 읽고, 첫 번째 결과에 따라 다른 질의를 실행할 수 도 있다.</li>\n<li>이러한 상호작용식 트랜잭션을 데이터베이스에서 동시성을 허용하지 않으면 처리량은 끔직해 질 것 이다.</li>\n<li>트랜잭션 코드 전체를 스토어드 프로시저 형태로 데이터베이스에 미리 제출하여 사용할 수 있다.</li>\n</ul>\n<h4>스토어드 프로시저의 장단점</h4>\n<ul>\n<li>데이터베이스 벤더마다 제각각 스토어드 프로시저용 언어가 있다.</li>\n<li>데이터베이스에서 실행되는 코드는 관리하기 어렵다.</li>\n<li>데이터베이스 인스턴스 하나를 공유하기 때문에 잘못 작성된 스토어드 프로시저는 서버에 훨씬 민감하다.</li>\n</ul>\n<h4>파티셔닝</h4>\n<ul>\n<li>각 트랜잭션이 단일 파티션 내에서만 데이터를 읽고 쓰도록 데이터셋을 파티셔닝할 수 있다면 각 파티셔닝은 다른 파티션과 독립적으로 실행되므로 처리량을 높일 수 있다.</li>\n<li>그러나 여러 파티션에 접근해야 하는 트랜잭션이 있다면 해당 트랜잭션이 접근하는 모든 타피션에 걸쳐서 코디네이션을 해야하므로 엄청나게 느려진다.</li>\n</ul>\n<h4>직렬 실행 요약</h4>\n<ul>\n<li>트랜잭션은 작고 빨라야 한다. 느린 트랜잭션이 모든 트랜잭션 처리를 지연시킬 수 있기 때문이다.</li>\n<li>활성화된 데이터셋이 메모리에 적재될 수 있는 경우로 사용이 제한된다.</li>\n<li>쓰기 처리량이 단일 CPU 코어에서 처리할 수 정도로 충분히 낮아야 한다.</li>\n<li>여러 파티션에 걸친 트랜잭션도 쓸 수 있지만 엄격한 제한이 있다.</li>\n</ul>\n<h3 id=\"2단계-잠금2PL\" style=\"position:relative;\">2단계 잠금(2PL)<a href=\"#2%EB%8B%A8%EA%B3%84-%EC%9E%A0%EA%B8%882PL\" aria-label=\"2단계 잠금2PL permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>데이터베이스 직렬성을 구현하는데 널리 쓰인 유일한 알고리즘이다.</li>\n<li>트랜잭션 A가 객체 하나를 읽고 트랜잭션 B가 그 객체에 쓰기를 원한다면 B는 진행하기 전에 A가 커밋되거나 어보트될 때까지 기다려야 한다.(B가 A 몰래 갑자기 객체를 변경하지 못하도록 보장된다.)</li>\n<li>트랜잭션 A가 객체에 썻고 트랜잭션 B가 그 객체를 읽기 원한다면 B는 진행하기 전에 A가 커밋되거나 어보트될 때까지 기다려야 한다.</li>\n</ul>\n<aside>\n💡 2단게 잠금(2PL)과 2단계 커밋(two-phase commit, 2PC)은 아주 비슷하게 들리지만 완전히 다르다.\n</aside>\n<h4>2단계 잠금 구현</h4>\n<ul>\n<li>2PL은 마이SQL 서버에서 직렬성 격리 수준을 구현하는데 사용된다.</li>\n<li>\n<p>읽는 쪽과 쓰는 쪽을 막는 것은 데이터베이스의 각 객체의 잠금을 사용해 구현한다.</p>\n<ul>\n<li>트랜잭션이 객체를 읽기를 원한다면 먼저 공유 모드로 잠금을 획득해야 한다. 동시에 여러 트랜잭션이 공유 모드로 잠금을 획득하는 것은 허용되지만 만약 그 객체에 이미 독점 모드로 잠금을 획든한 트랜잭션이 있으면 이 트랜잭션이 완료될 때까지 기다려야 한다.</li>\n<li>트랜잭션이 객체에 쓰기를 원한다면 먼저 독점 모드로 잠금을 획득해야 한다. 다른 어떤 트랜잭션도 동시에 작므을 획득할 수 없으므로 그 객체에 작믁ㅁ이 존재한다면 트랜잭션은 대기해야 한다.</li>\n<li>트랜잭션이 객체를 읽다가 쓰기를 실행할 때는 공유 잠금을 독점 잠금으로 업그레이드해야 한다. 업그레이드는 독점 잠금을 직접 획득할 때와 똑같이 동작한다.</li>\n<li>트랜잭션이 잠금을 획득한 후에는 트랜잭션이 종료될때 까지 잠금을 갖고 있어야 한다. 2PL의 첫 번째 단계는 잠금을 획득할 때이고 두 번째 단계는 모든 잠금을 해제할 때다.</li>\n<li>트랜잭션이 서로 잠금을 해제하기를 기다리느라 멈춰 있는 상황을 <code class=\"language-text\">교착 상태</code>라고 한다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"직렬성-스냅숏-격리Serializable-Snapshot-Isolation-SSI\" style=\"position:relative;\">직렬성 스냅숏 격리(Serializable Snapshot Isolation, SSI)<a href=\"#%EC%A7%81%EB%A0%AC%EC%84%B1-%EC%8A%A4%EB%83%85%EC%88%8F-%EA%B2%A9%EB%A6%ACSerializable-Snapshot-Isolation-SSI\" aria-label=\"직렬성 스냅숏 격리Serializable Snapshot Isolation SSI permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>직렬성 격리와 좋은 성능이 공종하는 <code class=\"language-text\">직렬성 스냅숏 격리</code>라는 알고리즘이 유망하다.</li>\n</ul>\n<h4>비관적 동시성 제어 대 낙관적 동시성 제어</h4>\n<ul>\n<li>\n<p>2단계 잠금은 <code class=\"language-text\">비관적</code> 동시성 제어 메커니즘이다.</p>\n<ul>\n<li>뭔가 잘못될 가능성이 있으면 뭔가를 하기 전에 상황이 다시 안전해질 때까지 기다리는 게 낫다는 원칙을 기반으로 한다.</li>\n</ul>\n</li>\n<li>\n<p>직렬성 스냅숏 격리는 <code class=\"language-text\">낙관적</code> 동시성 제어 기법이다.</p>\n<ul>\n<li>트랜잭션이 커밋되기를 원할 때 데이터베이스는 격리가 위반됐는지 확인한다.</li>\n<li>만약 그렇다면 트랜잭션은 어보트되고 재시도해야 한다.</li>\n</ul>\n</li>\n<li>낙관적 동시성 제어는 경쟁이 심하면 어보트시켜야 할 트랜잭션의 비율이 높아지므로 성능이 떨어진다.</li>\n<li>예비 용량이 충분하고 트랜잭션 사이의 경쟁이 너무 심하지 않으면 낙관적 동시성 제어 기법은 비관적 동시성 제어보다 성능이 좋은 경향이 있다.</li>\n<li><code class=\"language-text\">SSI</code>는 스냅숏 격리를 기반으로 한다. 모든 읽기의 데이터는 데이터베이스의 일관된 스냅숏을 보게 된다.</li>\n</ul>\n<h2 id=\"정리\" style=\"position:relative;\">정리<a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h4>동시성 제어를 위한 격리 수준</h4>\n<ul>\n<li>\n<p><strong>더티 읽기</strong></p>\n<ul>\n<li>한 클라이언트가 다른 클라이언트가 썻지만 아직 커밋되지 않은 데이터를 읽는다. 커밋 후 읽기 또는 그보다 강한 격리 수준은 더티 읽기를 방지한다.</li>\n</ul>\n</li>\n<li>\n<p><strong>더티 쓰기</strong></p>\n<ul>\n<li>한 클라이언트가 다른 클라이언트가 썻지만 아직 커밋되지 않은 데이터를 덮어쓴다. 거의 모든 트랜잭션 구현은 더티 쓰기를 방지한다.</li>\n</ul>\n</li>\n<li>\n<p><strong>읽기 스큐(반복 읽기)</strong></p>\n<ul>\n<li>클라이언트는 다른 시점에 데이터베이스의 다른 부분을 본다. 이 문제를 막기 위해 어느 시점의 일관된 스냅숏으로부터 읽는 스냅숏 격리를 가장 흔히 사용한다.</li>\n</ul>\n</li>\n<li>\n<p><strong>갱신 손실</strong></p>\n<ul>\n<li>두 클라이언트가 동시에 <code class=\"language-text\">read-modify-write</code> 주기를 실행한다. 다른 트랜잭션의 변경을 포함하지 않은 채로 쓴 내용을 덮어써서 데이터 손실이 일어난다.</li>\n</ul>\n</li>\n<li>\n<p><strong>쓰기 스큐</strong></p>\n<ul>\n<li>트랜잭션이 무언가를 읽고 읽은 값을 기반으로 어떤 결정을 하고 그 결정을 데이터베이스에 쓴다. 그러나  쓰기를 실행하는 시점에는 결정의 전체가 더 이상 참이 아니다. 직렬성 격리만 이런 이상 현상을 막을 수 있다.</li>\n</ul>\n</li>\n<li>\n<p><strong>팬텀 읽기</strong></p>\n<ul>\n<li>트랜잭션이 어떤 검색 조건에 부합하는 객체를 읽는다. 다른 클라이언트가 그 검색 결과에 영향을 주는 쓰기를 실행한다.</li>\n</ul>\n</li>\n</ul>\n<h4>직렬성 트랜잭션을 구현하는 방법</h4>\n<ul>\n<li>\n<p>트랜잭션을 순서대로 실행하기</p>\n<ul>\n<li>트랜잭션의 실행 시간이 아주 짧고 트랜잭션 처리량이 단일 CPU 코어에서 처리할 수 있을 정도로 트랜잭션 처리량이 낮다면 아주 간단하고 효과적인 선택이다.</li>\n</ul>\n</li>\n<li>\n<p>2단계 잠금</p>\n<ul>\n<li>수십년 동안 직렬성을 구현하는 표준적인 방법이지만 성능 특성 때문에 사용을 피하는 애플리케이션이 많다.</li>\n</ul>\n</li>\n<li>\n<p>직렬성 스냅숏 격리</p>\n<ul>\n<li>낙관적 방법을 사용해서 트랜잭션이 차단되지 않고 진행할 수 있게 한다. 트랜잭션이 커밋을 원할 때 트랜잭션을 확인해서 실행이 직렬적이지 않으면 어보트시킨다.</li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/ch7/","thumbnail":null},"frontmatter":{"date":"February 01, 2022","update":"Feb 01, 2022","title":"7장 - 트랜잭션","description":null,"tags":["데이터 중심 애플리케이션 설계"],"thumbnail":null}},{"excerpt":"파티셔닝과 복제 데이터셋이 매우 크거나 질의 처리량이 매우 높다면 복제만으로 부족하고 데이터를 파티션으로 쪼갤 필요가 있다. 이 작업을 이라고 한다. 파티션을 나눌 때는 보통 각 데이터 단위(레코드, 로우, 문서)가 하나의 파티션에 속하게 한다. 데이터 파티셔닝을 원하는 주된 이유는 확장성이다. 보통 복제와 파티셔닝을 함께 적용해 각 파티션의 복사본을 여…","html":"<h2 id=\"파티셔닝과-복제\" style=\"position:relative;\">파티셔닝과 복제<a href=\"#%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D%EA%B3%BC-%EB%B3%B5%EC%A0%9C\" aria-label=\"파티셔닝과 복제 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>데이터셋이 매우 크거나 질의 처리량이 매우 높다면 복제만으로 부족하고 데이터를 파티션으로 쪼갤 필요가 있다. 이 작업을 <code class=\"language-text\">샤딩</code>이라고 한다.</li>\n<li>파티션을 나눌 때는 보통 각 데이터 단위(레코드, 로우, 문서)가 하나의 파티션에 속하게 한다.</li>\n<li>데이터 파티셔닝을 원하는 주된 이유는 <strong>확장성</strong>이다.</li>\n<li>보통 복제와 파티셔닝을 함께 적용해 각 파티션의 복사본을 여러 노드에 저장한다.</li>\n</ul>\n<!-- more -->\n<aside>\n💡 몽고DB, 엘라스틱서치, 솔라클라우드의 샤드(shared), HBase에서는 리전(region), 빅테이블에서는 태블릿(tablet), 카산드라, 리악에서는 브이노드(vnode), 카우치베이스에서는 브이버켓(vBucket)이라 부른다.\n</aside>\n<h2 id=\"키-값-데이터-파티셔닝\" style=\"position:relative;\">키-값 데이터 파티셔닝<a href=\"#%ED%82%A4-%EA%B0%92-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D\" aria-label=\"키 값 데이터 파티셔닝 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>파티셔닝의 목적은 데이터와 질의 부하를 노드 사이에 고르게 분산시키는 것이다.</li>\n<li>파티셔닝이 고르게 이뤄지지 않아 다른 파티션보다 데이터가 많거나 질의를 많이 받는 파티션이 있다면 <strong>쏠렸다(skewed)</strong> 고 말한다.</li>\n<li>불균형하게 부하가 높은 파티션을 <code class=\"language-text\">핫스팟</code>이라고 한다.</li>\n<li>어떤 레코드를 어느 노드에 저장해야 할까?</li>\n</ul>\n<h3 id=\"키-범위-기준-파티셔닝\" style=\"position:relative;\">키 범위 기준 파티셔닝<a href=\"#%ED%82%A4-%EB%B2%94%EC%9C%84-%EA%B8%B0%EC%A4%80-%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D\" aria-label=\"키 범위 기준 파티셔닝 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>종이 백과사전처럼 각 파티션에 연속된 범위의 키를 할당한다.</li>\n<li>각 범위들 사이의 경계를 알면 어떤 키가 어느 파티션에 속하는지 쉽게 찾을 수 있다.</li>\n<li>키 범위의 경계는 데이터에 맞춰 조정해야 한다. 데이터가 키 경계별로 고르게 분포하지 않을 수도 있기 때문이다.</li>\n<li>\n<p>키 범위 기준 파티셔닝은 접근 패턴이 핫스팟을 유발할 수도 있다.</p>\n<ul>\n<li>특정 키에만 부하가 물려 해당 파티션만 과부하가 걸리고 나머지 파티션은 유휴 상태로 남아 있을 수 있다.</li>\n</ul>\n</li>\n<li>빅테이블, HBase, 리싱크DB, 2.4버전 이전의 몽고DB에서 사용된다.</li>\n</ul>\n<h3 id=\"키의-해시값-기준-파티셔닝\" style=\"position:relative;\">키의 해시값 기준 파티셔닝<a href=\"#%ED%82%A4%EC%9D%98-%ED%95%B4%EC%8B%9C%EA%B0%92-%EA%B8%B0%EC%A4%80-%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D\" aria-label=\"키의 해시값 기준 파티셔닝 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>쏠림과 핫스팟의 위험ㄷ 때문에 많은 분산 데이터스토어는 키의 파티션을 정하는데 해시 함수를 사용한다.</li>\n<li>카산드라와 몽고DB는 MD5를 사용한다.</li>\n<li>각 파티션에 해시값 범위를 할당하고 해시값이 파티션의 범위에 속하는 모든 키를 그 파티션에 할당하면 된다.</li>\n<li>키의 해시값을 사용해서 파티셔닝을 하면 정렬 순서가 유지되지 않아 범위 질의를 처리하는데 불리해진다.</li>\n<li>리악, 카우치베이스,볼트모트에서는 기본키에 대한 범위 질의가 지원되지 않는다.</li>\n<li>\n<p>카산드라는 두 가지 파티셔닝 전략 모두 사용한다.</p>\n<ul>\n<li>카산드라에서 테이블을 선언할 때 여러 컬럼을 포함하는 <strong>복합키</strong>를 지정할 수 있다.</li>\n<li>키의 첫 부분만 해싱을 적용하고 나머지 컬럼은 SS테이블에서 데이터를 정렬하는 색인을 사용한다.</li>\n<li>첫 번째 컬럼에 대해서는 범위 질의를 쓸 수 없지만, 첫 번째 컬럼을 고정된 값으로 지정하면 다른 컬럼에 대해서는 범위 스캔을 수행할 수 있다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"쏠린-작업부하와-핫스팟-완화\" style=\"position:relative;\">쏠린 작업부하와 핫스팟 완화<a href=\"#%EC%8F%A0%EB%A6%B0-%EC%9E%91%EC%97%85%EB%B6%80%ED%95%98%EC%99%80-%ED%95%AB%EC%8A%A4%ED%8C%9F-%EC%99%84%ED%99%94\" aria-label=\"쏠린 작업부하와 핫스팟 완화 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>해시값 기준 파티셔닝은 동일한 키를 읽고 쓰는 극단적인 상황에서는 모든 요청이 동일한 파티션으로 쏠리게 된다.</li>\n<li>\n<p>현대 데이터 시스템은 대부분 크게 쏠린 작업부하를 자동으로 보정하지 못하므로 애플리케이션에서 쏠림을 완화해야 한다.</p>\n<ul>\n<li>예를 들어, 요청이 쏠리는 키를 발견했을 때, 임의의 숫자 2개만 붙이더라도 작업이 100개의 다른 키로 균등하게 분산된다.</li>\n<li>어떤 키가 쪼개졌는지 추적할 방법도 있어야 한다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"파티셔닝과-보조-색인\" style=\"position:relative;\">파티셔닝과 보조 색인<a href=\"#%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D%EA%B3%BC-%EB%B3%B4%EC%A1%B0-%EC%83%89%EC%9D%B8\" aria-label=\"파티셔닝과 보조 색인 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>보조 색인은 보통 특정한 값이 발생한 항목을 검색하는 수단이다.</li>\n<li>보조 색인은 관계형 데이터베이스의 핵심 요소이며 솔라나 엘라스틱서치 같은 검색 서버에게는 <strong>존재의 이유</strong>다.</li>\n<li>보조 색인은 파티션에 깔끔하게 대응되지 않는 문제점이 있다.</li>\n</ul>\n<h3 id=\"문서-기준-보조-색인-파티셔닝\" style=\"position:relative;\">문서 기준 보조 색인 파티셔닝<a href=\"#%EB%AC%B8%EC%84%9C-%EA%B8%B0%EC%A4%80-%EB%B3%B4%EC%A1%B0-%EC%83%89%EC%9D%B8-%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D\" aria-label=\"문서 기준 보조 색인 파티셔닝 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>고유 ID 기준으로 문서를 파티셔닝한다.</li>\n<li>각 파티션은 자신의 보조 색인을 유지하며 그 파티션에 속하는 문서만 담당한다.</li>\n<li>데이터베이스에서 문서 추가, 삭제, 갱신 등의 쓰기 작업을 실행할 때는 쓰려고 하는 문서 ID를 포함하는 파티션만 다루면 된다.</li>\n<li>그러한 까닭에 문서 파티셔닝 색인은 <code class=\"language-text\">지역 색인(local index)</code> 라도도 부른다.</li>\n<li>보조 색인의 모든 데이터가 한 파티셔닝에 없을 수도 있다. 따라서 모든 파티션으로 질의를 보내서 얻은 결과를 모두 모아야 한다.</li>\n<li>이런식의 질의를 보내는 방법을 <code class=\"language-text\">스캐터/개더(scatter/gather)</code>라고 한다.</li>\n<li>몽고DB, 리악, 카산드라, 엘라스틱서치, 솔라클라우드, 볼트DB는 모두 문서 기준 보조 색인을 사용한다.</li>\n</ul>\n<h3 id=\"용어-기준-보조-색인-파티셔닝\" style=\"position:relative;\">용어 기준 보조 색인 파티셔닝<a href=\"#%EC%9A%A9%EC%96%B4-%EA%B8%B0%EC%A4%80-%EB%B3%B4%EC%A1%B0-%EC%83%89%EC%9D%B8-%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D\" aria-label=\"용어 기준 보조 색인 파티셔닝 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>예를 들어 보조 색인의 a-r 까지의 글자로 시작하면 파티션 0에, s-z까지의 글자로 시작하는 색깔은 파티션 1에 저장되도록 파티셔닝한다.</li>\n<li>찾고자 하는 용어에 따라 색인의 파티션이 결정되므로 이런 식의 색인을 용어 기준으로 파티셔닝됐다라고 한다.</li>\n<li><strong>용어</strong>라는 이름은 전문 색인에서 나왔는데 문서에 등장하는 모든 단어를 말한다.</li>\n<li>문서 파티셔닝 색인에 비해 <code class=\"language-text\">전역(용여 파티셔닝)</code> 색인이 갖는 이점은 읽기가 효율적이라는 것이다.</li>\n<li>하지만 전역 색인은 쓰기가 느리고 복잡하다는 단점이 있다.</li>\n<li>단일 문서를 쓸 때 해당 색인의 여러 파티셔네 영향을 줄 수 있기 때문이다.</li>\n<li>\n<p>현실에서는 전역 보조 색인은 대게 비동기로 갱신된다.</p>\n<ul>\n<li>아마존 다이나모DB는 정상적인 상황에는 전역 보조 색인을 갱신하는데 1초도 안걸린다.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"파티션-재균형화\" style=\"position:relative;\">파티션 재균형화<a href=\"#%ED%8C%8C%ED%8B%B0%EC%85%98-%EC%9E%AC%EA%B7%A0%ED%98%95%ED%99%94\" aria-label=\"파티션 재균형화 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>\n<p>시간이 지나면 데이터베이스에 변화가 생긴다.</p>\n<ul>\n<li>질의 처리량이 증가해서 늘어난 부하를 처리하기 위해 CPU를 추가하고 싶다.</li>\n<li>데이터셋 크기가 증가해서 데이터셋 저장에 사용할 디스크와 램을 추가하고 싶다.</li>\n<li>장비에 장애가 발생해서 그 장비가 담당하던 역할을 다른 장비가 넘겨받아야 한다.</li>\n</ul>\n</li>\n<li>이런 변화가 생기면 데이터 요청이 한 노드에서 다른 노드로 옮겨야 하는데 이런 과정을 <code class=\"language-text\">재균형화(rebalancing)</code>라고 한다.</li>\n<li>\n<p>재균형화가 실행될 때 만족시킬 것으로 기대되는 최소 요구사항이 있다.</p>\n<ul>\n<li>재균형화 후, 부하가 노드 사이에 균등하게 분배돼야 한다.</li>\n<li>재균형화 도중에도 데이터베이스는 읽기 쓰기 요청을 받으들여야 한다.</li>\n<li>재균형화가 빨리 샐행되고 네트워크와 디스크 I/O 부하를 최소화할 수 있도록 노드들 사이에 데이터가 필요 이상으로 옮겨져서는 안된다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"재균형화-전략\" style=\"position:relative;\">재균형화 전략<a href=\"#%EC%9E%AC%EA%B7%A0%ED%98%95%ED%99%94-%EC%A0%84%EB%9E%B5\" aria-label=\"재균형화 전략 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>쓰면 안되는 방법: 해시값에 모드 N연산을 실행</h4>\n<ul>\n<li>해시값에 <code class=\"language-text\">mod</code> 연산을 쓰게 되면 노드 개수 N이 바꾸면 대부분의 키가 노드 사이에 옮겨져야 한다는 점이다.</li>\n<li>키가 자주 이동하면 재균형화 비용이 지나치게 커진다.</li>\n</ul>\n<h4>파티션 개수 고정</h4>\n<ul>\n<li>파티션을 노드 대수보다 많이 만들고 각 노드에 여러 파티션을 할당하는 것이다.</li>\n<li>클러스터에 노드가 추가되면 새 노드는 파티션이 다시 균일하게 분배될 때까지 기존 노드에서 파티션 몇개를 뻇어올 수 있다.</li>\n<li>파티션은 노드 사이에서 통째로 이동하기만 한다. 파티션 개수는 바뀌지 않고 파티션에 할당된 키도 변경되지 않는다.</li>\n<li>이 방식을 사용할 때는 보통 데이터베이스가 처음 구축될 때 파티션 개수가 고정되고 이후에 변하지 않는다.</li>\n<li>파티션을 쪼개거나 합치는게 가능하지만 운영성 어려움이 많아 처음 설정하는 파티션 개수가 사용 가능한 노드 대수의 최대치가 되므로 미래에 증가될 것을 수용하기에 충분히 높은 값을 선택해야 한다.</li>\n<li>파티션이 너무 크면 재균형화를 실행할 때와 노드 장애로부터 복구할 때 비용이 크다. 파티션이 너무 작으면 오버헤드가 너무 커진다.</li>\n<li>파티션 크기가 적당할 때 성능이 가장 좋지만 파티션 개수는 고정돼 있고 데이터셋 크기는 변한다면 적절한 크기를 정하기 어렵다.</li>\n</ul>\n<h4>동적 파티셔닝</h4>\n<ul>\n<li>키 범위 파티셔닝에서 파티션의 경계와 개수가 고정돼 있는게 매우 불편하다. 이런 이유로 파티션을 동적으로 만든다.</li>\n<li>파티션 크기가 설정된 값을 넘어서면 파티션을 두 개로 쪼개 각각에 원래 파티션의 절반 정도의 데이터가 포함되게 한다.</li>\n<li>반대로 데이터가 많이 삭제되어 파티션 크기가 임계값 아래로 떨어지면 인접한 파티션과 합쳐질 수 있다.</li>\n<li>큰 파티션이 쪼개진 후 부하의 균형을 맞추기 위해 분할된 파티션 중 하나가 다른 노드로 이동될 수 있다.</li>\n<li>\n<p>동적 파티셔닝은 파티션 개수가 전체 데이터에 맞춰 조정된다는 이점이 있다.</p>\n<ul>\n<li>단, 데이터 셋이 작을 때는 모든 쓰기 요청이 하나의 노드에서 실행되고 다른 노드들은 유휴 상태에 머물게 된다.</li>\n<li>이 문제를 완하하기 위해서 몽고DB에서는 초기 파티션 집합을 설정할 수 있게 한다. (사전분할이라고 부른다)</li>\n</ul>\n</li>\n<li>동적 파티셔닝은 커 범위 파티셔닝뿐만 아니라 해시 파티셔닝에서도 똑같이 사용될 수 있다.</li>\n</ul>\n<h4>노드 비례 파티셔닝</h4>\n<ul>\n<li>카산드라와 케타마에서 사용되는 방법은 파티션 개수가 노드 대수에 비례하게 하는 것이다.</li>\n<li>노드 대수가 변함 없는 동안은 개별 파티션 크기가 데이터셋 크기에 비례해서 증가하지만 노드 대수를 늘리면 파티션 크기는 다시 작아진다.</li>\n<li>새 노드가 클러스터에 추가되면 고정된 개수의 파티션을 무작위로 선택해 분할하고 각 분할된 파티션의 절반은 그대로 두고 절반은 새 노드에 할당한다.</li>\n</ul>\n<h3 id=\"운영-자동-재균형화와-수동-재균형화\" style=\"position:relative;\">운영: 자동 재균형화와 수동 재균형화<a href=\"#%EC%9A%B4%EC%98%81-%EC%9E%90%EB%8F%99-%EC%9E%AC%EA%B7%A0%ED%98%95%ED%99%94%EC%99%80-%EC%88%98%EB%8F%99-%EC%9E%AC%EA%B7%A0%ED%98%95%ED%99%94\" aria-label=\"운영 자동 재균형화와 수동 재균형화 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>완전 자동 재균형화<code class=\"language-text\">(시스템이 자동으로 언제 파티션을 노드 사이에 이동할지 결정함)</code>와 완전 수동 재균형화<code class=\"language-text\">(관리자가 명시적으로 파티션을 노드에 할당하도록 설정하고 관리자가 재설정할 때만 파티션 할당이 변경됨)</code> 사이에는 중간 지점이 있다.</li>\n<li>카우치베이스, 리악, 볼드모트는 자동으로 파티션 할당을 제안하지만 반영되려면 관리자가 확정해야 한다.</li>\n<li>완전 자동 개균형화는 유지보수에 손이 덜 가지만, 예측하기 어렵다.</li>\n</ul>\n<h2 id=\"요청-라우팅\" style=\"position:relative;\">요청 라우팅<a href=\"#%EC%9A%94%EC%B2%AD-%EB%9D%BC%EC%9A%B0%ED%8C%85\" aria-label=\"요청 라우팅 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>\n<p>클라이언트에서 요청을 보내려고 할 때 어느 노드로 접속을 해야할까?</p>\n<ul>\n<li>클라이언트가 아무 노드에 접속하게 한다.그 후, 요청을 처리할 노드로 전달해서 응답을 받는다.</li>\n<li>클라이언트의 모든 요청을 라우팅 계층으로 먼저 보낸다. 라우팅 계층에서는 각 요청을 처리할 노드를 알아내고 그에 따라 해당 노드에 요청을 전달한다.</li>\n<li>클라이언트가 파티셔닝 방법과 파티션이 어떤 노드에 할당됐는지를 알고 있게 한다.</li>\n</ul>\n</li>\n<li>모든 경우에 핵심 문제는 라우팅 결정을 내리는 구성요소<code class=\"language-text\">(노드 중 하나, 라우팅 계층, 클라이언트 측)</code>가 노드에 할당된 파티션의 변경 사항을 어떻게 아느냐다.</li>\n<li>\n<p>많은 분산 데이터 시스템은 클러스터 메타데이터를 추적하기 위해 주키퍼 같은 별도의 코디네이션 서비스를 사용한다.</p>\n<ul>\n<li>각 노드는 주키퍼에 자신을 등록하고 주키퍼는 파티션과 노드 사이의 신뢰성 있는 할당 정보를 관리한다.</li>\n<li>노드사 추가되거나 삭제되면 주키퍼는 라우팅 계층에 이를 알려서 라우터 정보를 최신화 한다.</li>\n<li>HBase, 솔라클라우드, 카프카 등</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">가십 프로토콜(gossip protocol)</code>을 사용해서 클러스터 상태 변화를 노드 사이에 전달하는 방식도 있다.</p>\n<ul>\n<li>아무 노드나 요청을 받을 수 있고 요청을 받은 노드는 요청을 처리할 노드에게 요청을 전달한다.</li>\n<li>이 모델은 데이터베이스 노드에 복잡성은 더하지만 주키퍼 같은 외부 코디네이션 서비스에 의존하지 않는다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"병렬-질의-실행\" style=\"position:relative;\">병렬 질의 실행<a href=\"#%EB%B3%91%EB%A0%AC-%EC%A7%88%EC%9D%98-%EC%8B%A4%ED%96%89\" aria-label=\"병렬 질의 실행 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li>지금까지는 단일 키를 읽거나 간단한 질의에 대해서만 설명했다.</li>\n<li>그러나 분석용으로 자주 사용되는 <code class=\"language-text\">대규모 병렬 처리(MPP)</code> 관계형 데이터 베이스 제품은 훨씬 더 복잡한 종류의 질의를 지원한다.</li>\n<li>MPP 옵티마이저는 복잡한 질의를 여러 실행 단계와 파티션으로 분해하며 이들 중 다수는 데이터베이스 클러스터 내의 서로 다른 노드에서 병렬적으로 실행될 수 있다.</li>\n</ul>\n<h2 id=\"정리\" style=\"position:relative;\">정리<a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li>저장과 처리할 데이터가 많아서 장비 한 대로 처리하는게 불가능해지면 파티셔닝이 필요하다.</li>\n<li>파티셔닝의 목적은 핫스팟이 생기지 않게 하면서 데이터와 질의 부하를 여러 장비에 균일하게 분배하는 것이다.</li>\n<li>그렇게 하려면 데이터에 적합한 파티셔닝 방식을 선택해야 하고 클러스터 노드에 추가되거나 제거될 때 파티션 재균형화를 실행해야 한다.</li>\n</ul>\n<h3 id=\"파티셔닝-기법\" style=\"position:relative;\">파티셔닝 기법<a href=\"#%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D-%EA%B8%B0%EB%B2%95\" aria-label=\"파티셔닝 기법 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>키 범위 파티셔닝</h4>\n<ul>\n<li>키가 정렬돼 있고 개별 파티션은 키 범위 경계에 속한다.</li>\n<li>키가 정렬되어 있어 범위 질의에 효율적이지만 핫스팟이 생길 위험이 있다.</li>\n<li>파티션이 너무 커지면 키 범위를 두 개로 쪼개 동적으로 재균형화를 실행한다.</li>\n</ul>\n<h4>해시 파티셔닝</h4>\n<ul>\n<li>키에 해시 함수를 적용하여 키 범위 파티셔닝을 적용한다.</li>\n<li>범위 질의에 비효율적이지만 부하를 더욱 균일하게 분산할 수 있다.</li>\n</ul>\n<h3 id=\"보조-파티셔닝-기법\" style=\"position:relative;\">보조 파티셔닝 기법<a href=\"#%EB%B3%B4%EC%A1%B0-%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9D-%EA%B8%B0%EB%B2%95\" aria-label=\"보조 파티셔닝 기법 permalink\" class=\"anchor-header after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<h4>문서 파티셔닝 색인(지역 색인)</h4>\n<ul>\n<li>보조 색인을 기본키와 값이 저장된 파티션에 저장한다.</li>\n<li>쓸 때는 파티션 하나만 갱신하면 되지만 보조 색인을 읽으려면 모든 파티션에 걸쳐서 스캐터/개더를 사용해야 한다.</li>\n</ul>\n<h4>용어 파티셔닝 색인(전역 색인)</h4>\n<ul>\n<li>색인된 값을 사용해서 보조 색인을 별도로 파티셔닝 한다.</li>\n<li>문서를 쓸 때는 보조 색인 여러 개를 갱신해야 하지만 읽기는 단일 파티션에서 실행될 수 있다.</li>\n</ul>","fields":{"slug":"/ch6/","thumbnail":null},"frontmatter":{"date":"January 28, 2022","update":"Jan 28, 2022","title":"6장 - 파티셔닝","description":null,"tags":["데이터 중심 애플리케이션 설계"],"thumbnail":null}}]},"totalMarkdown":{"group":[{"fieldValue":"AWS","totalCount":2},{"fieldValue":"JPA","totalCount":1},{"fieldValue":"Java","totalCount":10},{"fieldValue":"Tomcat","totalCount":2},{"fieldValue":"kernel","totalCount":1},{"fieldValue":"데이터 중심 애플리케이션 설계","totalCount":8},{"fieldValue":"데이터베이스","totalCount":2},{"fieldValue":"디자인 패턴","totalCount":3},{"fieldValue":"레디스","totalCount":1},{"fieldValue":"스프링","totalCount":5},{"fieldValue":"실무로 배우는 시스템 성능 최적화","totalCount":7},{"fieldValue":"카프카","totalCount":3}],"nodes":[{"fields":{"slug":"/java-synchronized/"}},{"fields":{"slug":"/mysql-transaction-lock/"}},{"fields":{"slug":"/socket_internal/"}},{"fields":{"slug":"/java-nio-selector/"}},{"fields":{"slug":"/java-nio-channel/"}},{"fields":{"slug":"/spring-core-container/"}},{"fields":{"slug":"/tomcat-connection/"}},{"fields":{"slug":"/java-nio-buffer/"}},{"fields":{"slug":"/socket_option/"}},{"fields":{"slug":"/tomcat/"}},{"fields":{"slug":"/java-concurrency-lock/"}},{"fields":{"slug":"/java-concurrency-deadlock/"}},{"fields":{"slug":"/java-concurrency-executor/"}},{"fields":{"slug":"/java-concurrency-model/"}},{"fields":{"slug":"/java-concurrency/"}},{"fields":{"slug":"/mysql-primary-key-design/"}},{"fields":{"slug":"/ehcache3/"}},{"fields":{"slug":"/jpa-slow-cause/"}},{"fields":{"slug":"/redis-event-notifications/"}},{"fields":{"slug":"/spring-cache-hierarchy/"}},{"fields":{"slug":"/java-collection-wrapper/"}},{"fields":{"slug":"/Spring Cloud AWS Messaging Module Best Practice/"}},{"fields":{"slug":"/Amazon SQS Deep Dive/"}},{"fields":{"slug":"/enabling_exactly_once_kafka_streams/"}},{"fields":{"slug":"/trasaction_in_kafka/"}},{"fields":{"slug":"/Exactly_Once_Semantics/"}},{"fields":{"slug":"/create/"}},{"fields":{"slug":"/struct/"}},{"fields":{"slug":"/behavior/"}},{"fields":{"slug":"/spring-autoconfigure/"}},{"fields":{"slug":"/ch7/"}},{"fields":{"slug":"/ch6/"}},{"fields":{"slug":"/ch5/"}},{"fields":{"slug":"/ch4/"}},{"fields":{"slug":"/ch3/"}},{"fields":{"slug":"/ch2/"}},{"fields":{"slug":"/ch1/"}},{"fields":{"slug":"/ch8/"}},{"fields":{"slug":"/ch7/"}},{"fields":{"slug":"/ch6/"}},{"fields":{"slug":"/ch5/"}},{"fields":{"slug":"/ch4/"}},{"fields":{"slug":"/ch3/"}},{"fields":{"slug":"/ch2/"}},{"fields":{"slug":"/ch1/"}}]}},"pageContext":{"skip":30,"totalPage":5,"currentPage":4}},"staticQueryHashes":[],"slicesMap":{}}